(self.webpackChunkweb=self.webpackChunkweb||[]).push([[792],{9155:(e,t,r)=>{var n=r(2299),o=r(6665),i=r(6520),s=r(2167),a=r(5229),l=r(8833),c=r(3929),d=r(6283),u=r(3668),h=r(5648),m=r(5991),y=r(4667),g=r(2348),p=r(397);class x extends o.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){}handleRetry=()=>{this.setState({hasError:!1,error:null})};render(){return this.state.hasError?(0,p.jsx)(b,{error:this.state.error,onRetry:this.handleRetry}):this.props.children}}const b=({error:e,onRetry:t})=>{const{colors:r}=(0,y.D)();return(0,p.jsx)(c.A,{style:[f.container,{backgroundColor:r.background.primary}],children:(0,p.jsxs)(c.A,{style:f.content,children:[(0,p.jsx)(d.A,{style:[f.title,{color:r.error}],children:"Something went wrong"}),(0,p.jsx)(d.A,{style:[f.message,{color:r.text.secondary}],children:e?.message||"An unexpected error occurred"}),(0,p.jsx)(h.A,{style:[f.button,{backgroundColor:r.primary}],onPress:t,children:(0,p.jsx)(d.A,{style:[f.buttonText,{color:r.text.inverse}],children:"Try Again"})}),!1]})})},f=u.A.create({container:{flex:1,alignItems:"center",justifyContent:"center",padding:g.Y.LARGE},content:{maxWidth:600,width:"100%",alignItems:"center"},title:{fontSize:24,fontWeight:"bold",marginBottom:g.Y.MEDIUM,textAlign:"center"},message:{fontSize:16,marginBottom:g.Y.LARGE,textAlign:"center"},button:Object.assign({paddingHorizontal:g.Y.LARGE,paddingVertical:g.Y.MEDIUM,borderRadius:8,marginBottom:g.Y.LARGE},"web"===m.A.OS&&{cursor:"pointer"}),buttonText:{fontSize:16,fontWeight:"600"},stack:{fontSize:12,fontFamily:"ios"===m.A.OS?"Menlo":"monospace",marginTop:g.Y.LARGE,padding:g.Y.MEDIUM,width:"100%"}});var A=r(5663),j=r(7821),v=r(3295),S=r(8587),C=r(5708),w=r(558),I=r(13),T=r(6773),O=r(1385);const E=({value:e,onChangeText:t,onClear:r,placeholder:n="Search foils...",autoFocus:o=!1,mode:i="browse",onFocus:s})=>{const{colors:a}=(0,y.D)();return(0,p.jsxs)(c.A,{style:[k.container,{backgroundColor:a.background.secondary}],children:["web"===m.A.OS?(0,p.jsx)(d.A,{style:[k.searchIcon,{color:a.text.secondary}],children:"\ud83d\udd0d"}):(0,p.jsx)(O.A,{name:"search",size:20,color:a.text.secondary}),(0,p.jsx)(T.A,Object.assign({style:[k.input,{color:a.text.primary}],value:e,onChangeText:t,placeholder:(()=>{switch(i){case"comparison":return"Search foils to add to comparison...";case"quiver":return"Search foils to add to quiver...";default:return"Search foils..."}})(),placeholderTextColor:a.text.tertiary,autoFocus:o,onFocus:s,autoCapitalize:"none",autoCorrect:!1,clearButtonMode:"never",returnKeyType:"search",maxFontSizeMultiplier:1},"web"===m.A.OS?{spellCheck:!1,autoComplete:"off"}:{keyboardType:"web-search"})),""!==e&&(0,p.jsx)(h.A,{onPress:r,style:k.clearButton,children:"web"===m.A.OS?(0,p.jsx)(d.A,{style:[k.clearIcon,{color:a.text.secondary}],children:"\u2715"}):(0,p.jsx)(O.A,{name:"close-circle",size:20,color:a.text.secondary})})]})},k=u.A.create({container:{flexDirection:"row",alignItems:"center",paddingHorizontal:g.Y.MEDIUM,height:40,borderRadius:8,gap:g.Y.SMALL},input:Object.assign({flex:1,fontSize:16,height:"100%"},"web"===m.A.OS&&{outlineStyle:"none",border:"none",background:"transparent",lineHeight:40}),clearButton:Object.assign({height:"100%",aspectRatio:1,alignItems:"center",justifyContent:"center"},"web"===m.A.OS&&{cursor:"pointer"}),searchIcon:{fontSize:16,width:20,height:20,textAlign:"center",lineHeight:20},clearIcon:{fontSize:16,width:20,height:20,textAlign:"center",lineHeight:20}});var M=r(8264),R=r(4307),q=r(9149),D=r(3600);function F({filterOptions:e,selectedBrands:t,selectedSeries:r,selectedTypes:n,onFilterChange:i,onClearFilters:s,columns:a,onColumnVisibilityChange:l,onResetColumns:u,foils:h}){const[m,g]=(0,o.useState)(!1),[x,b]=(0,o.useState)("filters"),{colors:f,isDark:A,toggleTheme:j}=(0,y.D)();(0,o.useEffect)((()=>{(async()=>{try{const e=await(0,D.Ir)();e&&(e.brands.forEach((e=>i("brands",e))),e.series.forEach((e=>i("series",e))),e.types.forEach((e=>i("type",e))));const t=await(0,D.E7)();if(t){const e=Object.fromEntries(a.map((e=>[e.id,e.isVisible])));Object.entries(t).forEach((([t,r])=>{e[t]!==r&&l(t)}))}}catch(e){}})()}),[]),(0,o.useEffect)((()=>{(async()=>{try{const e={brands:t,series:r,types:n};await(0,D.ri)(e)}catch(e){}})()}),[t,r,n]),(0,o.useEffect)((()=>{(async()=>{try{const e={};a.forEach((t=>{e[t.id]=t.isVisible})),await(0,D.pF)(e)}catch(e){}})()}),[a]);const v=(0,o.useMemo)((()=>{if(0===t.length)return e.series;const r=new Set;return h.forEach((e=>{t.includes(e.brand)&&e.series&&r.add(e.series)})),Array.from(r).sort()}),[e.series,t,h]);return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(C.A,{onPress:()=>g(!0),style:[B.iconButton,{backgroundColor:f.background.secondary}],children:(0,p.jsx)(q.A,{name:"settings",size:24,color:f.text.primary})}),(0,p.jsx)(M.A,{visible:m,transparent:!0,animationType:"fade",onRequestClose:()=>g(!1),children:(0,p.jsx)(C.A,{style:[B.modalOverlay,{backgroundColor:A?"rgba(0, 0, 0, 0.7)":"rgba(0, 0, 0, 0.5)"}],onPress:()=>g(!1),children:(0,p.jsxs)(C.A,{style:[B.modalContent,{backgroundColor:f.background.primary}],onPress:e=>e.stopPropagation(),children:[(0,p.jsxs)(c.A,{style:[B.modalHeader,{borderBottomColor:f.border}],children:[(0,p.jsx)(d.A,{style:[B.modalTitle,{color:f.text.primary}],children:"Table Settings"}),(0,p.jsx)(C.A,{onPress:()=>g(!1),style:B.closeButton,children:(0,p.jsx)(q.A,{name:"close",size:24,color:f.text.secondary})})]}),(0,p.jsxs)(c.A,{style:[B.tabs,{borderBottomColor:f.border}],children:[(0,p.jsx)(C.A,{style:[B.tab,"filters"===x&&[B.activeTab,{borderBottomColor:f.primary}]],onPress:()=>b("filters"),children:(0,p.jsxs)(d.A,{style:[B.tabText,{color:f.text.secondary},"filters"===x&&[B.activeTabText,{color:f.primary}]],children:["Filters ",(t.length>0||r.length>0||n.length>0)&&"\u2022"]})}),(0,p.jsx)(C.A,{style:[B.tab,"columns"===x&&[B.activeTab,{borderBottomColor:f.primary}]],onPress:()=>b("columns"),children:(0,p.jsxs)(d.A,{style:[B.tabText,{color:f.text.secondary},"columns"===x&&[B.activeTabText,{color:f.primary}]],children:["Columns ",a.some((e=>!e.isVisible))&&"\u2022"]})})]}),"filters"===x?(0,p.jsx)(c.A,{style:B.contentWrapper,children:(0,p.jsx)(R.A,{style:B.scrollView,contentContainerStyle:B.scrollContent,children:(0,p.jsxs)(c.A,{style:B.content,children:[(0,p.jsxs)(c.A,{style:B.headerWithAction,children:[(0,p.jsx)(d.A,{style:[B.contentTitle,{color:f.text.primary}],children:"Active Filters"}),(t.length>0||r.length>0||n.length>0)&&(0,p.jsx)(C.A,{onPress:s,style:[B.clearButton,{backgroundColor:f.background.secondary}],children:(0,p.jsx)(d.A,{style:[B.clearButtonText,{color:f.text.secondary}],children:"Clear All"})})]}),(0,p.jsxs)(c.A,{style:B.section,children:[(0,p.jsx)(d.A,{style:[B.sectionTitle,{color:f.text.primary}],children:"Brand"}),(0,p.jsx)(c.A,{style:B.chipContainer,children:e.brands.map((e=>(0,p.jsx)(C.A,{style:[B.chip,{backgroundColor:f.background.secondary},t.includes(e)&&[B.chipSelected,{backgroundColor:f.primary}]],onPress:()=>i("brands",e),children:(0,p.jsx)(d.A,{style:[B.chipText,{color:f.text.secondary},t.includes(e)&&[B.chipTextSelected,{color:f.text.inverse}]],children:e})},e)))})]}),(0,p.jsxs)(c.A,{style:B.section,children:[(0,p.jsx)(d.A,{style:[B.sectionTitle,{color:f.text.primary}],children:"Type"}),(0,p.jsx)(c.A,{style:B.chipContainer,children:e.types.map((e=>(0,p.jsx)(C.A,{style:[B.chip,{backgroundColor:f.background.secondary},n.includes(e)&&[B.chipSelected,{backgroundColor:f.primary}]],onPress:()=>i("type",e),children:(0,p.jsx)(d.A,{style:[B.chipText,{color:f.text.secondary},n.includes(e)&&[B.chipTextSelected,{color:f.text.inverse}]],children:e})},e)))})]}),(0,p.jsxs)(c.A,{style:B.section,children:[(0,p.jsx)(d.A,{style:[B.sectionTitle,{color:f.text.primary}],children:"Series"}),(0,p.jsx)(c.A,{style:B.chipContainer,children:v.length>0?v.map((e=>(0,p.jsx)(C.A,{style:[B.chip,{backgroundColor:f.background.secondary},r.includes(e)&&[B.chipSelected,{backgroundColor:f.primary}]],onPress:()=>i("series",e),children:(0,p.jsx)(d.A,{style:[B.chipText,{color:f.text.secondary},r.includes(e)&&[B.chipTextSelected,{color:f.text.inverse}]],children:e})},e))):(0,p.jsx)(d.A,{style:[B.noSeriesText,{color:f.text.secondary}],children:"No series available for selected brands"})})]}),(0,p.jsxs)(c.A,{style:[B.section,B.themeSection],children:[(0,p.jsx)(d.A,{style:[B.sectionTitle,{color:f.text.primary}],children:"Appearance"}),(0,p.jsxs)(C.A,{style:[B.themeToggle,{backgroundColor:f.background.secondary}],onPress:j,children:[(0,p.jsxs)(c.A,{style:B.themeToggleContent,children:[(0,p.jsx)(q.A,{name:A?"dark-mode":"light-mode",size:20,color:f.text.primary}),(0,p.jsx)(d.A,{style:[B.themeToggleText,{color:f.text.primary}],children:A?"Dark Mode":"Light Mode"})]}),(0,p.jsx)(q.A,{name:"chevron-right",size:20,color:f.text.secondary})]})]})]})})}):(0,p.jsx)(c.A,{style:B.contentWrapper,children:(0,p.jsx)(R.A,{style:B.scrollView,contentContainerStyle:B.scrollContent,children:(0,p.jsxs)(c.A,{style:B.content,children:[(0,p.jsxs)(c.A,{style:B.headerWithAction,children:[(0,p.jsx)(d.A,{style:[B.contentTitle,{color:f.text.primary}],children:"Visible Columns"}),a.some((e=>!e.isVisible))&&(0,p.jsx)(C.A,{onPress:async()=>{u();try{const e={};a.forEach((t=>{e[t.id]=t.isVisible})),await(0,D.pF)(e)}catch(e){}},style:[B.clearButton,{backgroundColor:f.background.secondary}],children:(0,p.jsx)(d.A,{style:[B.clearButtonText,{color:f.text.secondary}],children:"Reset"})})]}),(0,p.jsx)(c.A,{style:B.columnList,children:a.map((e=>(0,p.jsxs)(C.A,{style:B.columnItem,onPress:()=>(async e=>{l(e)})(e.id),children:[(0,p.jsx)(d.A,{style:[B.columnLabel,{color:f.text.primary}],children:e.label}),(0,p.jsx)(c.A,{style:[B.checkbox,{borderColor:f.border},e.isVisible&&[B.checkboxChecked,{backgroundColor:f.primary,borderColor:f.primary}]],children:e.isVisible&&(0,p.jsx)(q.A,{name:"check",size:16,color:f.text.inverse})})]},e.id)))})]})})})]})})})]})}const B=u.A.create({container:{position:"relative"},button:{padding:g.Y.MEDIUM},iconButton:{padding:g.Y.XSMALL},modalContent:{padding:g.Y.MEDIUM},modalHeader:{padding:g.Y.LARGE},buttonGroup:{flexDirection:"row",alignItems:"center",gap:g.Y.SMALL},columnGroup:{flexDirection:"column",gap:g.Y.MEDIUM},filterGroup:{padding:g.Y.MEDIUM},filterList:{gap:g.Y.MEDIUM},modalOverlay:{flex:1,justifyContent:"center",alignItems:"center"},modalTitle:{fontSize:18,fontWeight:"600"},closeButton:{padding:4},tabs:{flexDirection:"row",borderBottomWidth:1},tab:{flex:1,padding:12,alignItems:"center"},activeTab:{borderBottomWidth:2},tabText:{fontSize:14,fontWeight:"500"},activeTabText:{},content:{padding:16,width:"100%"},contentWrapper:{flex:1},scrollView:{flex:1},scrollContent:{flexGrow:1},section:{marginBottom:24},sectionTitle:{fontSize:14,fontWeight:"600",marginBottom:12},chipContainer:{flexDirection:"row",flexWrap:"wrap",gap:8},chip:{borderRadius:16,paddingHorizontal:12,paddingVertical:6},chipSelected:{},chipText:{fontSize:14},chipTextSelected:{},columnList:{gap:12},columnItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:8},columnLabel:{fontSize:14},checkbox:{width:20,height:20,borderRadius:4,borderWidth:2,alignItems:"center",justifyContent:"center"},checkboxChecked:{},headerWithAction:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},contentTitle:{fontSize:16,fontWeight:"600"},clearButton:{paddingHorizontal:12,paddingVertical:6,borderRadius:16},clearButtonText:{fontSize:14},noSeriesText:{fontSize:14,fontWeight:"500"},themeSection:{marginTop:32},themeToggle:Object.assign({flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:12,borderRadius:8},"web"===m.A.OS&&{cursor:"pointer"}),themeToggleContent:{flexDirection:"row",alignItems:"center",gap:12},themeToggleText:{fontSize:14,fontWeight:"500"}});var z=r(209),P=r(2419),L=r(2763),_=r(1690),W=r(484),N=r(5701),V=r(530),U=r(5713);const Y=()=>{const[e,t]=(0,o.useState)(!1);return{signInWithGoogle:async()=>{try{if(t(!0),"web"!==m.A.OS)return{data:null,error:new Error("Mobile authentication not yet implemented")};const e=(()=>{if("web"!==m.A.OS)return;const e=window.location.origin,t=window.location.hostname;return"localhost"===t||t.includes("127.0.0.1")?"http://localhost:19006":e})(),{data:r,error:n}=await N.N.auth.signInWithOAuth({provider:"google",options:{redirectTo:e,queryParams:{access_type:"offline",prompt:"consent"}}});return{data:r,error:n}}catch(e){return{data:null,error:e}}finally{t(!1)}},isLoading:e}};var Q=r(3710);const G=({onSuccess:e})=>{const{signInWithGoogle:t,isLoading:r}=Y();return(0,p.jsx)(h.A,{style:H.button,onPress:async()=>{try{const{error:r}=await t();if(r)return void _.A.alert("Sign In Error",r instanceof Q.lR?r.message:"Failed to sign in");e?.()}catch(r){_.A.alert("Error","An unexpected error occurred during sign in.")}},disabled:r,children:r?(0,p.jsx)(V.A,{color:U.T.text.inverse}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(O.A,{name:"logo-google",size:24,color:U.T.text.inverse,style:H.icon}),(0,p.jsx)(d.A,{style:H.buttonText,children:"Sign in with Google"})]})})},H=u.A.create({button:{flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:U.T.primary,padding:12,borderRadius:8,minWidth:220},buttonText:{color:U.T.text.inverse,fontSize:16,fontWeight:"600"},icon:{marginRight:8}});var J=r(4812);const X=({onPress:e})=>{const{colors:t}=(0,y.D)(),{quivers:r}=(0,J.X)();return(0,p.jsx)(h.A,{onPress:e,children:(0,p.jsx)(c.A,{style:Z.menuItemContent,children:"web"===m.A.OS?(0,p.jsxs)(d.A,{style:[Z.menuItemText,{color:t.text.primary}],children:["My Quivers ",r.length>0?`(${r.length})`:""]}):(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(O.A,{name:"bookmark-outline",size:20,color:t.text.primary}),(0,p.jsxs)(d.A,{style:[Z.menuItemText,{color:t.text.primary}],children:["My Quivers ",r.length>0?`(${r.length})`:""]})]})})})},Z=u.A.create({menuItemContent:{flexDirection:"row",alignItems:"center",gap:8},menuItemText:{fontSize:16}});var $=r(6447);const K=()=>{const{colors:e}=(0,y.D)(),[t,r]=(0,o.useState)(!1),[n,i]=(0,o.useState)(null),[s,a]=(0,o.useState)(null),[l,u]=(0,o.useState)(!1),[g,x]=(0,o.useState)(!1);(0,o.useEffect)((()=>{N.N.auth.getSession().then((({data:{session:e}})=>{i(e),a(e?.user??null)}));const{data:{subscription:e}}=N.N.auth.onAuthStateChange(((e,t)=>{i(t),a(t?.user??null)}));return()=>e.unsubscribe()}),[]);const b=()=>(0,p.jsx)(M.A,{visible:l,transparent:!0,animationType:"fade",onRequestClose:()=>u(!1),children:(0,p.jsx)(h.A,{style:[ee.modalOverlay,{backgroundColor:"rgba(0, 0, 0, 0.5)"}],activeOpacity:1,onPress:()=>u(!1),children:(0,p.jsxs)(c.A,{style:[ee.modalContent,{backgroundColor:e.background.primary}],onStartShouldSetResponder:()=>!0,children:[(0,p.jsxs)(c.A,{style:[ee.modalHeader,{borderBottomColor:e.border}],children:[(0,p.jsx)(d.A,{style:[ee.modalTitle,{color:e.text.primary}],children:"Sign In"}),(0,p.jsx)(h.A,{onPress:()=>u(!1),children:"web"===m.A.OS?(0,p.jsx)(d.A,{style:{fontSize:24,color:e.text.primary},children:"\xd7"}):(0,p.jsx)(O.A,{name:"close",size:24,color:e.text.primary})})]}),(0,p.jsx)(G,{onSuccess:()=>u(!1)})]})})});return n?(0,p.jsxs)(c.A,{style:ee.container,children:[(0,p.jsx)(h.A,{style:ee.profileButton,onPress:()=>r(!t),children:s?.user_metadata?.avatar_url?(0,p.jsx)(W.A,{source:{uri:s.user_metadata.avatar_url},style:ee.avatarImage}):"web"===m.A.OS?(0,p.jsx)(d.A,{style:{fontSize:24,color:e.text.primary},children:"\ud83d\udc64"}):(0,p.jsx)(O.A,{name:"person-circle-outline",size:24,color:e.text.primary})}),t&&(0,p.jsxs)(c.A,{style:[ee.menu,{backgroundColor:e.background.primary,borderColor:e.border}],children:[(0,p.jsxs)(c.A,{style:ee.userInfo,children:[(0,p.jsx)(d.A,{style:[ee.userName,{color:e.text.primary}],children:s?.user_metadata?.full_name||s?.email}),(0,p.jsx)(d.A,{style:[ee.userEmail,{color:e.text.secondary}],children:s?.email})]}),(0,p.jsx)(c.A,{style:[ee.menuDivider,{backgroundColor:e.border}]}),(0,p.jsx)(c.A,{style:ee.menuItem,children:(0,p.jsx)(X,{onPress:()=>{x(!0),r(!1)}})}),(0,p.jsxs)(h.A,{style:ee.menuItem,onPress:async()=>{try{const{error:e}=await N.N.auth.signOut();if(e)throw e;i(null),a(null),r(!1)}catch(e){_.A.alert("Error","Failed to sign out")}},children:["web"===m.A.OS?(0,p.jsx)(d.A,{style:{fontSize:20,color:e.text.primary},children:"\u21e5"}):(0,p.jsx)(O.A,{name:"log-out-outline",size:20,color:e.text.primary}),(0,p.jsx)(d.A,{style:[ee.menuItemText,{color:e.text.primary}],children:"Sign Out"})]})]}),(0,p.jsx)(M.A,{visible:g,transparent:!0,animationType:"fade",onRequestClose:()=>x(!1),children:(0,p.jsx)(c.A,{style:[ee.modalOverlay,{backgroundColor:"rgba(0, 0, 0, 0.5)"}],onStartShouldSetResponder:()=>!0,children:(0,p.jsx)(c.A,{style:[ee.modalContent,{backgroundColor:e.background.primary}],children:(0,p.jsx)($.G,{selectedFoils:[],onClose:()=>x(!1),initialTab:"saved",standalone:!0})})})}),b()]}):(0,p.jsxs)(c.A,{style:ee.container,children:[(0,p.jsx)(h.A,{style:[ee.signInButton,{backgroundColor:e.primary}],onPress:()=>u(!0),children:(0,p.jsx)(d.A,{style:[ee.signInText,{color:e.text.inverse}],children:"Sign In"})}),b()]})},ee=u.A.create({container:{position:"relative",zIndex:2100},signInButton:{paddingHorizontal:16,paddingVertical:8,borderRadius:8},signInText:{fontWeight:"600"},profileButton:{padding:8,zIndex:2100},avatarImage:{width:32,height:32,borderRadius:16},menu:{position:"absolute",top:"100%",right:0,borderRadius:8,padding:8,minWidth:240,shadowColor:"#000",shadowOffset:{width:0,height:2},shadowOpacity:.25,shadowRadius:3.84,elevation:5,borderWidth:1,zIndex:2100},userInfo:{padding:12},userName:{fontSize:16,fontWeight:"600",marginBottom:4},userEmail:{fontSize:14},menuDivider:{height:1,marginVertical:8},menuItem:{flexDirection:"row",alignItems:"center",padding:12,gap:8},menuItemText:{fontSize:16},modalOverlay:{position:"absolute",top:0,left:0,right:0,bottom:0,justifyContent:"center",alignItems:"center",padding:g.Y.LARGE,zIndex:2200},modalContent:{width:"100%",maxWidth:600,borderRadius:12,maxHeight:"90%",overflow:"hidden"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:g.Y.LARGE,borderBottomWidth:1},modalTitle:{fontSize:20,fontWeight:"600"},modalBody:{padding:g.Y.LARGE}});var te=r(9659),re=r(382);const ne=["children"],oe=o.lazy((()=>r.e(269).then(r.bind(r,3269)))),ie=o.lazy((()=>r.e(415).then(r.bind(r,6415)))),se=o.lazy((()=>r.e(358).then(r.bind(r,7358)))),ae=o.lazy((()=>r.e(951).then(r.bind(r,8951)))),le=o.lazy((()=>r.e(50).then(r.bind(r,3050)))),ce=o.lazy((()=>r.e(553).then(r.bind(r,4553)))),de=(0,I.A)();(0,v.Qq)().webUrl,te.JZ.browse,te.JZ.comparison,te.JZ.quiver,te.JZ.terms,te.JZ.privacy,te.JZ.contact;const ue=e=>{let{children:t}=e,r=(0,S.A)(e,ne);return(0,p.jsx)(o.Suspense,{fallback:(0,p.jsx)(j.I,{}),children:o.cloneElement(t,r)})},he=()=>{const e=(0,s.cq)(),{colors:t}=(0,y.D)(),{width:r}=(0,w.A)(),n=r<L.Dy,{foils:i}=(0,z.J)(),{searchQuery:a,setSearchQuery:l,filters:u,setFilters:h,columns:m,setColumns:g,setCurrentScreen:x}=(0,A.n)(),{filterOptions:b}=(0,P.c)(i,u),f=o.useMemo((()=>i?.length?[...new Set(i.map((e=>e.brand)))].sort():[]),[i]),j=()=>{e.navigate("Browse",{})},v=t=>{l(t),e.setParams({searchQuery:t})},S=e=>"Comparison"===e.name?"comparison":"Quiver"===e.name?"quiver":"browse",I=e=>{switch(e.name){case"Comparison":return"Search foils to add to comparison...";case"Quiver":return"Search foils to add to quiver...";default:return"Search foils..."}},T=t=>{"Browse"===t.name&&e.setParams({showSearchDropdown:!0})},O=(e,t)=>{((e,t)=>{h((r=>Object.assign({},r,{[e]:r[e].includes(t)?r[e].filter((e=>e!==t)):[...r[e],t]})))})(e,t)},k=()=>{h({brands:[],series:[],type:[]})},M=e=>{g((t=>t.map((t=>t.id===e?Object.assign({},t,{isVisible:!t.isVisible}):t))))},R=()=>{g(L._X)},q=o.useMemo((()=>(0,L.lD)(m)),[m]);o.useMemo((()=>(0,L.y6)(q,r,n)),[q,r,n]),o.useMemo((()=>n?"100%":Math.min(q+2*L.Op,r)),[q,r,n]);(0,o.useEffect)((()=>{(async()=>{try{const e=await(0,D.E7)();if(e){const t=L._X.map((t=>Object.assign({},t,{isVisible:"boolean"===typeof e[t.id]?e[t.id]:t.isVisible})));g(t)}}catch(e){}})()}),[]),(0,o.useEffect)((()=>{(async()=>{try{const e=await(0,D.Ir)();e&&h({brands:e.brands||[],series:e.series||[],type:e.types||[]})}catch(e){}})()}),[]);const B=o.useMemo((()=>{if(n)return{width:"100%",paddingHorizontal:L.Op};const e=(0,L.lD)(m);return{width:e,maxWidth:(0,L.y6)(e,r,!1),alignSelf:"center"}}),[m,r,n]);return(0,p.jsxs)(de.Navigator,{screenOptions:{headerStyle:{backgroundColor:t.background.primary},headerShadowVisible:!1},children:[(0,p.jsx)(de.Screen,{name:"Browse",options:({route:e})=>({headerTitle:e.params?.title||"",headerLeft:()=>(0,p.jsx)(c.A,{style:[me.headerOuterContainer,{backgroundColor:t.background.primary},!n&&{alignItems:"center"}],children:n?(0,p.jsx)(c.A,{style:me.headerMainContainerMobile,children:(0,p.jsx)(C.A,{onPress:j,style:({pressed:e})=>[me.logoContainer,e&&me.logoPressed],children:(0,p.jsx)(d.A,{style:[me.headerTitle,{color:t.primary}],children:"Foilquiver"})})}):(0,p.jsx)(c.A,{style:[me.headerMainContainerWeb,B],children:(0,p.jsxs)(c.A,{style:[me.headerContentWeb,{width:"100%",alignItems:"center",justifyContent:"space-between"}],children:[(0,p.jsx)(C.A,{onPress:j,style:({pressed:e})=>[me.logoContainer,e&&me.logoPressed],children:(0,p.jsx)(d.A,{style:[me.headerTitle,{color:t.primary}],children:"Foilquiver"})}),(0,p.jsx)(c.A,{style:[me.searchBarContainerWeb,{flex:1}],children:(0,p.jsx)(E,{value:a,onChangeText:e=>v(e),onClear:()=>v(""),mode:S(e),placeholder:I(e),onFocus:()=>T(e)})}),(0,p.jsx)(F,{filterOptions:b,selectedBrands:u.brands,selectedSeries:u.series,selectedTypes:u.type,onFilterChange:O,onClearFilters:k,columns:m,onColumnVisibilityChange:M,onResetColumns:R,foils:i})]})})}),headerRight:()=>n?(0,p.jsxs)(c.A,{style:me.headerRightContainerMobile,children:[(0,p.jsx)(c.A,{style:me.searchBarContainerMobile,children:(0,p.jsx)(E,{value:a,onChangeText:e=>v(e),onClear:()=>v(""),mode:S(e),placeholder:I(e),onFocus:()=>T(e)})}),(0,p.jsx)(F,{filterOptions:b,selectedBrands:u.brands,selectedSeries:u.series,selectedTypes:u.type,onFilterChange:O,onClearFilters:k,columns:m,onColumnVisibilityChange:M,onResetColumns:R,foils:i}),(0,p.jsx)(K,{})]}):(0,p.jsx)(c.A,{style:me.headerRightContainerWeb,children:(0,p.jsx)(K,{})})}),children:e=>(0,p.jsx)(ue,{children:(0,p.jsx)(oe,Object.assign({},e,{filters:u,onFilterChange:O,columns:m,brands:f}))})}),(0,p.jsx)(de.Screen,{name:"Comparison",options:({route:e})=>({headerTitle:e.params?.title||"",headerLeft:()=>(0,p.jsx)(c.A,{style:[me.headerOuterContainer,{backgroundColor:t.background.primary},!n&&{alignItems:"center"}],children:n?(0,p.jsx)(c.A,{style:me.headerMainContainerMobile,children:(0,p.jsx)(C.A,{onPress:j,style:({pressed:e})=>[me.logoContainer,e&&me.logoPressed],children:(0,p.jsx)(d.A,{style:[me.headerTitle,{color:t.primary}],children:"Foilquiver"})})}):(0,p.jsx)(c.A,{style:[me.headerMainContainerWeb,B],children:(0,p.jsxs)(c.A,{style:[me.headerContentWeb,{width:"100%",alignItems:"center",justifyContent:"space-between"}],children:[(0,p.jsx)(C.A,{onPress:j,style:({pressed:e})=>[me.logoContainer,e&&me.logoPressed],children:(0,p.jsx)(d.A,{style:[me.headerTitle,{color:t.primary}],children:"Foilquiver"})}),(0,p.jsx)(c.A,{style:[me.searchBarContainerWeb,{flex:1}],children:(0,p.jsx)(E,{value:a,onChangeText:e=>v(e),onClear:()=>v(""),mode:S(e),placeholder:I(e),onFocus:()=>T(e)})}),(0,p.jsx)(F,{filterOptions:b,selectedBrands:u.brands,selectedSeries:u.series,selectedTypes:u.type,onFilterChange:O,onClearFilters:k,columns:m,onColumnVisibilityChange:M,onResetColumns:R,foils:i})]})})}),headerRight:()=>n?(0,p.jsxs)(c.A,{style:me.headerRightContainerMobile,children:[(0,p.jsx)(c.A,{style:me.searchBarContainerMobile,children:(0,p.jsx)(E,{value:a,onChangeText:e=>v(e),onClear:()=>v(""),mode:S(e),placeholder:I(e),onFocus:()=>T(e)})}),(0,p.jsx)(F,{filterOptions:b,selectedBrands:u.brands,selectedSeries:u.series,selectedTypes:u.type,onFilterChange:O,onClearFilters:k,columns:m,onColumnVisibilityChange:M,onResetColumns:R,foils:i}),(0,p.jsx)(K,{})]}):(0,p.jsx)(c.A,{style:me.headerRightContainerWeb,children:(0,p.jsx)(K,{})})}),children:e=>(0,p.jsx)(ue,{children:(0,p.jsx)(ie,Object.assign({},e))})}),(0,p.jsx)(de.Screen,{name:"Quiver",options:({route:e})=>({headerTitle:e.params?.quiverName||"Quiver",headerLeft:()=>(0,p.jsx)(c.A,{style:[me.headerOuterContainer,{backgroundColor:t.background.primary},!n&&{alignItems:"center"}],children:n?(0,p.jsx)(c.A,{style:me.headerMainContainerMobile,children:(0,p.jsx)(C.A,{onPress:j,style:({pressed:e})=>[me.logoContainer,e&&me.logoPressed],children:(0,p.jsx)(d.A,{style:[me.headerTitle,{color:t.primary}],children:"Foilquiver"})})}):(0,p.jsx)(c.A,{style:[me.headerMainContainerWeb,B],children:(0,p.jsxs)(c.A,{style:[me.headerContentWeb,{width:"100%",alignItems:"center",justifyContent:"space-between"}],children:[(0,p.jsx)(C.A,{onPress:j,style:({pressed:e})=>[me.logoContainer,e&&me.logoPressed],children:(0,p.jsx)(d.A,{style:[me.headerTitle,{color:t.primary}],children:"Foilquiver"})}),(0,p.jsx)(c.A,{style:[me.searchBarContainerWeb,{flex:1}],children:(0,p.jsx)(E,{value:a,onChangeText:e=>v(e),onClear:()=>v(""),mode:S(e),placeholder:I(e),onFocus:()=>T(e)})}),(0,p.jsx)(F,{filterOptions:b,selectedBrands:u.brands,selectedSeries:u.series,selectedTypes:u.type,onFilterChange:O,onClearFilters:k,columns:m,onColumnVisibilityChange:M,onResetColumns:R,foils:i})]})})}),headerRight:()=>n?(0,p.jsxs)(c.A,{style:me.headerRightContainerMobile,children:[(0,p.jsx)(c.A,{style:me.searchBarContainerMobile,children:(0,p.jsx)(E,{value:a,onChangeText:e=>v(e),onClear:()=>v(""),mode:S(e),placeholder:I(e),onFocus:()=>T(e)})}),(0,p.jsx)(F,{filterOptions:b,selectedBrands:u.brands,selectedSeries:u.series,selectedTypes:u.type,onFilterChange:O,onClearFilters:k,columns:m,onColumnVisibilityChange:M,onResetColumns:R,foils:i}),(0,p.jsx)(K,{})]}):(0,p.jsx)(c.A,{style:me.headerRightContainerWeb,children:(0,p.jsx)(K,{})})}),children:e=>{const t=o.useMemo((()=>e.route.params?.foil_ids&&Array.isArray(i)?i.filter((t=>{if(!t)return!1;const r=(0,re.h)(t);return e.route.params.foil_ids.includes(r)})):[]),[e.route.params?.foil_ids,i]);return(0,p.jsx)(ue,{children:(0,p.jsx)(se,Object.assign({},e,{searchProps:{value:a,onChangeText:v,onClear:()=>l(""),mode:"quiver",placeholder:"Search foils in quiver..."},tableSettingsProps:{filterOptions:b,selectedBrands:u.brands,selectedSeries:u.series,selectedTypes:u.type,onFilterChange:O,onClearFilters:k,columns:m,onColumnVisibilityChange:M,onResetColumns:R,foils:t}}))})}}),(0,p.jsx)(de.Screen,{name:"Terms",options:{headerShown:!1},children:e=>(0,p.jsx)(ue,{children:(0,p.jsx)(le,Object.assign({},e))})}),(0,p.jsx)(de.Screen,{name:"Privacy",options:{headerShown:!1},children:e=>(0,p.jsx)(ue,{children:(0,p.jsx)(ae,Object.assign({},e))})}),(0,p.jsx)(de.Screen,{name:"Contact",options:{headerShown:!1},children:e=>(0,p.jsx)(ue,{children:(0,p.jsx)(ce,Object.assign({},e))})})]})},me=u.A.create({headerOuterContainer:{flex:1,paddingHorizontal:L.Op},headerMainContainerMobile:{flexDirection:"row",alignItems:"center",height:56,width:"100%"},headerRightContainerMobile:{flexDirection:"row",alignItems:"center",gap:8,paddingRight:12,zIndex:2e3},searchBarContainerMobile:{width:160,height:36},headerMainContainerWeb:{height:72,width:"100%"},headerContentWeb:{flexDirection:"row",alignItems:"center",gap:24,height:"100%",width:"100%"},searchBarContainerWeb:{flex:1,height:40},logoContainer:{height:"100%",justifyContent:"center",minWidth:120},logoPressed:{opacity:.7},headerTitle:{fontSize:24,fontWeight:"bold"},headerRightContainerWeb:{flexDirection:"row",alignItems:"center",gap:16,paddingRight:L.Op,zIndex:2e3}});(0,n.A)((function(){const e=(0,s.bE)(),t={prefixes:(0,v.vA)(),config:{screens:{Browse:{path:"/",parse:{mode:e=>e},stringify:{mode:e=>e}},Comparison:{path:"/comparison",exact:!0,stringify:{quiverName:e=>e,foils:e=>JSON.stringify(e)}},Quiver:{path:"/quiver/:quiverId",parse:{quiverId:e=>e,quiverName:e=>e,foils:e=>e?JSON.parse(e):void 0},stringify:{quiverId:e=>e,quiverName:e=>e,foils:e=>JSON.stringify(e)}},Terms:"/terms",Privacy:"/privacy",Contact:"/contact"}},getStateFromPath:(e,t)=>"/comparison"===e?{routes:[{name:"Comparison",params:{}}]}:(0,s.Bd)(e,t),getPathFromState:(e,t)=>{if("Comparison"===e.routes[e.routes.length-1].name)return"/comparison";return(0,s.Fy)(e,t)||"/"}};return(0,p.jsx)(y.N,{children:(0,p.jsx)(A.D,{children:(0,p.jsx)(a.vd,{children:(0,p.jsx)(x,{children:(0,p.jsx)(l.Oy,{children:(0,p.jsx)(i.A,{ref:e,linking:t,fallback:(0,p.jsx)(j.I,{}),children:(0,p.jsx)(he,{})})})})})})})}))},7821:(e,t,r)=>{r.d(t,{I:()=>d});r(6665);var n=r(3929),o=r(6283),i=r(530),s=r(3668),a=r(4667),l=r(2348),c=r(397);const d=({message:e="Loading...",size:t="large",fullScreen:r=!0})=>{const{colors:s}=(0,a.D)();return(0,c.jsxs)(n.A,{style:[u.container,r&&u.fullScreen,{backgroundColor:s.background.primary}],children:[(0,c.jsx)(i.A,{size:t,color:s.primary}),e&&(0,c.jsx)(o.A,{style:[u.message,{color:s.text.secondary}],children:e})]})},u=s.A.create({container:{padding:l.Y.LARGE,alignItems:"center",justifyContent:"center"},fullScreen:{flex:1},message:{marginTop:l.Y.MEDIUM,fontSize:16,textAlign:"center"}})},6447:(e,t,r)=>{r.d(t,{G:()=>v});var n=r(6665),o=r(3929),i=r(6283),s=r(3668),a=r(5648),l=r(8264),c=r(6773),d=r(4307),u=r(1690),h=r(5991),m=r(558),y=r(1385),g=r(2167),p=r(4812),x=r(4667),b=r(2763),f=r(2348),A=r(5025),j=r(397);const v=({selectedFoils:e=[],onClose:t,initialTab:r="save",standalone:s=!1,isModalVisible:f,hideStandaloneButton:v=!1})=>{const{colors:C}=(0,x.D)(),{width:w}=(0,m.A)(),I=w<b.Dy,T=(0,g.cq)(),[O,E]=(0,n.useState)(!s),k=void 0!==f?f:O,[M,R]=(0,n.useState)(""),[q,D]=(0,n.useState)(""),[F,B]=(0,n.useState)(!1),[z,P]=(0,n.useState)(r),[L,_]=(0,n.useState)(null),[W,N]=(0,n.useState)(""),{quivers:V,isLoading:U,error:Y,createQuiver:Q,deleteQuiver:G,reloadQuivers:H,updateQuiver:J}=(0,p.X)(),X=async()=>{if(L&&W.trim())try{await J(L,{name:W.trim()})&&((0,A.k4)(A.R2.UPDATE_QUIVER,{quiverId:L,action:"rename"}),"web"===h.A.OS?window.alert("Quiver renamed successfully"):u.A.alert("Success","Quiver renamed successfully"),_(null),N(""),H())}catch(Y){u.A.alert("Error","Failed to rename quiver")}},Z=e=>e.foil_ids&&Array.isArray(e.foil_ids)?e.foil_ids.length:0,$=(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(o.A,{style:[S.modalHeader,{borderBottomColor:C.border}],children:[(0,j.jsx)(i.A,{style:[S.modalTitle,{color:C.text.primary}],children:"Manage Quivers"}),t&&(0,j.jsx)(a.A,{onPress:t,children:"web"===h.A.OS?(0,j.jsx)(i.A,{style:{fontSize:24,color:C.text.primary},children:"\xd7"}):(0,j.jsx)(y.A,{name:"close",size:24,color:C.text.primary})})]}),e.length>0&&(0,j.jsxs)(o.A,{style:[S.tabContainer,{borderBottomColor:C.border}],children:[(0,j.jsx)(a.A,{style:[S.tab,"save"===z&&[S.activeTab,{borderBottomColor:C.primary}]],onPress:()=>P("save"),children:(0,j.jsx)(i.A,{style:[S.tabText,{color:"save"===z?C.primary:C.text.secondary}],children:"Save Quiver"})}),(0,j.jsx)(a.A,{style:[S.tab,"saved"===z&&[S.activeTab,{borderBottomColor:C.primary}]],onPress:()=>P("saved"),children:(0,j.jsx)(i.A,{style:[S.tabText,{color:"saved"===z?C.primary:C.text.secondary}],children:"Saved Quivers"})})]}),(0,j.jsx)(d.A,{style:S.modalBody,children:"save"===z&&e.length>0?(0,j.jsxs)(o.A,{style:S.form,children:[(0,j.jsxs)(o.A,{style:S.formField,children:[(0,j.jsx)(i.A,{style:[S.label,{color:C.text.secondary}],children:"Name"}),(0,j.jsx)(c.A,{style:[S.input,{color:C.text.primary,borderColor:C.border,backgroundColor:C.background.secondary}],value:M,onChangeText:R,placeholder:"Enter quiver name",placeholderTextColor:C.text.tertiary})]}),(0,j.jsxs)(o.A,{style:S.formField,children:[(0,j.jsx)(i.A,{style:[S.label,{color:C.text.secondary}],children:"Description (optional)"}),(0,j.jsx)(c.A,{style:[S.input,S.textArea,{color:C.text.primary,borderColor:C.border,backgroundColor:C.background.secondary}],value:q,onChangeText:D,placeholder:"Enter description",placeholderTextColor:C.text.tertiary,multiline:!0,numberOfLines:3})]}),(0,j.jsxs)(a.A,{style:S.publicToggle,onPress:()=>B(!F),children:["web"===h.A.OS?(0,j.jsx)(i.A,{style:{fontSize:24,color:F?C.primary:C.text.secondary,marginRight:8},children:F?"\u2611":"\u2610"}):(0,j.jsx)(y.A,{name:F?"checkbox":"square-outline",size:24,color:F?C.primary:C.text.secondary}),(0,j.jsx)(i.A,{style:[S.publicToggleText,{color:C.text.primary}],children:"Make this quiver public"})]}),(0,j.jsx)(a.A,{style:[S.createButton,{backgroundColor:C.primary}],onPress:async()=>{if(M.trim())try{if(!await Q({name:M.trim(),description:q.trim(),foils:e,is_public:F}))throw new Error("Failed to create quiver - no result returned");(0,A.k4)(A.R2.SAVE_QUIVER,{foilCount:e.length,isPublic:F}),"web"===h.A.OS?window.alert("Quiver saved successfully"):u.A.alert("Success","Quiver saved successfully"),R(""),D(""),B(!1),E(!1),t?.()}catch(Y){"web"===h.A.OS?window.alert(`Failed to save quiver: ${Y instanceof Error?Y.message:"Unknown error"}`):u.A.alert("Error",`Failed to save quiver: ${Y instanceof Error?Y.message:"Unknown error"}`)}else"web"===h.A.OS?window.alert("Please enter a name for your quiver"):u.A.alert("Error","Please enter a name for your quiver")},children:(0,j.jsx)(i.A,{style:[S.buttonText,{color:C.text.inverse}],children:"Save Quiver"})})]}):(0,j.jsx)(o.A,{style:S.quiverList,children:U?(0,j.jsx)(o.A,{style:S.centerContent,children:(0,j.jsx)(i.A,{style:[S.message,{color:C.text.secondary}],children:"Loading quivers..."})}):Y?(0,j.jsx)(o.A,{style:S.centerContent,children:(0,j.jsx)(i.A,{style:[S.message,{color:C.error}],children:Y})}):0===V.length?(0,j.jsx)(o.A,{style:S.centerContent,children:(0,j.jsx)(i.A,{style:[S.message,{color:C.text.secondary}],children:"No saved quivers yet"})}):V.map((e=>(0,j.jsxs)(o.A,{style:[S.quiverItem,{borderBottomColor:C.border}],children:[(0,j.jsx)(a.A,{style:S.quiverInfo,onPress:()=>(e=>{E(!1),t?.(),T.navigate("Quiver",{quiverId:e.id,quiverName:e.name,foil_ids:e.foil_ids||[]})})(e),children:L===e.id?(0,j.jsxs)(o.A,{style:S.renameContainer,children:[(0,j.jsx)(c.A,{style:[S.renameInput,{color:C.text.primary,borderColor:C.border,backgroundColor:C.background.secondary}],value:W,onChangeText:N,placeholder:"Enter new name",placeholderTextColor:C.text.tertiary,autoFocus:!0}),(0,j.jsx)(a.A,{style:[S.renameButton,{backgroundColor:C.error}],onPress:()=>{_(null),N("")},children:(0,j.jsx)(i.A,{style:[S.renameButtonText,{color:C.text.inverse}],children:"Cancel"})}),(0,j.jsx)(a.A,{style:[S.renameButton,{backgroundColor:C.primary}],onPress:X,children:(0,j.jsx)(i.A,{style:[S.renameButtonText,{color:C.text.inverse}],children:"Save"})})]}):(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(o.A,{style:S.quiverNameContainer,children:[(0,j.jsx)(i.A,{style:[S.quiverName,{color:C.text.primary}],children:e.name}),(0,j.jsx)(a.A,{onPress:()=>(e=>{_(e.id),N(e.name)})(e),style:S.renameIcon,children:"web"===h.A.OS?(0,j.jsx)(i.A,{style:{color:C.text.secondary},children:"\u270e"}):(0,j.jsx)(y.A,{name:"pencil",size:16,color:C.text.secondary})})]}),e.description&&(0,j.jsx)(i.A,{style:[S.quiverDescription,{color:C.text.secondary}],children:e.description}),(0,j.jsxs)(i.A,{style:[S.quiverMeta,{color:C.text.tertiary}],children:[Z(e)," foils \u2022 ",new Date(e.updated_at).toLocaleDateString(),e.is_public&&" \u2022 Public"]})]})}),"web"===h.A.OS?(0,j.jsx)("button",{type:"button",onClick:()=>{try{window.confirm("Are you sure you want to delete this quiver? This action cannot be undone.")&&G(e.id).then((e=>{e?H():window.alert("Failed to delete quiver")})).catch((e=>{window.alert("Error deleting quiver")}))}catch(Y){window.alert("Error in delete operation")}},style:{padding:"8px",borderWidth:"1px",borderStyle:"solid",borderColor:C.error,borderRadius:"8px",minWidth:"70px",backgroundColor:C.background.primary,cursor:"pointer",color:C.error,fontWeight:"600",fontSize:"14px",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10,position:"relative",pointerEvents:"auto"},children:"Delete"}):(0,j.jsx)(a.A,{style:[S.deleteButton,{borderColor:C.error,backgroundColor:C.background.primary}],onPress:()=>{(async e=>{try{if(!await new Promise((e=>{u.A.alert("Delete Quiver","Are you sure you want to delete this quiver? This action cannot be undone.",[{text:"Cancel",style:"cancel",onPress:()=>e(!1)},{text:"Delete",style:"destructive",onPress:()=>e(!0)}],{cancelable:!1})})))return;await G(e)?((0,A.k4)(A.R2.DELETE_QUIVER,{quiverId:e}),u.A.alert("Success","Quiver deleted successfully")):u.A.alert("Error","Failed to delete quiver. Please try again.")}catch(Y){u.A.alert("Error","An unexpected error occurred. Please try again.")}})(e.id)},children:(0,j.jsx)(y.A,{name:"trash-outline",size:20,color:C.error})})]},e.id)))})})]});return s?$:(0,j.jsxs)(j.Fragment,{children:[e.length>0&&!s&&!f&&!v&&(0,j.jsxs)(a.A,{style:[S.saveButton,{backgroundColor:C.primary}],onPress:()=>E(!0),children:["web"===h.A.OS?(0,j.jsx)(i.A,{style:{fontSize:20,color:C.text.inverse,marginRight:8},children:"+"}):(0,j.jsx)(y.A,{name:"bookmark-outline",size:20,color:C.text.inverse}),(0,j.jsx)(i.A,{style:[S.buttonText,{color:C.text.inverse}],children:"Save Quiver"})]}),(0,j.jsx)(l.A,{visible:k,transparent:!0,animationType:"fade",onRequestClose:()=>{E(!1),t?.()},children:(0,j.jsx)(a.A,{style:[S.modalOverlay,s&&S.standaloneOverlay],activeOpacity:1,onPress:()=>{E(!1),t?.()},children:(0,j.jsx)(a.A,{style:[S.modalContent,{backgroundColor:C.background.primary},I&&S.modalContentMobile],activeOpacity:1,onPress:e=>{e.preventDefault(),e.stopPropagation()},children:$})})})]})},S=s.A.create({saveButton:Object.assign({flexDirection:"row",alignItems:"center",justifyContent:"center",paddingHorizontal:f.Y.LARGE,paddingVertical:f.Y.MEDIUM,borderRadius:8,gap:8,minHeight:40,minWidth:120},"web"===h.A.OS&&{cursor:"pointer",pointerEvents:"auto",userSelect:"none",boxShadow:"0px 2px 4px rgba(0,0,0,0.1)"}),buttonText:Object.assign({fontSize:14,fontWeight:"600",textAlign:"center"},"web"===h.A.OS&&{userSelect:"none"}),modalOverlay:Object.assign({position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",padding:b.Op,zIndex:2e3},"web"===h.A.OS&&{position:"absolute",pointerEvents:"auto"}),modalContent:Object.assign({width:"100%",maxWidth:600,borderRadius:12,maxHeight:"90%",zIndex:2001},"web"===h.A.OS&&{pointerEvents:"auto",userSelect:"none"}),modalContentMobile:{maxWidth:"100%"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:f.Y.LARGE,borderBottomWidth:1},modalTitle:{fontSize:20,fontWeight:"600"},modalBody:{flex:1},tabContainer:{flexDirection:"row",borderBottomWidth:1},tab:{flex:1,paddingVertical:f.Y.MEDIUM,alignItems:"center"},activeTab:{borderBottomWidth:2},tabText:{fontSize:16,fontWeight:"500"},form:{padding:f.Y.LARGE},formField:{marginBottom:f.Y.LARGE},label:{fontSize:14,marginBottom:f.Y.SMALL},input:Object.assign({height:40,borderWidth:1,borderRadius:8,paddingHorizontal:f.Y.MEDIUM,fontSize:16},"web"===h.A.OS&&{outlineStyle:"none"}),textArea:{height:80,paddingTop:f.Y.MEDIUM,textAlignVertical:"top"},publicToggle:{flexDirection:"row",alignItems:"center",gap:f.Y.SMALL,marginBottom:f.Y.LARGE},publicToggleText:{fontSize:16},createButton:{paddingVertical:f.Y.MEDIUM,borderRadius:8,alignItems:"center"},quiverList:{padding:f.Y.LARGE},quiverItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:f.Y.MEDIUM,borderBottomWidth:1},quiverInfo:Object.assign({flex:1,marginRight:f.Y.MEDIUM},"web"===h.A.OS&&{cursor:"pointer"}),quiverName:{fontSize:16,fontWeight:"600",marginBottom:4},quiverDescription:{fontSize:14,marginBottom:4},quiverMeta:{fontSize:12},deleteButton:Object.assign({padding:f.Y.SMALL,borderWidth:1,borderRadius:8,minWidth:"web"===h.A.OS?70:40,alignItems:"center",justifyContent:"center",zIndex:10},"web"===h.A.OS&&{cursor:"pointer",pointerEvents:"auto",userSelect:"none",position:"relative"}),deleteIcon:{fontSize:14,fontWeight:"600"},centerContent:{padding:f.Y.LARGE,alignItems:"center"},message:{fontSize:16},standaloneOverlay:{position:"relative",backgroundColor:"transparent"},renameContainer:{flexDirection:"row",alignItems:"center",gap:f.Y.SMALL},renameInput:{flex:1,height:32,borderWidth:1,borderRadius:4,paddingHorizontal:f.Y.SMALL,fontSize:14},renameButton:{paddingHorizontal:f.Y.MEDIUM,paddingVertical:f.Y.SMALL,borderRadius:4},renameButtonText:{fontSize:12,fontWeight:"500"},quiverNameContainer:{flexDirection:"row",alignItems:"center",gap:f.Y.SMALL},renameIcon:Object.assign({padding:f.Y.SMALL},"web"===h.A.OS&&{cursor:"pointer"})})},3295:(e,t,r)=>{r.d(t,{Qq:()=>s,vA:()=>a});var n=r(5991);const o={NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"FoilQuiver",slug:"FoilQuiver",version:"1.0.0",orientation:"portrait",icon:"./assets/icon.png",userInterfaceStyle:"light",splash:{image:"./assets/splash-icon.png",resizeMode:"contain",backgroundColor:"#ffffff"},web:{},extra:{production:{baseUrl:"https://foilquiver.com"},staging:{baseUrl:"https://staging.foilquiver.com"}},sdkVersion:"52.0.0",platforms:["ios","android","web"]},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.EXPO_PUBLIC_ENV||"development",i={development:{apiUrl:"http://localhost:3000",webUrl:"http://localhost:19006",appScheme:"foilquiver-dev"},staging:{apiUrl:"https://api.staging.foilquiver.com",webUrl:"https://staging.foilquiver.com",appScheme:"foilquiver-staging"},production:{apiUrl:"https://api.foilquiver.com",webUrl:"https://foilquiver.com",appScheme:"foilquiver"}},s=()=>i[o],a=()=>{const e=s();return"web"===n.A.OS?[e.webUrl]:[`${e.appScheme}://`]}},2763:(e,t,r)=>{r.d(t,{Dy:()=>o,Op:()=>n,_X:()=>s,lD:()=>a,lU:()=>i,y6:()=>l});const n=16,o=768,i={brand:100,series:120,model:150,area:80,wingspan:80,aspectRatio:80,type:80,price:105,link:80},s=[{id:"brand",label:"Brand",isVisible:!0},{id:"series",label:"Series",isVisible:!1},{id:"model",label:"Model",isVisible:!0},{id:"area",label:"Area",isVisible:!0},{id:"wingspan",label:"Span",isVisible:!0},{id:"aspectRatio",label:"AR",isVisible:!0},{id:"type",label:"Type",isVisible:!0},{id:"price",label:"Price",isVisible:!0},{id:"link",label:"Link",isVisible:!0}],a=e=>e.reduce(((e,t)=>t.isVisible?e+(i[t.id]||100):e),0),l=(e,t,r)=>r?t:Math.min(e,t-48)},5663:(e,t,r)=>{r.d(t,{D:()=>l,n:()=>c});var n=r(6665),o=r(3600),i=r(2763),s=r(397);const a=(0,n.createContext)(void 0),l=({children:e})=>{const[t,r]=(0,n.useState)(""),[l,c]=(0,n.useState)({brands:[],series:[],type:[]}),[d,u]=(0,n.useState)(i._X),[h,m]=(0,n.useState)([]),[y,g]=(0,n.useState)(null);(0,n.useEffect)((()=>{(async()=>{try{const e=await(0,o.Ir)();e&&c({brands:e.brands||[],series:e.series||[],type:e.types||[]});const t=await(0,o.E7)();t&&Array.isArray(t)&&u(t.map((e=>Object.assign({},i._X.find((t=>t.id===e.id)),e))))}catch(e){}})()}),[]),(0,n.useEffect)((()=>{(0,o.ri)({brands:l.brands,series:l.series,types:l.type})}),[l]);const p={searchQuery:t,setSearchQuery:r,filters:l,setFilters:c,columns:d,setColumns:u,selectedFoils:h,setSelectedFoils:m,currentScreen:y,setCurrentScreen:g};return(0,s.jsx)(a.Provider,{value:p,children:e})},c=()=>{const e=(0,n.useContext)(a);if(void 0===e)throw new Error("useApp must be used within an AppProvider");return e}},2419:(e,t,r)=>{r.d(t,{c:()=>o});var n=r(6665);function o(e,t){const r=(0,n.useMemo)((()=>{const r=Array.from(new Set(e.map((e=>e.brand)))).sort(),n=function(e){return e.reduce(((e,t)=>(e[t.brand]||(e[t.brand]=[]),e[t.brand].push(t),e)),{})}(e);let o=[];if(0===t.brands.length)o=Array.from(new Set(e.map((e=>e.series)))).sort();else{const e=t.brands.flatMap((e=>n[e]||[]));o=Array.from(new Set(e.map((e=>e.series)))).sort()}return{brands:r,series:o,types:["front","tail"]}}),[e,t.brands]);return{filteredFoils:(0,n.useMemo)((()=>e.filter((e=>{const r=0===t.brands.length||t.brands.includes(e.brand),n=0===t.series.length||t.series.includes(e.series),o=0===t.type.length||t.type.includes(e.type);return r&&n&&o}))),[e,t.brands,t.series,t.type]),filterOptions:r}}},209:(e,t,r)=>{r.d(t,{J:()=>h});var n=r(467),o=r(296),i=r(6665),s=r(5458),a=r(3029),l=r(2901),c=r(5991),d=r(1087),u=(0,l.A)((function e(){(0,a.A)(this,e)}),null,[{key:"getBaseUrl",value:function(){return"https://foilquiver.com"}},{key:"getAllProducts",value:function(){var e=(0,n.A)((function*(){try{if(this.isWeb){var e=this.getBaseUrl();try{var t=yield fetch(`${e}${this.DATA_PATH}`);if(t.ok)return yield t.json()}catch(l){}try{var r=[];for(var n of["armstrong","lift-foils","axis-foils","code-foils","kt-foils","uni-foil"])try{var o=yield fetch(`${e}/${this.CACHE_DIR}/${n}.json`);if(o.ok){var i=yield o.json();r.push.apply(r,(0,s.A)(i))}}catch(l){}if(r.length>0)return r}catch(l){}}else{var a=yield d.A.getItem("foils");if(a)return JSON.parse(a)}}catch(l){}return[]}));return function(){return e.apply(this,arguments)}}()}]);function h(){var e=(0,i.useState)([]),t=(0,o.A)(e,2),r=t[0],s=t[1],a=(0,i.useState)(!0),l=(0,o.A)(a,2),c=l[0],d=l[1],h=(0,i.useState)(null),m=(0,o.A)(h,2),y=m[0],g=m[1],p=function(){var e=(0,n.A)((function*(){try{d(!0),g(null);var e=yield u.getAllProducts();s(e)}catch(t){g(t instanceof Error?t.message:"Failed to load foils")}finally{d(!1)}}));return function(){return e.apply(this,arguments)}}();(0,i.useEffect)((function(){p()}),[]);return{foils:r,loading:c,error:y,refreshFoils:function(){p()}}}u.isWeb="web"===c.A.OS,u.DATA_PATH="/data/foils.json",u.CACHE_DIR=".cache"},4812:(e,t,r)=>{r.d(t,{X:()=>g});var n=r(6665),o=r(1087),i=r(5991),s=r(5701),a=r(382),l=r(5501);const c="@foilquiver/quivers",d=()=>window.location.hostname.includes("staging")?"staging":"prod",u=()=>`${d()}_quivers`,h=async e=>"web"===i.A.OS?localStorage.getItem(e):o.A.getItem(e),m=async(e,t)=>{if("web"!==i.A.OS)return o.A.setItem(e,t);localStorage.setItem(e,t)},y=async e=>{if("web"!==i.A.OS)return o.A.removeItem(e);localStorage.removeItem(e)},g=()=>{const[e,t]=(0,n.useState)([]),[r,o]=(0,n.useState)(!0),[i,g]=(0,n.useState)(null),p=async()=>{try{o(!0),g(null);const{data:{session:e}}=await s.N.auth.getSession();if(e?.user){const{data:r,error:n}=await s.N.from(u()).select("*").eq("environment",d()).eq("user_id",e.user.id).order("updated_at",{ascending:!1});if(n)throw n;t(r||[])}else{const e=await h(c);t(e?JSON.parse(e):[])}}catch(e){g(e instanceof Error?e.message:"Failed to load quivers"),t([])}finally{o(!1)}};return(0,n.useEffect)((()=>{p();const{data:{subscription:e}}=s.N.auth.onAuthStateChange((async e=>{"SIGNED_IN"===e&&await(async()=>{try{const{data:{session:e}}=await s.N.auth.getSession();if(!e?.user)return;const t=await h(c);if(!t)return;const r=JSON.parse(t),n=d();for(const o of r){const t=o.foils.map((e=>(0,a.h)(e))),r={name:o.name,description:o.description||"",foil_ids:t,is_public:o.is_public||!1,user_id:e.user.id,environment:n};await s.N.from(u()).insert([r])}await y(c),await p()}catch(e){}})(),await p()}));return()=>{e.unsubscribe()}}),[]),{quivers:e,isLoading:r,error:i,createQuiver:async r=>{try{g(null);const{data:{session:n}}=await s.N.auth.getSession();if(n?.user){const e=u(),o=d(),i=r.foils.map((e=>(0,a.h)(e))),c={name:r.name,description:r.description||"",user_id:n.user.id,environment:o,foil_ids:i,is_public:r.is_public||!1},{error:h}=await s.N.from(e).insert(c);if(h)throw l.v.error("Insert error:",{message:h.message,details:h.details,hint:h.hint,code:h.code}),h;const{data:m,error:y}=await s.N.from(e).select("*").eq("user_id",n.user.id).eq("name",r.name).order("created_at",{ascending:!1}).limit(1).single();if(y)throw y;if(!m)throw new Error("Failed to retrieve created quiver");const g=Object.assign({},m,{foils:r.foils});return t((e=>[g,...e])),g}{const n=d(),o=r.foils.map((e=>(0,a.h)(e))),i={id:crypto.randomUUID(),user_id:"",name:r.name,description:r.description||"",foil_ids:o,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),is_public:r.is_public||!1,environment:n},s=[i,...e];return await m(c,JSON.stringify(s)),t(s),i}}catch(n){throw n}},updateQuiver:async(e,t)=>{g(null);try{const{data:{session:r}}=await s.N.auth.getSession();if(r?.user){const{error:r}=await s.N.from(u()).update(t).eq("id",e);if(r)throw r;return await p(),!0}}catch(i){return g("Failed to update quiver"),!1}},deleteQuiver:async r=>{try{g(null);const{data:{session:n}}=await s.N.auth.getSession();if(n?.user){const{error:e}=await s.N.from(u()).delete().eq("id",r).eq("user_id",n.user.id).eq("environment",d());if(e)throw e}const o=e.filter((e=>e.id!==r));return t(o),n?.user||await m(c,JSON.stringify(o)),!0}catch(n){return g(n instanceof Error?n.message:"Failed to delete quiver"),!1}},reloadQuivers:p}}},4667:(e,t,r)=>{r.d(t,{D:()=>u,N:()=>d});var n=r(6665),o=r(1243),i=r(1087),s=r(5713),a=r(397);const l=(0,n.createContext)(void 0),c="@foilquiver/theme",d=({children:e})=>{const t=(0,o.A)(),[r,d]=(0,n.useState)("dark"===t);(0,n.useEffect)((()=>{(async()=>{try{const e=await i.A.getItem(c);null!==e&&d("dark"===e)}catch(e){}})()}),[]);const u=(0,s.j)(r?"dark":"light");return(0,a.jsx)(l.Provider,{value:{isDark:r,colors:u,toggleTheme:async()=>{try{const e=!r;d(e),await i.A.setItem(c,e?"dark":"light")}catch(e){}}},children:e})},u=()=>{const e=(0,n.useContext)(l);if(void 0===e)throw new Error("useTheme must be used within a ThemeProvider");return e}},5713:(e,t,r)=>{r.d(t,{T:()=>h,j:()=>u});const n="#BF3475",o="#FFCE61",i="#F9FAFB",s="#E5E7EB",a="#374151",l="#111827",c={background:{primary:i,secondary:"#F3F4F6",tertiary:s},text:{primary:l,secondary:a,tertiary:"#6B7280",inverse:i},border:s,primary:n,error:"#DC2626",success:"#059669",warning:o},d={background:{primary:l,secondary:"#1F2937",tertiary:a},text:{primary:i,secondary:s,tertiary:"#9CA3AF",inverse:l},border:a,primary:n,error:"#EF4444",success:"#10B981",warning:o},u=e=>"dark"===e?d:c,h=c},2348:(e,t,r)=>{r.d(t,{Y:()=>n});const n={XSMALL:4,SMALL:8,MEDIUM:12,LARGE:16,XLARGE:24,XXLARGE:32,CONTAINER_PADDING:24,BUTTON_PADDING_H:16,BUTTON_PADDING_V:8,BUTTON_GAP:12,CONTROLS_BOTTOM:24}},5025:(e,t,r)=>{r.d(t,{R2:()=>a,k4:()=>s,oe:()=>i});var n=r(5991);const o=e=>{"web"===n.A.OS&&window.plausible&&window.plausible(e.name,e.props?{props:e.props}:void 0)},i=(e,t)=>{o({name:"pageview",props:Object.assign({page:e},t)})},s=(e,t)=>{o({name:e,props:t})},a={VIEW_COMPARISON:"view_comparison",VIEW_QUIVER:"view_quiver",COMPARE_FOILS:"compare_foils",SAVE_QUIVER:"save_quiver",DELETE_QUIVER:"delete_quiver",UPDATE_QUIVER:"update_quiver",FILTER_FOILS:"filter_foils",SORT_FOILS:"sort_foils",SEARCH_FOILS:"search_foils"}},382:(e,t,r)=>{r.d(t,{h:()=>n});const n=e=>`${e.brand.toLowerCase()}-${e.model.toLowerCase().replace(/\s+/g,"-")}`},5501:(e,t,r)=>{r.d(t,{v:()=>o});class n{isDevelopment=!1;constructor(){this.isDevelopment}static getInstance(){return n.instance||(n.instance=new n),n.instance}log(e,t,...r){if(this.isDevelopment||"error"===e){(new Date).toISOString(),e.toUpperCase();e}}debug(e,...t){this.log("debug",e,...t)}info(e,...t){this.log("info",e,...t)}warn(e,...t){this.log("warn",e,...t)}error(e,...t){this.log("error",e,...t)}}const o=n.getInstance()},9659:(e,t,r)=>{r.d(t,{JZ:()=>n});const n={browse:"/",comparison:"/comparison",quiver:"/quiver/:quiverId",terms:"/terms",privacy:"/privacy",contact:"/contact"}},3600:(e,t,r)=>{r.d(t,{E7:()=>c,Ir:()=>a,QZ:()=>u,pC:()=>d,pF:()=>l,ri:()=>s});var n=r(1087),o=r(5501);const i={FILTERS:"@foilquiver/filters",COLUMNS:"@foilquiver/columns",THEME:"@foilquiver/theme",SORT:"@foilquiver/sort"};new class{async set(e,t){try{const r=JSON.stringify(t);await n.A.setItem(e,r)}catch(r){throw o.v.error("Error setting storage item:",r),r}}async get(e){try{const t=await n.A.getItem(e);return null!=t?JSON.parse(t):null}catch(t){throw o.v.error("Error getting storage item:",t),t}}async remove(e){try{await n.A.removeItem(e)}catch(t){throw o.v.error("Error removing storage item:",t),t}}async clear(){try{await n.A.clear()}catch(e){throw o.v.error("Error clearing storage:",e),e}}async getAllKeys(){try{return await n.A.getAllKeys()}catch(e){throw o.v.error("Error getting all storage keys:",e),e}}};const s=async e=>{try{await n.A.setItem(i.FILTERS,JSON.stringify(e))}catch(t){}},a=async()=>{try{const e=await n.A.getItem(i.FILTERS);return e?JSON.parse(e):null}catch(e){return null}},l=async e=>{try{await n.A.setItem(i.COLUMNS,JSON.stringify(e))}catch(t){}},c=async()=>{try{const e=await n.A.getItem(i.COLUMNS);return e?JSON.parse(e):null}catch(e){return null}},d=async e=>{try{await n.A.setItem(i.SORT,JSON.stringify(e))}catch(t){}},u=async()=>{try{const e=await n.A.getItem(i.SORT);return e?JSON.parse(e):null}catch(e){return null}}},5701:(e,t,r)=>{r.d(t,{N:()=>i});var n=r(8418),o=r(5991);const i=(0,n.UU)("https://zhylhvuhhoialsgqrxxr.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpoeWxodnVoaG9pYWxzZ3FyeHhyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzkxNjM3NTgsImV4cCI6MjA1NDczOTc1OH0.wrZ05wA3EcbBubG3Mrxmx--fA9ThE2_M9k9WYTmGpag",{auth:{detectSessionInUrl:"web"===o.A.OS,flowType:"pkce",autoRefreshToken:!0,persistSession:!0}})}},e=>{e.O(0,[925],(()=>{return t=9155,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=main.2af861a1.js.map