(self.webpackChunkweb=self.webpackChunkweb||[]).push([[792],{640:(e,t,r)=>{var n=r(2299),o=r(6665),s=r(6520),i=r(2167),a=r(5229),l=r(8833),c=r(3929),d=r(6283),u=r(3668),h=r(5648),m=r(5991),y=r(4667),p=r(2348),g=r(397);class x extends o.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){}handleRetry=()=>{this.setState({hasError:!1,error:null})};render(){return this.state.hasError?(0,g.jsx)(b,{error:this.state.error,onRetry:this.handleRetry}):this.props.children}}const b=({error:e,onRetry:t})=>{const{colors:r}=(0,y.D)();return(0,g.jsx)(c.A,{style:[A.container,{backgroundColor:r.background.primary}],children:(0,g.jsxs)(c.A,{style:A.content,children:[(0,g.jsx)(d.A,{style:[A.title,{color:r.error}],children:"Something went wrong"}),(0,g.jsx)(d.A,{style:[A.message,{color:r.text.secondary}],children:e?.message||"An unexpected error occurred"}),(0,g.jsx)(h.A,{style:[A.button,{backgroundColor:r.primary}],onPress:t,children:(0,g.jsx)(d.A,{style:[A.buttonText,{color:r.text.inverse}],children:"Try Again"})}),!1]})})},A=u.A.create({container:{flex:1,alignItems:"center",justifyContent:"center",padding:p.Y.LARGE},content:{maxWidth:600,width:"100%",alignItems:"center"},title:{fontSize:24,fontWeight:"bold",marginBottom:p.Y.MEDIUM,textAlign:"center"},message:{fontSize:16,marginBottom:p.Y.LARGE,textAlign:"center"},button:Object.assign({paddingHorizontal:p.Y.LARGE,paddingVertical:p.Y.MEDIUM,borderRadius:8,marginBottom:p.Y.LARGE},"web"===m.A.OS&&{cursor:"pointer"}),buttonText:{fontSize:16,fontWeight:"600"},stack:{fontSize:12,fontFamily:"ios"===m.A.OS?"Menlo":"monospace",marginTop:p.Y.LARGE,padding:p.Y.MEDIUM,width:"100%"}});var f=r(5663),j=r(7821),v=r(6447),S=r(3295),w=r(8587),C=r(5708),I=r(558),T=r(13),O=r(6773),E=r(1385);const k=({value:e,onChangeText:t,onClear:r,placeholder:n="Search foils...",autoFocus:o=!1,mode:s="browse",onFocus:i})=>{const{colors:a}=(0,y.D)();return(0,g.jsxs)(c.A,{style:[D.container,{backgroundColor:a.background.secondary}],children:["web"===m.A.OS?(0,g.jsx)(d.A,{style:[D.searchIcon,{color:a.text.secondary}],children:"\ud83d\udd0d"}):(0,g.jsx)(E.A,{name:"search",size:20,color:a.text.secondary}),(0,g.jsx)(O.A,Object.assign({style:[D.input,{color:a.text.primary}],value:e,onChangeText:t,placeholder:(()=>{switch(s){case"comparison":return"Search foils to add to comparison...";case"quiver":return"Search foils to add to quiver...";default:return"Search foils..."}})(),placeholderTextColor:a.text.tertiary,autoFocus:o,onFocus:i,autoCapitalize:"none",autoCorrect:!1,clearButtonMode:"never",returnKeyType:"search",maxFontSizeMultiplier:1},"web"===m.A.OS?{spellCheck:!1,autoComplete:"off"}:{keyboardType:"web-search"})),""!==e&&(0,g.jsx)(h.A,{onPress:r,style:D.clearButton,children:"web"===m.A.OS?(0,g.jsx)(d.A,{style:[D.clearIcon,{color:a.text.secondary}],children:"\u2715"}):(0,g.jsx)(E.A,{name:"close-circle",size:20,color:a.text.secondary})})]})},D=u.A.create({container:{flexDirection:"row",alignItems:"center",paddingHorizontal:p.Y.MEDIUM,height:40,borderRadius:8,gap:p.Y.SMALL},input:Object.assign({flex:1,fontSize:16,height:"100%"},"web"===m.A.OS&&{outlineStyle:"none",border:"none",background:"transparent",lineHeight:40}),clearButton:Object.assign({height:"100%",aspectRatio:1,alignItems:"center",justifyContent:"center"},"web"===m.A.OS&&{cursor:"pointer"}),searchIcon:{fontSize:16,width:20,height:20,textAlign:"center",lineHeight:20},clearIcon:{fontSize:16,width:20,height:20,textAlign:"center",lineHeight:20}});var M=r(8264),B=r(4307),q=r(484),R=r(1690),P=r(9149),_=r(3600),z=r(5701),N=r(530),F=r(5713);const L=()=>{const[e,t]=(0,o.useState)(!1);return{signInWithGoogle:async()=>{try{if(t(!0),"web"!==m.A.OS)return{data:null,error:new Error("Mobile authentication not yet implemented")};const e=(()=>{if("web"!==m.A.OS)return;const e=window.location.origin,t=window.location.hostname;return"localhost"===t||t.includes("127.0.0.1")?"http://localhost:19006":e})(),{data:r,error:n}=await z.N.auth.signInWithOAuth({provider:"google",options:{redirectTo:e,queryParams:{access_type:"offline",prompt:"consent"}}});return{data:r,error:n}}catch(e){return{data:null,error:e}}finally{t(!1)}},isLoading:e}};var W=r(3710);const V=({onSuccess:e})=>{const{signInWithGoogle:t,isLoading:r}=L();return(0,g.jsx)(h.A,{style:U.button,onPress:async()=>{try{const{error:r}=await t();if(r)return void R.A.alert("Sign In Error",r instanceof W.lR?r.message:"Failed to sign in");e?.()}catch(r){R.A.alert("Error","An unexpected error occurred during sign in.")}},disabled:r,children:r?(0,g.jsx)(N.A,{color:F.T.text.inverse}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(E.A,{name:"logo-google",size:24,color:F.T.text.inverse,style:U.icon}),(0,g.jsx)(d.A,{style:U.buttonText,children:"Sign in with Google"})]})})},U=u.A.create({button:{flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:F.T.primary,padding:12,borderRadius:8,minWidth:220},buttonText:{color:F.T.text.inverse,fontSize:16,fontWeight:"600"},icon:{marginRight:8}});function Q({filterOptions:e,selectedBrands:t,selectedSeries:r,selectedTypes:n,onFilterChange:s,onClearFilters:i,columns:a,onColumnVisibilityChange:l,onResetColumns:u,foils:h}){const[p,x]=(0,o.useState)(!1),[b,A]=(0,o.useState)("filters"),{colors:f,isDark:j,toggleTheme:S}=(0,y.D)(),[w,I]=(0,o.useState)(null),[T,O]=(0,o.useState)(null),[k,D]=(0,o.useState)(!1);(0,o.useEffect)((()=>{z.N.auth.getSession().then((({data:{session:e}})=>{I(e),O(e?.user??null)}));const{data:{subscription:e}}=z.N.auth.onAuthStateChange(((e,t)=>{I(t),O(t?.user??null)}));return()=>e.unsubscribe()}),[]),(0,o.useEffect)((()=>{(async()=>{try{const e=await(0,_.Ir)();e&&(e.brands.forEach((e=>s("brands",e))),e.series.forEach((e=>s("series",e))),e.types.forEach((e=>s("type",e))));const t=await(0,_.E7)();if(t){const e=Object.fromEntries(a.map((e=>[e.id,e.isVisible])));Object.entries(t).forEach((([t,r])=>{e[t]!==r&&l(t)}))}}catch(e){}})()}),[]),(0,o.useEffect)((()=>{(async()=>{try{const e={brands:t,series:r,types:n};await(0,_.ri)(e)}catch(e){}})()}),[t,r,n]),(0,o.useEffect)((()=>{(async()=>{try{const e={};a.forEach((t=>{e[t.id]=t.isVisible})),await(0,_.pF)(e)}catch(e){}})()}),[a]);const N=async()=>{try{const{error:e}=await z.N.auth.signOut();if(e)throw e;I(null),O(null),x(!1)}catch(e){R.A.alert("Error","Failed to sign out")}},F=(0,o.useMemo)((()=>{if(0===t.length)return e.series;const r=new Set;return h.forEach((e=>{t.includes(e.brand)&&e.series&&r.add(e.series)})),Array.from(r).sort()}),[e.series,t,h]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(C.A,{onPress:()=>x(!0),style:[Y.iconButton,{backgroundColor:f.background.secondary}],children:(0,g.jsx)(P.A,{name:"settings",size:24,color:f.text.primary})}),(0,g.jsx)(M.A,{visible:p,transparent:!0,animationType:"fade",onRequestClose:()=>x(!1),children:(0,g.jsx)(C.A,{style:[Y.modalOverlay,{backgroundColor:j?"rgba(0, 0, 0, 0.7)":"rgba(0, 0, 0, 0.5)"}],onPress:()=>x(!1),children:(0,g.jsxs)(C.A,{style:[Y.modalContent,{backgroundColor:f.background.primary}],onPress:e=>e.stopPropagation(),children:[(0,g.jsxs)(c.A,{style:[Y.modalHeader,{borderBottomColor:f.border}],children:[(0,g.jsx)(d.A,{style:[Y.modalTitle,{color:f.text.primary}],children:"Settings"}),(0,g.jsx)(C.A,{onPress:()=>x(!1),style:Y.closeButton,children:(0,g.jsx)(P.A,{name:"close",size:24,color:f.text.secondary})})]}),(0,g.jsxs)(c.A,{style:[Y.tabs,{borderBottomColor:f.border}],children:[(0,g.jsx)(C.A,{style:[Y.tab,"filters"===b&&[Y.activeTab,{borderBottomColor:f.primary}]],onPress:()=>A("filters"),children:(0,g.jsxs)(d.A,{style:[Y.tabText,{color:f.text.secondary},"filters"===b&&[Y.activeTabText,{color:f.primary}]],children:["Filters ",(t.length>0||r.length>0||n.length>0)&&"\u2022"]})}),(0,g.jsx)(C.A,{style:[Y.tab,"columns"===b&&[Y.activeTab,{borderBottomColor:f.primary}]],onPress:()=>A("columns"),children:(0,g.jsxs)(d.A,{style:[Y.tabText,{color:f.text.secondary},"columns"===b&&[Y.activeTabText,{color:f.primary}]],children:["Columns ",a.some((e=>!e.isVisible))&&"\u2022"]})}),(0,g.jsx)(C.A,{style:[Y.tab,"appearance"===b&&[Y.activeTab,{borderBottomColor:f.primary}]],onPress:()=>A("appearance"),children:(0,g.jsx)(d.A,{style:[Y.tabText,{color:f.text.secondary},"appearance"===b&&[Y.activeTabText,{color:f.primary}]],children:"Appearance"})}),(0,g.jsx)(C.A,{style:[Y.tab,"account"===b&&[Y.activeTab,{borderBottomColor:f.primary}]],onPress:()=>A("account"),children:(0,g.jsx)(d.A,{style:[Y.tabText,{color:f.text.secondary},"account"===b&&[Y.activeTabText,{color:f.primary}]],children:"Account"})})]}),"filters"===b?(0,g.jsx)(c.A,{style:Y.contentWrapper,children:(0,g.jsx)(B.A,{style:Y.scrollView,contentContainerStyle:Y.scrollContent,children:(0,g.jsxs)(c.A,{style:Y.content,children:[(0,g.jsxs)(c.A,{style:Y.headerWithAction,children:[(0,g.jsx)(d.A,{style:[Y.contentTitle,{color:f.text.primary}],children:"Active Filters"}),(t.length>0||r.length>0||n.length>0)&&(0,g.jsx)(C.A,{onPress:i,style:[Y.clearButton,{backgroundColor:f.background.secondary}],children:(0,g.jsx)(d.A,{style:[Y.clearButtonText,{color:f.text.secondary}],children:"Clear All"})})]}),(0,g.jsxs)(c.A,{style:Y.section,children:[(0,g.jsx)(d.A,{style:[Y.sectionTitle,{color:f.text.primary}],children:"Brand"}),(0,g.jsx)(c.A,{style:Y.chipContainer,children:e.brands.map((e=>(0,g.jsx)(C.A,{style:[Y.chip,{backgroundColor:f.background.secondary},t.includes(e)&&[Y.chipSelected,{backgroundColor:f.primary}]],onPress:()=>s("brands",e),children:(0,g.jsx)(d.A,{style:[Y.chipText,{color:f.text.secondary},t.includes(e)&&[Y.chipTextSelected,{color:f.text.inverse}]],children:e})},e)))})]}),(0,g.jsxs)(c.A,{style:Y.section,children:[(0,g.jsx)(d.A,{style:[Y.sectionTitle,{color:f.text.primary}],children:"Type"}),(0,g.jsx)(c.A,{style:Y.chipContainer,children:e.types.map((e=>(0,g.jsx)(C.A,{style:[Y.chip,{backgroundColor:f.background.secondary},n.includes(e)&&[Y.chipSelected,{backgroundColor:f.primary}]],onPress:()=>s("type",e),children:(0,g.jsx)(d.A,{style:[Y.chipText,{color:f.text.secondary},n.includes(e)&&[Y.chipTextSelected,{color:f.text.inverse}]],children:e})},e)))})]}),(0,g.jsxs)(c.A,{style:Y.section,children:[(0,g.jsx)(d.A,{style:[Y.sectionTitle,{color:f.text.primary}],children:"Series"}),(0,g.jsx)(c.A,{style:Y.chipContainer,children:F.length>0?F.map((e=>(0,g.jsx)(C.A,{style:[Y.chip,{backgroundColor:f.background.secondary},r.includes(e)&&[Y.chipSelected,{backgroundColor:f.primary}]],onPress:()=>s("series",e),children:(0,g.jsx)(d.A,{style:[Y.chipText,{color:f.text.secondary},r.includes(e)&&[Y.chipTextSelected,{color:f.text.inverse}]],children:e})},e))):(0,g.jsx)(d.A,{style:[Y.noSeriesText,{color:f.text.secondary}],children:"No series available for selected brands"})})]})]})})}):"columns"===b?(0,g.jsx)(c.A,{style:Y.contentWrapper,children:(0,g.jsx)(B.A,{style:Y.scrollView,contentContainerStyle:Y.scrollContent,children:(0,g.jsxs)(c.A,{style:Y.content,children:[(0,g.jsxs)(c.A,{style:Y.headerWithAction,children:[(0,g.jsx)(d.A,{style:[Y.contentTitle,{color:f.text.primary}],children:"Visible Columns"}),a.some((e=>!e.isVisible))&&(0,g.jsx)(C.A,{onPress:async()=>{u();try{const e={};a.forEach((t=>{e[t.id]=t.isVisible})),await(0,_.pF)(e)}catch(e){}},style:[Y.clearButton,{backgroundColor:f.background.secondary}],children:(0,g.jsx)(d.A,{style:[Y.clearButtonText,{color:f.text.secondary}],children:"Reset"})})]}),(0,g.jsx)(c.A,{style:Y.columnList,children:a.map((e=>(0,g.jsxs)(C.A,{style:Y.columnItem,onPress:()=>(async e=>{l(e)})(e.id),children:[(0,g.jsx)(d.A,{style:[Y.columnLabel,{color:f.text.primary}],children:e.label}),(0,g.jsx)(c.A,{style:[Y.checkbox,{borderColor:f.border},e.isVisible&&[Y.checkboxChecked,{backgroundColor:f.primary,borderColor:f.primary}]],children:e.isVisible&&(0,g.jsx)(P.A,{name:"check",size:16,color:f.text.inverse})})]},e.id)))})]})})}):"appearance"===b?(0,g.jsx)(c.A,{style:Y.contentWrapper,children:(0,g.jsx)(B.A,{style:Y.scrollView,contentContainerStyle:Y.scrollContent,children:(0,g.jsxs)(c.A,{style:Y.content,children:[(0,g.jsx)(d.A,{style:[Y.contentTitle,{color:f.text.primary}],children:"Theme Settings"}),(0,g.jsx)(c.A,{style:Y.section,children:(0,g.jsx)(C.A,{style:[Y.menuButton,{backgroundColor:f.background.secondary}],onPress:S,children:(0,g.jsxs)(c.A,{style:Y.menuButtonContent,children:[(0,g.jsx)(P.A,{name:j?"dark-mode":"light-mode",size:20,color:f.text.primary}),(0,g.jsx)(d.A,{style:[Y.menuButtonText,{color:f.text.primary}],children:j?"Dark Mode":"Light Mode"})]})})})]})})}):w?(0,g.jsx)(c.A,{style:Y.contentWrapper,children:(0,g.jsx)(B.A,{style:Y.scrollView,contentContainerStyle:Y.scrollContent,children:(0,g.jsxs)(c.A,{style:Y.content,children:[(0,g.jsxs)(c.A,{style:Y.userInfo,children:[T?.user_metadata?.avatar_url&&(0,g.jsx)(q.A,{source:{uri:T.user_metadata.avatar_url},style:Y.avatarImage}),(0,g.jsxs)(c.A,{style:Y.userTextInfo,children:[(0,g.jsx)(d.A,{style:[Y.userName,{color:f.text.primary}],children:T?.user_metadata?.full_name||T?.email}),(0,g.jsx)(d.A,{style:[Y.userEmail,{color:f.text.secondary}],children:T?.email})]})]}),(0,g.jsx)(c.A,{style:[Y.menuDivider,{backgroundColor:f.border}]}),(0,g.jsxs)(c.A,{style:Y.section,children:[(0,g.jsx)(d.A,{style:[Y.sectionTitle,{color:f.text.primary}],children:"Quivers"}),(0,g.jsxs)(C.A,{style:[Y.menuButton,{backgroundColor:f.background.secondary}],onPress:()=>{D(!0)},children:[(0,g.jsxs)(c.A,{style:Y.menuButtonContent,children:["web"===m.A.OS?(0,g.jsx)(d.A,{style:{fontSize:20,color:f.text.primary},children:"\ud83c\udfaf"}):(0,g.jsx)(E.A,{name:"bookmark-outline",size:20,color:f.text.primary}),(0,g.jsx)(d.A,{style:[Y.menuButtonText,{color:f.text.primary}],children:"Manage Quivers"})]}),(0,g.jsx)(P.A,{name:"chevron-right",size:20,color:f.text.secondary})]})]}),(0,g.jsx)(c.A,{style:Y.section,children:(0,g.jsx)(C.A,{style:[Y.signOutButton,{backgroundColor:f.background.secondary}],onPress:N,children:(0,g.jsxs)(c.A,{style:Y.menuButtonContent,children:["web"===m.A.OS?(0,g.jsx)(d.A,{style:{fontSize:20,color:f.text.primary},children:"\u21e5"}):(0,g.jsx)(E.A,{name:"log-out-outline",size:20,color:f.text.primary}),(0,g.jsx)(d.A,{style:[Y.menuButtonText,{color:f.text.primary}],children:"Sign Out"})]})})})]})})}):(0,g.jsx)(c.A,{style:Y.contentWrapper,children:(0,g.jsxs)(c.A,{style:Y.content,children:[(0,g.jsx)(d.A,{style:[Y.contentTitle,{color:f.text.primary,marginBottom:16}],children:"Sign In"}),(0,g.jsx)(V,{onSuccess:()=>{x(!1)}})]})})]})})}),(0,g.jsx)(M.A,{visible:k,transparent:!0,animationType:"fade",onRequestClose:()=>D(!1),children:(0,g.jsx)(c.A,{style:[Y.modalOverlay,{backgroundColor:"rgba(0, 0, 0, 0.5)"}],onStartShouldSetResponder:()=>!0,children:(0,g.jsx)(c.A,{style:[Y.modalContent,{backgroundColor:f.background.primary}],children:(0,g.jsx)(v.G,{selectedFoils:[],onClose:()=>D(!1),initialTab:"saved",standalone:!0})})})})]})}const Y=u.A.create({container:{position:"relative"},button:{padding:p.Y.MEDIUM},iconButton:{padding:p.Y.XSMALL,borderRadius:8},modalContent:{width:"100%",maxWidth:600,borderRadius:12,maxHeight:"90%",overflow:"hidden"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:p.Y.LARGE,borderBottomWidth:1},buttonGroup:{flexDirection:"row",alignItems:"center",gap:p.Y.SMALL},columnGroup:{flexDirection:"column",gap:p.Y.MEDIUM},filterGroup:{padding:p.Y.MEDIUM},filterList:{gap:p.Y.MEDIUM},modalOverlay:{flex:1,justifyContent:"center",alignItems:"center",padding:p.Y.LARGE},modalTitle:{fontSize:18,fontWeight:"600"},closeButton:{padding:4},tabs:{flexDirection:"row",borderBottomWidth:1},tab:{flex:1,padding:12,alignItems:"center"},activeTab:{borderBottomWidth:2},tabText:{fontSize:14,fontWeight:"500"},activeTabText:{},content:{padding:16,width:"100%"},contentWrapper:{flex:1},scrollView:{flex:1},scrollContent:{flexGrow:1},section:{marginBottom:24},sectionTitle:{fontSize:14,fontWeight:"600",marginBottom:12},chipContainer:{flexDirection:"row",flexWrap:"wrap",gap:8},chip:{borderRadius:16,paddingHorizontal:12,paddingVertical:6},chipSelected:{},chipText:{fontSize:14},chipTextSelected:{},columnList:{gap:12},columnItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:8},columnLabel:{fontSize:14},checkbox:{width:20,height:20,borderRadius:4,borderWidth:2,alignItems:"center",justifyContent:"center"},checkboxChecked:{},headerWithAction:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},contentTitle:{fontSize:16,fontWeight:"600"},clearButton:{paddingHorizontal:12,paddingVertical:6,borderRadius:16},clearButtonText:{fontSize:14},noSeriesText:{fontSize:14,fontWeight:"500"},userInfo:{flexDirection:"row",alignItems:"center",gap:12,marginBottom:16},userTextInfo:{flex:1},avatarImage:{width:48,height:48,borderRadius:24},userName:{fontSize:16,fontWeight:"600",marginBottom:4},userEmail:{fontSize:14},menuDivider:{height:1,marginBottom:16},menuButton:Object.assign({flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:12,borderRadius:8},"web"===m.A.OS&&{cursor:"pointer"}),menuButtonContent:{flexDirection:"row",alignItems:"center",gap:12},menuButtonText:{fontSize:14,fontWeight:"500"},signOutButton:Object.assign({flexDirection:"row",alignItems:"center",padding:12,borderRadius:8},"web"===m.A.OS&&{cursor:"pointer"})});var G=r(209),J=r(2419),H=r(2763),X=r(9659),Z=r(382);const $=["children"],K=o.lazy((()=>r.e(269).then(r.bind(r,3269)))),ee=o.lazy((()=>r.e(415).then(r.bind(r,6415)))),te=o.lazy((()=>r.e(358).then(r.bind(r,7358)))),re=o.lazy((()=>r.e(951).then(r.bind(r,8951)))),ne=o.lazy((()=>r.e(50).then(r.bind(r,3050)))),oe=o.lazy((()=>r.e(553).then(r.bind(r,4553)))),se=(0,T.A)(),ie={home:"home-outline",browse:"search-outline",compare:"git-compare-outline",settings:"settings-outline",quiver:"bookmark-outline"};function ae({name:e,color:t}){if("web"===m.A.OS){const r={home:"\ud83c\udfe0",browse:"\ud83d\udd0d",compare:"\u2696\ufe0f",settings:"\u2699\ufe0f",quiver:"\ud83d\udd16"};return(0,g.jsx)(d.A,{style:{fontSize:20,color:t},children:r[e]})}return(0,g.jsx)(E.A,{name:ie[e],size:24,color:t})}(0,S.Qq)().webUrl,X.JZ.browse,X.JZ.comparison,X.JZ.quiver,X.JZ.terms,X.JZ.privacy,X.JZ.contact;const le=e=>{let{children:t}=e,r=(0,w.A)(e,$);return(0,g.jsx)(o.Suspense,{fallback:(0,g.jsx)(j.I,{}),children:o.cloneElement(t,r)})},ce=()=>{const e=(0,i.cq)(),{colors:t}=(0,y.D)(),{width:r}=(0,I.A)(),n=r<H.Dy,{foils:s}=(0,G.J)(),{searchQuery:a,setSearchQuery:l,filters:u,setFilters:m,columns:p,setColumns:x,setCurrentScreen:b}=(0,f.n)(),{filterOptions:A}=(0,J.c)(s,u),{showQuiverManager:j}=(0,o.useContext)(ue),v=o.useMemo((()=>s?.length?[...new Set(s.map((e=>e.brand)))].sort():[]),[s]),S=()=>{e.navigate("Browse",{})},w=t=>{l(t),e.setParams({searchQuery:t})},T=e=>"Comparison"===e.name?"comparison":"Quiver"===e.name?"quiver":"browse",O=e=>{switch(e.name){case"Comparison":return"Search foils to add to comparison...";case"Quiver":return"Search foils to add to quiver...";default:return"Search foils..."}},E=t=>{"Browse"===t.name&&e.setParams({showSearchDropdown:!0})},D=(e,t)=>{((e,t)=>{m((r=>Object.assign({},r,{[e]:r[e].includes(t)?r[e].filter((e=>e!==t)):[...r[e],t]})))})(e,t)},M=()=>{m({brands:[],series:[],type:[]})},B=e=>{x((t=>t.map((t=>t.id===e?Object.assign({},t,{isVisible:!t.isVisible}):t))))},q=()=>{x(H._X)},R=o.useMemo((()=>(0,H.lD)(p)),[p]);o.useMemo((()=>(0,H.y6)(R,r,n)),[R,r,n]),o.useMemo((()=>n?"100%":Math.min(R+2*H.Op,r)),[R,r,n]);(0,o.useEffect)((()=>{(async()=>{try{const e=await(0,_.E7)();if(e){const t=H._X.map((t=>Object.assign({},t,{isVisible:"boolean"===typeof e[t.id]?e[t.id]:t.isVisible})));x(t)}}catch(e){}})()}),[]),(0,o.useEffect)((()=>{(async()=>{try{const e=await(0,_.Ir)();e&&m({brands:e.brands||[],series:e.series||[],type:e.types||[]})}catch(e){}})()}),[]);const P=o.useMemo((()=>{if(n)return{width:"100%",paddingHorizontal:H.Op};const e=(0,H.lD)(p);return{width:e,maxWidth:(0,H.y6)(e,r,!1),alignSelf:"center"}}),[p,r,n]),z=e=>(0,g.jsxs)(c.A,{style:de.headerRightContainerWeb,children:[(0,g.jsxs)(h.A,{style:[de.headerButton],onPress:j,children:[(0,g.jsx)(ae,{name:"quiver",color:t.text.primary}),!n&&(0,g.jsx)(d.A,{style:[de.headerButtonText,{color:t.text.primary}],children:"My Quivers"})]}),(0,g.jsx)(Q,{filterOptions:A,selectedBrands:u.brands,selectedSeries:u.series,selectedTypes:u.type,onFilterChange:D,onClearFilters:M,columns:p,onColumnVisibilityChange:B,onResetColumns:q,foils:s})]});return(0,g.jsxs)(se.Navigator,{screenOptions:{headerStyle:{backgroundColor:t.background.primary},headerShadowVisible:!1},children:[(0,g.jsx)(se.Screen,{name:"Browse",options:({route:e})=>({headerTitle:e.params?.title||"",headerLeft:()=>(0,g.jsx)(c.A,{style:[de.headerOuterContainer,{backgroundColor:t.background.primary},!n&&{alignItems:"center"}],children:n?(0,g.jsx)(c.A,{style:de.headerMainContainerMobile,children:(0,g.jsx)(C.A,{onPress:S,style:({pressed:e})=>[de.logoContainer,e&&de.logoPressed],children:(0,g.jsx)(d.A,{style:[de.headerTitle,{color:t.primary}],children:"Foilquiver"})})}):(0,g.jsx)(c.A,{style:[de.headerMainContainerWeb,P],children:(0,g.jsxs)(c.A,{style:[de.headerContentWeb,{width:"100%",alignItems:"center",justifyContent:"space-between"}],children:[(0,g.jsx)(C.A,{onPress:S,style:({pressed:e})=>[de.logoContainer,e&&de.logoPressed],children:(0,g.jsx)(d.A,{style:[de.headerTitle,{color:t.primary}],children:"Foilquiver"})}),(0,g.jsx)(c.A,{style:[de.searchBarContainerWeb,{flex:1}],children:(0,g.jsx)(k,{value:a,onChangeText:e=>w(e),onClear:()=>w(""),mode:T(e),placeholder:O(e),onFocus:()=>E(e)})}),z()]})})})}),children:e=>(0,g.jsx)(le,{children:(0,g.jsx)(K,Object.assign({},e,{filters:u,onFilterChange:D,columns:p,brands:v}))})}),(0,g.jsx)(se.Screen,{name:"Comparison",options:({route:e})=>({headerTitle:e.params?.title||"",headerLeft:()=>(0,g.jsx)(c.A,{style:[de.headerOuterContainer,{backgroundColor:t.background.primary},!n&&{alignItems:"center"}],children:n?(0,g.jsx)(c.A,{style:de.headerMainContainerMobile,children:(0,g.jsx)(C.A,{onPress:S,style:({pressed:e})=>[de.logoContainer,e&&de.logoPressed],children:(0,g.jsx)(d.A,{style:[de.headerTitle,{color:t.primary}],children:"Foilquiver"})})}):(0,g.jsx)(c.A,{style:[de.headerMainContainerWeb,P],children:(0,g.jsxs)(c.A,{style:[de.headerContentWeb,{width:"100%",alignItems:"center",justifyContent:"space-between"}],children:[(0,g.jsx)(C.A,{onPress:S,style:({pressed:e})=>[de.logoContainer,e&&de.logoPressed],children:(0,g.jsx)(d.A,{style:[de.headerTitle,{color:t.primary}],children:"Foilquiver"})}),(0,g.jsx)(c.A,{style:[de.searchBarContainerWeb,{flex:1}],children:(0,g.jsx)(k,{value:a,onChangeText:e=>w(e),onClear:()=>w(""),mode:T(e),placeholder:O(e),onFocus:()=>E(e)})}),z()]})})})}),children:e=>(0,g.jsx)(le,{children:(0,g.jsx)(ee,Object.assign({},e))})}),(0,g.jsx)(se.Screen,{name:"Quiver",options:({route:e})=>({headerTitle:"",headerLeft:()=>(0,g.jsx)(c.A,{style:[de.headerOuterContainer,{backgroundColor:t.background.primary},!n&&{alignItems:"center"}],children:n?(0,g.jsx)(c.A,{style:de.headerMainContainerMobile,children:(0,g.jsx)(C.A,{onPress:S,style:({pressed:e})=>[de.logoContainer,e&&de.logoPressed],children:(0,g.jsx)(d.A,{style:[de.headerTitle,{color:t.primary}],children:"Foilquiver"})})}):(0,g.jsx)(c.A,{style:[de.headerMainContainerWeb,P],children:(0,g.jsxs)(c.A,{style:[de.headerContentWeb,{width:"100%",alignItems:"center",justifyContent:"space-between"}],children:[(0,g.jsx)(C.A,{onPress:S,style:({pressed:e})=>[de.logoContainer,e&&de.logoPressed],children:(0,g.jsx)(d.A,{style:[de.headerTitle,{color:t.primary}],children:"Foilquiver"})}),(0,g.jsx)(c.A,{style:[de.searchBarContainerWeb,{flex:1}],children:(0,g.jsx)(k,{value:a,onChangeText:e=>w(e),onClear:()=>w(""),mode:T(e),placeholder:O(e),onFocus:()=>E(e)})}),z()]})})})}),children:e=>{const t=o.useMemo((()=>e.route.params?.foil_ids&&Array.isArray(s)?s.filter((t=>{if(!t)return!1;const r=(0,Z.h)(t);return e.route.params.foil_ids.includes(r)})):[]),[e.route.params?.foil_ids,s]);return(0,g.jsx)(le,{children:(0,g.jsx)(te,Object.assign({},e,{searchProps:{value:a,onChangeText:w,onClear:()=>l(""),mode:"quiver",placeholder:"Search foils in quiver..."},tableSettingsProps:{filterOptions:A,selectedBrands:u.brands,selectedSeries:u.series,selectedTypes:u.type,onFilterChange:D,onClearFilters:M,columns:p,onColumnVisibilityChange:B,onResetColumns:q,foils:t}}))})}}),(0,g.jsx)(se.Screen,{name:"Terms",options:{headerShown:!1},children:e=>(0,g.jsx)(le,{children:(0,g.jsx)(ne,Object.assign({},e))})}),(0,g.jsx)(se.Screen,{name:"Privacy",options:{headerShown:!1},children:e=>(0,g.jsx)(le,{children:(0,g.jsx)(re,Object.assign({},e))})}),(0,g.jsx)(se.Screen,{name:"Contact",options:{headerShown:!1},children:e=>(0,g.jsx)(le,{children:(0,g.jsx)(oe,Object.assign({},e))})})]})},de=u.A.create({headerOuterContainer:{flex:1,paddingHorizontal:H.Op},headerMainContainerMobile:{flexDirection:"row",alignItems:"center",height:56,width:"100%"},headerRightContainerMobile:{flexDirection:"row",alignItems:"center",gap:8,paddingRight:12,zIndex:2e3},searchBarContainerMobile:{width:160,height:36},headerMainContainerWeb:{height:72,width:"100%"},headerContentWeb:{flexDirection:"row",alignItems:"center",gap:24,height:"100%",width:"100%"},searchBarContainerWeb:{flex:1,height:40},logoContainer:{height:"100%",justifyContent:"center",minWidth:120},logoPressed:{opacity:.7},headerTitle:{fontSize:24,fontWeight:"bold"},headerRightContainerWeb:{flexDirection:"row",alignItems:"center",gap:16,paddingRight:H.Op,zIndex:2e3},headerButton:Object.assign({flexDirection:"row",alignItems:"center",gap:8,padding:8,borderRadius:8},"web"===m.A.OS&&{cursor:"pointer",userSelect:"none"}),headerButtonText:{fontSize:14,fontWeight:"500"}}),ue=o.createContext({showQuiverManager:()=>{},hideQuiverManager:()=>{}});(0,n.A)((function(){const e=(0,i.bE)(),[t,r]=(0,o.useState)(!1),n=()=>r(!1),d={prefixes:(0,S.vA)(),config:{screens:{Browse:{path:"/",parse:{mode:e=>e},stringify:{mode:e=>e}},Comparison:{path:"/comparison",exact:!0,stringify:{quiverName:e=>e,foils:e=>JSON.stringify(e)}},Quiver:{path:"/quiver/:quiverId",parse:{quiverId:e=>e,quiverName:e=>e,foils:e=>e?JSON.parse(e):void 0},stringify:{quiverId:e=>e,quiverName:e=>e,foils:e=>JSON.stringify(e)}},Terms:"/terms",Privacy:"/privacy",Contact:"/contact"}},getStateFromPath:(e,t)=>"/comparison"===e?{routes:[{name:"Comparison",params:{}}]}:(0,i.Bd)(e,t),getPathFromState:(e,t)=>{if("Comparison"===e.routes[e.routes.length-1].name)return"/comparison";return(0,i.Fy)(e,t)||"/"}};return(0,g.jsx)(y.N,{children:(0,g.jsx)(f.D,{children:(0,g.jsx)(ue.Provider,{value:{showQuiverManager:()=>r(!0),hideQuiverManager:n},children:(0,g.jsx)(a.vd,{children:(0,g.jsx)(x,{children:(0,g.jsx)(l.Oy,{children:(0,g.jsx)(s.A,{ref:e,linking:d,fallback:(0,g.jsx)(j.I,{}),children:(0,g.jsxs)(c.A,{style:{flex:1},children:[(0,g.jsx)(ce,{}),t&&(0,g.jsx)(v.G,{standalone:!1,isModalVisible:t,onClose:n,initialTab:"saved"})]})})})})})})})})}))},7821:(e,t,r)=>{r.d(t,{I:()=>d});r(6665);var n=r(3929),o=r(6283),s=r(530),i=r(3668),a=r(4667),l=r(2348),c=r(397);const d=({message:e="Loading...",size:t="large",fullScreen:r=!0})=>{const{colors:i}=(0,a.D)();return(0,c.jsxs)(n.A,{style:[u.container,r&&u.fullScreen,{backgroundColor:i.background.primary}],children:[(0,c.jsx)(s.A,{size:t,color:i.primary}),e&&(0,c.jsx)(o.A,{style:[u.message,{color:i.text.secondary}],children:e})]})},u=i.A.create({container:{padding:l.Y.LARGE,alignItems:"center",justifyContent:"center"},fullScreen:{flex:1},message:{marginTop:l.Y.MEDIUM,fontSize:16,textAlign:"center"}})},6447:(e,t,r)=>{r.d(t,{G:()=>S});var n=r(6665),o=r(3929),s=r(6283),i=r(3668),a=r(5648),l=r(8264),c=r(6773),d=r(4307),u=r(1690),h=r(5991),m=r(558),y=r(1385),p=r(2167),g=r(4812),x=r(4667),b=r(2763),A=r(2348),f=r(5025),j=r(5663),v=r(397);const S=({selectedFoils:e=[],onClose:t,initialTab:r="save",standalone:i=!1,isModalVisible:A,hideStandaloneButton:S=!1,onQuiverSaved:C})=>{const{colors:I}=(0,x.D)(),{width:T}=(0,m.A)(),O=T<b.Dy,E=(0,p.cq)(),{setSelectedFoils:k}=(0,j.n)(),[D,M]=(0,n.useState)(!i),B=void 0!==A?A:D,[q,R]=(0,n.useState)(""),[P,_]=(0,n.useState)(""),[z,N]=(0,n.useState)(!1),[F,L]=(0,n.useState)(r),[W,V]=(0,n.useState)(null),[U,Q]=(0,n.useState)(""),{quivers:Y,isLoading:G,error:J,createQuiver:H,deleteQuiver:X,reloadQuivers:Z,updateQuiver:$}=(0,g.X)(),K=async()=>{if(W&&U.trim())try{await $(W,{name:U.trim()})&&((0,f.k4)(f.R2.UPDATE_QUIVER,{quiverId:W,action:"rename"}),"web"===h.A.OS?window.alert("Quiver renamed successfully"):u.A.alert("Success","Quiver renamed successfully"),V(null),Q(""),Z())}catch(J){u.A.alert("Error","Failed to rename quiver")}},ee=e=>e.foil_ids&&Array.isArray(e.foil_ids)?e.foil_ids.length:0,te=(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(o.A,{style:[w.modalHeader,{borderBottomColor:I.border}],children:[(0,v.jsx)(s.A,{style:[w.modalTitle,{color:I.text.primary}],children:"Manage Quivers"}),t&&(0,v.jsx)(a.A,{onPress:t,children:"web"===h.A.OS?(0,v.jsx)(s.A,{style:{fontSize:24,color:I.text.primary},children:"\xd7"}):(0,v.jsx)(y.A,{name:"close",size:24,color:I.text.primary})})]}),e.length>0&&(0,v.jsxs)(o.A,{style:[w.tabContainer,{borderBottomColor:I.border}],children:[(0,v.jsx)(a.A,{style:[w.tab,"save"===F&&[w.activeTab,{borderBottomColor:I.primary}]],onPress:()=>L("save"),children:(0,v.jsx)(s.A,{style:[w.tabText,{color:"save"===F?I.primary:I.text.secondary}],children:"Save Quiver"})}),(0,v.jsx)(a.A,{style:[w.tab,"saved"===F&&[w.activeTab,{borderBottomColor:I.primary}]],onPress:()=>L("saved"),children:(0,v.jsx)(s.A,{style:[w.tabText,{color:"saved"===F?I.primary:I.text.secondary}],children:"Saved Quivers"})})]}),(0,v.jsx)(d.A,{style:w.modalBody,children:"save"===F&&e.length>0?(0,v.jsxs)(o.A,{style:w.form,children:[(0,v.jsxs)(o.A,{style:w.formField,children:[(0,v.jsx)(s.A,{style:[w.label,{color:I.text.secondary}],children:"Name"}),(0,v.jsx)(c.A,{style:[w.input,{color:I.text.primary,borderColor:I.border,backgroundColor:I.background.secondary}],value:q,onChangeText:R,placeholder:"Enter quiver name",placeholderTextColor:I.text.tertiary})]}),(0,v.jsxs)(o.A,{style:w.formField,children:[(0,v.jsx)(s.A,{style:[w.label,{color:I.text.secondary}],children:"Description (optional)"}),(0,v.jsx)(c.A,{style:[w.input,w.textArea,{color:I.text.primary,borderColor:I.border,backgroundColor:I.background.secondary}],value:P,onChangeText:_,placeholder:"Enter description",placeholderTextColor:I.text.tertiary,multiline:!0,numberOfLines:3})]}),(0,v.jsxs)(a.A,{style:w.publicToggle,onPress:()=>N(!z),children:["web"===h.A.OS?(0,v.jsx)(s.A,{style:{fontSize:24,color:z?I.primary:I.text.secondary,marginRight:8},children:z?"\u2611":"\u2610"}):(0,v.jsx)(y.A,{name:z?"checkbox":"square-outline",size:24,color:z?I.primary:I.text.secondary}),(0,v.jsx)(s.A,{style:[w.publicToggleText,{color:I.text.primary}],children:"Make this quiver public"})]}),(0,v.jsx)(a.A,{style:[w.createButton,{backgroundColor:I.primary}],onPress:async()=>{if(q.trim())try{const r=await H({name:q.trim(),description:P.trim(),foils:e,is_public:z});if(!r)throw new Error("Failed to create quiver - no result returned");(0,f.k4)(f.R2.SAVE_QUIVER,{foilCount:e.length,isPublic:z}),"web"===h.A.OS?window.alert("Quiver saved successfully"):u.A.alert("Success","Quiver saved successfully"),R(""),_(""),N(!1),M(!1),t?.(),C?.(r.id,r.name)}catch(J){"web"===h.A.OS?window.alert(`Failed to save quiver: ${J instanceof Error?J.message:"Unknown error"}`):u.A.alert("Error",`Failed to save quiver: ${J instanceof Error?J.message:"Unknown error"}`)}else"web"===h.A.OS?window.alert("Please enter a name for your quiver"):u.A.alert("Error","Please enter a name for your quiver")},children:(0,v.jsx)(s.A,{style:[w.buttonText,{color:I.text.inverse}],children:"Save Quiver"})})]}):(0,v.jsx)(o.A,{style:w.quiverList,children:G?(0,v.jsx)(o.A,{style:w.centerContent,children:(0,v.jsx)(s.A,{style:[w.message,{color:I.text.secondary}],children:"Loading quivers..."})}):J?(0,v.jsx)(o.A,{style:w.centerContent,children:(0,v.jsx)(s.A,{style:[w.message,{color:I.error}],children:J})}):0===Y.length?(0,v.jsx)(o.A,{style:w.centerContent,children:(0,v.jsx)(s.A,{style:[w.message,{color:I.text.secondary}],children:"No saved quivers yet"})}):Y.map((e=>(0,v.jsxs)(o.A,{style:[w.quiverItem,{borderBottomColor:I.border}],children:[(0,v.jsx)(a.A,{style:w.quiverInfo,onPress:()=>(e=>{M(!1),t?.(),k([]),E.navigate("Quiver",{quiverId:e.id,quiverName:e.name,foil_ids:e.foil_ids||[]})})(e),children:W===e.id?(0,v.jsxs)(o.A,{style:w.renameContainer,children:[(0,v.jsx)(c.A,{style:[w.renameInput,{color:I.text.primary,borderColor:I.border,backgroundColor:I.background.secondary}],value:U,onChangeText:Q,placeholder:"Enter new name",placeholderTextColor:I.text.tertiary,autoFocus:!0}),(0,v.jsx)(a.A,{style:[w.renameButton,{backgroundColor:I.error}],onPress:()=>{V(null),Q("")},children:(0,v.jsx)(s.A,{style:[w.renameButtonText,{color:I.text.inverse}],children:"Cancel"})}),(0,v.jsx)(a.A,{style:[w.renameButton,{backgroundColor:I.primary}],onPress:K,children:(0,v.jsx)(s.A,{style:[w.renameButtonText,{color:I.text.inverse}],children:"Save"})})]}):(0,v.jsxs)(v.Fragment,{children:[(0,v.jsxs)(o.A,{style:w.quiverNameContainer,children:[(0,v.jsx)(s.A,{style:[w.quiverName,{color:I.text.primary}],children:e.name}),(0,v.jsx)(a.A,{onPress:()=>(e=>{V(e.id),Q(e.name)})(e),style:w.renameIcon,children:"web"===h.A.OS?(0,v.jsx)(s.A,{style:{color:I.text.secondary},children:"\u270e"}):(0,v.jsx)(y.A,{name:"pencil",size:16,color:I.text.secondary})})]}),e.description&&(0,v.jsx)(s.A,{style:[w.quiverDescription,{color:I.text.secondary}],children:e.description}),(0,v.jsxs)(s.A,{style:[w.quiverMeta,{color:I.text.tertiary}],children:[ee(e)," foils \u2022 ",new Date(e.updated_at).toLocaleDateString(),e.is_public&&" \u2022 Public"]})]})}),"web"===h.A.OS?(0,v.jsx)("button",{type:"button",onClick:()=>{try{window.confirm("Are you sure you want to delete this quiver? This action cannot be undone.")&&X(e.id).then((e=>{e?Z():window.alert("Failed to delete quiver")})).catch((e=>{window.alert("Error deleting quiver")}))}catch(J){window.alert("Error in delete operation")}},style:{padding:"8px",borderWidth:"1px",borderStyle:"solid",borderColor:I.error,borderRadius:"8px",minWidth:"70px",backgroundColor:I.background.primary,cursor:"pointer",color:I.error,fontWeight:"600",fontSize:"14px",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10,position:"relative",pointerEvents:"auto"},children:"Delete"}):(0,v.jsx)(a.A,{style:[w.deleteButton,{borderColor:I.error,backgroundColor:I.background.primary}],onPress:()=>{(async e=>{try{if(!await new Promise((e=>{u.A.alert("Delete Quiver","Are you sure you want to delete this quiver? This action cannot be undone.",[{text:"Cancel",style:"cancel",onPress:()=>e(!1)},{text:"Delete",style:"destructive",onPress:()=>e(!0)}],{cancelable:!1})})))return;await X(e)?((0,f.k4)(f.R2.DELETE_QUIVER,{quiverId:e}),u.A.alert("Success","Quiver deleted successfully")):u.A.alert("Error","Failed to delete quiver. Please try again.")}catch(J){u.A.alert("Error","An unexpected error occurred. Please try again.")}})(e.id)},children:(0,v.jsx)(y.A,{name:"trash-outline",size:20,color:I.error})})]},e.id)))})})]});return i?te:(0,v.jsxs)(v.Fragment,{children:[e.length>0&&!i&&!A&&!S&&(0,v.jsxs)(a.A,{style:[w.saveButton,{backgroundColor:I.primary}],onPress:()=>M(!0),children:["web"===h.A.OS?(0,v.jsx)(s.A,{style:{fontSize:20,color:I.text.inverse,marginRight:8},children:"+"}):(0,v.jsx)(y.A,{name:"bookmark-outline",size:20,color:I.text.inverse}),(0,v.jsx)(s.A,{style:[w.buttonText,{color:I.text.inverse}],children:"Save Quiver"})]}),(0,v.jsx)(l.A,{visible:B,transparent:!0,animationType:"fade",onRequestClose:()=>{M(!1),t?.()},children:(0,v.jsx)(a.A,{style:[w.modalOverlay,i&&w.standaloneOverlay],activeOpacity:1,onPress:()=>{M(!1),t?.()},children:(0,v.jsx)(a.A,{style:[w.modalContent,{backgroundColor:I.background.primary},O&&w.modalContentMobile],activeOpacity:1,onPress:e=>{e.preventDefault(),e.stopPropagation()},children:te})})})]})},w=i.A.create({saveButton:Object.assign({flexDirection:"row",alignItems:"center",justifyContent:"center",paddingHorizontal:A.Y.LARGE,paddingVertical:A.Y.MEDIUM,borderRadius:8,gap:8,minHeight:40,minWidth:120},"web"===h.A.OS&&{cursor:"pointer",pointerEvents:"auto",userSelect:"none",boxShadow:"0px 2px 4px rgba(0,0,0,0.1)"}),buttonText:Object.assign({fontSize:14,fontWeight:"600",textAlign:"center"},"web"===h.A.OS&&{userSelect:"none"}),modalOverlay:Object.assign({position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",padding:b.Op,zIndex:2e3},"web"===h.A.OS&&{position:"absolute",pointerEvents:"auto"}),modalContent:Object.assign({width:"100%",maxWidth:600,borderRadius:12,maxHeight:"90%",zIndex:2001},"web"===h.A.OS&&{pointerEvents:"auto",userSelect:"none"}),modalContentMobile:{maxWidth:"100%"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:A.Y.LARGE,borderBottomWidth:1},modalTitle:{fontSize:20,fontWeight:"600"},modalBody:{flex:1},tabContainer:{flexDirection:"row",borderBottomWidth:1},tab:{flex:1,paddingVertical:A.Y.MEDIUM,alignItems:"center"},activeTab:{borderBottomWidth:2},tabText:{fontSize:16,fontWeight:"500"},form:{padding:A.Y.LARGE},formField:{marginBottom:A.Y.LARGE},label:{fontSize:14,marginBottom:A.Y.SMALL},input:Object.assign({height:40,borderWidth:1,borderRadius:8,paddingHorizontal:A.Y.MEDIUM,fontSize:16},"web"===h.A.OS&&{outlineStyle:"none"}),textArea:{height:80,paddingTop:A.Y.MEDIUM,textAlignVertical:"top"},publicToggle:{flexDirection:"row",alignItems:"center",gap:A.Y.SMALL,marginBottom:A.Y.LARGE},publicToggleText:{fontSize:16},createButton:{paddingVertical:A.Y.MEDIUM,borderRadius:8,alignItems:"center"},quiverList:{padding:A.Y.LARGE},quiverItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:A.Y.MEDIUM,borderBottomWidth:1},quiverInfo:Object.assign({flex:1,marginRight:A.Y.MEDIUM},"web"===h.A.OS&&{cursor:"pointer"}),quiverName:{fontSize:16,fontWeight:"600",marginBottom:4},quiverDescription:{fontSize:14,marginBottom:4},quiverMeta:{fontSize:12},deleteButton:Object.assign({padding:A.Y.SMALL,borderWidth:1,borderRadius:8,minWidth:"web"===h.A.OS?70:40,alignItems:"center",justifyContent:"center",zIndex:10},"web"===h.A.OS&&{cursor:"pointer",pointerEvents:"auto",userSelect:"none",position:"relative"}),deleteIcon:{fontSize:14,fontWeight:"600"},centerContent:{padding:A.Y.LARGE,alignItems:"center"},message:{fontSize:16},standaloneOverlay:{position:"relative",backgroundColor:"transparent"},renameContainer:{flexDirection:"row",alignItems:"center",gap:A.Y.SMALL},renameInput:{flex:1,height:32,borderWidth:1,borderRadius:4,paddingHorizontal:A.Y.SMALL,fontSize:14},renameButton:{paddingHorizontal:A.Y.MEDIUM,paddingVertical:A.Y.SMALL,borderRadius:4},renameButtonText:{fontSize:12,fontWeight:"500"},quiverNameContainer:{flexDirection:"row",alignItems:"center",gap:A.Y.SMALL},renameIcon:Object.assign({padding:A.Y.SMALL},"web"===h.A.OS&&{cursor:"pointer"})})},3295:(e,t,r)=>{r.d(t,{Qq:()=>i,vA:()=>a});var n=r(5991);const o={NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"FoilQuiver",slug:"FoilQuiver",version:"1.0.0",orientation:"portrait",icon:"./assets/icon.png",userInterfaceStyle:"light",splash:{image:"./assets/splash-icon.png",resizeMode:"contain",backgroundColor:"#ffffff"},web:{},extra:{production:{baseUrl:"https://foilquiver.com"},staging:{baseUrl:"https://staging.foilquiver.com"}},sdkVersion:"52.0.0",platforms:["ios","android","web"]},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.EXPO_PUBLIC_ENV||"development",s={development:{apiUrl:"http://localhost:3000",webUrl:"http://localhost:19006",appScheme:"foilquiver-dev"},staging:{apiUrl:"https://api.staging.foilquiver.com",webUrl:"https://staging.foilquiver.com",appScheme:"foilquiver-staging"},production:{apiUrl:"https://api.foilquiver.com",webUrl:"https://foilquiver.com",appScheme:"foilquiver"}},i=()=>s[o],a=()=>{const e=i();return"web"===n.A.OS?[e.webUrl]:[`${e.appScheme}://`]}},2763:(e,t,r)=>{r.d(t,{Dy:()=>o,Op:()=>n,_X:()=>i,lD:()=>a,lU:()=>s,y6:()=>l});const n=16,o=768,s={brand:100,series:120,model:150,area:80,wingspan:80,aspectRatio:80,type:80,price:105,link:80},i=[{id:"brand",label:"Brand",isVisible:!0},{id:"series",label:"Series",isVisible:!1},{id:"model",label:"Model",isVisible:!0},{id:"area",label:"Area",isVisible:!0},{id:"wingspan",label:"Span",isVisible:!0},{id:"aspectRatio",label:"AR",isVisible:!0},{id:"type",label:"Type",isVisible:!0},{id:"price",label:"Price",isVisible:!0},{id:"link",label:"Link",isVisible:!0}],a=e=>e.reduce(((e,t)=>t.isVisible?e+(s[t.id]||100):e),0),l=(e,t,r)=>r?t:Math.min(e,t-48)},5663:(e,t,r)=>{r.d(t,{D:()=>l,n:()=>c});var n=r(6665),o=r(3600),s=r(2763),i=r(397);const a=(0,n.createContext)(void 0),l=({children:e})=>{const[t,r]=(0,n.useState)(""),[l,c]=(0,n.useState)({brands:[],series:[],type:[]}),[d,u]=(0,n.useState)(s._X),[h,m]=(0,n.useState)([]),[y,p]=(0,n.useState)(null);(0,n.useEffect)((()=>{(async()=>{try{const e=await(0,o.Ir)();e&&c({brands:e.brands||[],series:e.series||[],type:e.types||[]});const t=await(0,o.E7)();t&&Array.isArray(t)&&u(t.map((e=>Object.assign({},s._X.find((t=>t.id===e.id)),e))))}catch(e){}})()}),[]),(0,n.useEffect)((()=>{(0,o.ri)({brands:l.brands,series:l.series,types:l.type})}),[l]),(0,n.useEffect)((()=>{y&&c({brands:[],series:[],type:[]})}),[y]);const g={searchQuery:t,setSearchQuery:r,filters:l,setFilters:c,columns:d,setColumns:u,selectedFoils:h,setSelectedFoils:m,currentScreen:y,setCurrentScreen:p};return(0,i.jsx)(a.Provider,{value:g,children:e})},c=()=>{const e=(0,n.useContext)(a);if(void 0===e)throw new Error("useApp must be used within an AppProvider");return e}},2419:(e,t,r)=>{r.d(t,{c:()=>o});var n=r(6665);function o(e,t){const r=(0,n.useMemo)((()=>{const r=Array.from(new Set(e.map((e=>e.brand)))).sort(),n=function(e){return e.reduce(((e,t)=>(e[t.brand]||(e[t.brand]=[]),e[t.brand].push(t),e)),{})}(e);let o=[];if(0===t.brands.length)o=Array.from(new Set(e.map((e=>e.series)))).sort();else{const e=t.brands.flatMap((e=>n[e]||[]));o=Array.from(new Set(e.map((e=>e.series)))).sort()}return{brands:r,series:o,types:["front","tail"]}}),[e,t.brands]);return{filteredFoils:(0,n.useMemo)((()=>e.filter((e=>{const r=0===t.brands.length||t.brands.includes(e.brand),n=0===t.series.length||t.series.includes(e.series),o=0===t.type.length||t.type.includes(e.type);return r&&n&&o}))),[e,t.brands,t.series,t.type]),filterOptions:r}}},209:(e,t,r)=>{r.d(t,{J:()=>a});var n=r(6665),o=r(5991),s=r(1087);class i{static isWeb="web"===o.A.OS;static DATA_PATH="/data/foils.json";static CACHE_DIR=".cache";static getBaseUrl(){return"https://foilquiver.com"}static async getAllProducts(){try{if(this.isWeb){const t=this.getBaseUrl();try{const e=await fetch(`${t}${this.DATA_PATH}`);if(e.ok){return await e.json()}}catch(e){}try{const r=["armstrong","lift-foils","axis-foils","code-foils","kt-foils","uni-foil"],n=[];for(const o of r)try{const e=await fetch(`${t}/${this.CACHE_DIR}/${o}.json`);if(e.ok){const t=await e.json();n.push(...t)}}catch(e){}if(n.length>0)return n}catch(e){}}else{const e=await s.A.getItem("foils");if(e){return JSON.parse(e)}}}catch(e){}return[]}}function a(){const[e,t]=(0,n.useState)([]),[r,o]=(0,n.useState)(!0),[s,a]=(0,n.useState)(null),l=async()=>{try{o(!0),a(null);const e=await i.getAllProducts();t(e)}catch(e){a(e instanceof Error?e.message:"Failed to load foils")}finally{o(!1)}};(0,n.useEffect)((()=>{l()}),[]);return{foils:e,loading:r,error:s,refreshFoils:()=>{l()}}}},4812:(e,t,r)=>{r.d(t,{X:()=>p});var n=r(6665),o=r(1087),s=r(5991),i=r(5701),a=r(382),l=r(5501);const c="@foilquiver/quivers",d=()=>window.location.hostname.includes("staging")?"staging":"prod",u=()=>`${d()}_quivers`,h=async e=>"web"===s.A.OS?localStorage.getItem(e):o.A.getItem(e),m=async(e,t)=>{if("web"!==s.A.OS)return o.A.setItem(e,t);localStorage.setItem(e,t)},y=async e=>{if("web"!==s.A.OS)return o.A.removeItem(e);localStorage.removeItem(e)},p=()=>{const[e,t]=(0,n.useState)([]),[r,o]=(0,n.useState)(!0),[s,p]=(0,n.useState)(null),g=async()=>{try{o(!0),p(null);const{data:{session:e}}=await i.N.auth.getSession();if(e?.user){const{data:r,error:n}=await i.N.from(u()).select("*").eq("environment",d()).eq("user_id",e.user.id).order("updated_at",{ascending:!1});if(n)throw n;t(r||[])}else{const e=await h(c);t(e?JSON.parse(e):[])}}catch(e){p(e instanceof Error?e.message:"Failed to load quivers"),t([])}finally{o(!1)}};return(0,n.useEffect)((()=>{g();const{data:{subscription:e}}=i.N.auth.onAuthStateChange((async e=>{"SIGNED_IN"===e&&await(async()=>{try{const{data:{session:e}}=await i.N.auth.getSession();if(!e?.user)return;const t=await h(c);if(!t)return;const r=JSON.parse(t),n=d();for(const o of r){const t=o.foils.map((e=>(0,a.h)(e))),r={name:o.name,description:o.description||"",foil_ids:t,is_public:o.is_public||!1,user_id:e.user.id,environment:n};await i.N.from(u()).insert([r])}await y(c),await g()}catch(e){}})(),await g()}));return()=>{e.unsubscribe()}}),[]),{quivers:e,isLoading:r,error:s,createQuiver:async r=>{try{p(null);const{data:{session:n}}=await i.N.auth.getSession();if(n?.user){const e=u(),o=d(),s=r.foils.map((e=>(0,a.h)(e))),c={name:r.name,description:r.description||"",user_id:n.user.id,environment:o,foil_ids:s,is_public:r.is_public||!1},{error:h}=await i.N.from(e).insert(c);if(h)throw l.v.error("Insert error:",{message:h.message,details:h.details,hint:h.hint,code:h.code}),h;const{data:m,error:y}=await i.N.from(e).select("*").eq("user_id",n.user.id).eq("name",r.name).order("created_at",{ascending:!1}).limit(1).single();if(y)throw y;if(!m)throw new Error("Failed to retrieve created quiver");const p=Object.assign({},m,{foils:r.foils});return t((e=>[p,...e])),p}{const n=d(),o=r.foils.map((e=>(0,a.h)(e))),s={id:crypto.randomUUID(),user_id:"",name:r.name,description:r.description||"",foil_ids:o,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),is_public:r.is_public||!1,environment:n},i=[s,...e];return await m(c,JSON.stringify(i)),t(i),s}}catch(n){throw n}},updateQuiver:async(e,r)=>{p(null);try{const{data:{session:n}}=await i.N.auth.getSession();if(n?.user){const{error:t}=await i.N.from(u()).update(r).eq("id",e);if(t)throw t;return await g(),!0}{const n=await h(c);if(!n)return!1;const o=JSON.parse(n).map((t=>t.id===e?Object.assign({},t,r,{updated_at:(new Date).toISOString()}):t));return await m(c,JSON.stringify(o)),t(o),!0}}catch(s){return p("Failed to update quiver"),!1}},deleteQuiver:async r=>{try{p(null);const{data:{session:n}}=await i.N.auth.getSession();if(n?.user){const{error:e}=await i.N.from(u()).delete().eq("id",r).eq("user_id",n.user.id).eq("environment",d());if(e)throw e}const o=e.filter((e=>e.id!==r));return t(o),n?.user||await m(c,JSON.stringify(o)),!0}catch(n){return p(n instanceof Error?n.message:"Failed to delete quiver"),!1}},reloadQuivers:g}}},4667:(e,t,r)=>{r.d(t,{D:()=>u,N:()=>d});var n=r(6665),o=r(1243),s=r(1087),i=r(5713),a=r(397);const l=(0,n.createContext)(void 0),c="@foilquiver/theme",d=({children:e})=>{const t=(0,o.A)(),[r,d]=(0,n.useState)("dark"===t);(0,n.useEffect)((()=>{(async()=>{try{const e=await s.A.getItem(c);null!==e&&d("dark"===e)}catch(e){}})()}),[]);const u=(0,i.j)(r?"dark":"light");return(0,a.jsx)(l.Provider,{value:{isDark:r,colors:u,toggleTheme:async()=>{try{const e=!r;d(e),await s.A.setItem(c,e?"dark":"light")}catch(e){}}},children:e})},u=()=>{const e=(0,n.useContext)(l);if(void 0===e)throw new Error("useTheme must be used within a ThemeProvider");return e}},5713:(e,t,r)=>{r.d(t,{T:()=>h,j:()=>u});const n="#BF3475",o="#FFCE61",s="#F9FAFB",i="#E5E7EB",a="#374151",l="#111827",c={background:{primary:s,secondary:"#F3F4F6",tertiary:i},text:{primary:l,secondary:a,tertiary:"#6B7280",inverse:s},border:i,primary:n,error:"#DC2626",success:"#059669",warning:o},d={background:{primary:l,secondary:"#1F2937",tertiary:a},text:{primary:s,secondary:i,tertiary:"#9CA3AF",inverse:l},border:a,primary:n,error:"#EF4444",success:"#10B981",warning:o},u=e=>"dark"===e?d:c,h=c},2348:(e,t,r)=>{r.d(t,{Y:()=>n});const n={XSMALL:4,SMALL:8,MEDIUM:12,LARGE:16,XLARGE:24,XXLARGE:32,CONTAINER_PADDING:24,BUTTON_PADDING_H:16,BUTTON_PADDING_V:8,BUTTON_GAP:12,CONTROLS_BOTTOM:24,SCREEN_PADDING:24,TABLE_CONTAINER_PADDING:24,HEADER_PADDING:12,CONTENT_PADDING:16,CONTROLS_CONTAINER_BOTTOM:24,CONTROLS_CONTAINER_PADDING:24}},5025:(e,t,r)=>{r.d(t,{R2:()=>a,k4:()=>i,oe:()=>s});var n=r(5991);const o=e=>{"web"===n.A.OS&&window.plausible&&window.plausible(e.name,e.props?{props:e.props}:void 0)},s=(e,t)=>{o({name:"pageview",props:Object.assign({page:e},t)})},i=(e,t)=>{o({name:e,props:t})},a={VIEW_COMPARISON:"view_comparison",VIEW_QUIVER:"view_quiver",COMPARE_FOILS:"compare_foils",SAVE_QUIVER:"save_quiver",DELETE_QUIVER:"delete_quiver",UPDATE_QUIVER:"update_quiver",FILTER_FOILS:"filter_foils",SORT_FOILS:"sort_foils",SEARCH_FOILS:"search_foils"}},382:(e,t,r)=>{r.d(t,{h:()=>n});const n=e=>`${e.brand.toLowerCase()}-${e.model.toLowerCase().replace(/\s+/g,"-")}`},5501:(e,t,r)=>{r.d(t,{v:()=>o});class n{isDevelopment=!1;constructor(){this.isDevelopment}static getInstance(){return n.instance||(n.instance=new n),n.instance}log(e,t,...r){if(this.isDevelopment||"error"===e){(new Date).toISOString(),e.toUpperCase();e}}debug(e,...t){this.log("debug",e,...t)}info(e,...t){this.log("info",e,...t)}warn(e,...t){this.log("warn",e,...t)}error(e,...t){this.log("error",e,...t)}}const o=n.getInstance()},9659:(e,t,r)=>{r.d(t,{JZ:()=>n});const n={browse:"/",comparison:"/comparison",quiver:"/quiver/:quiverId",terms:"/terms",privacy:"/privacy",contact:"/contact"}},3600:(e,t,r)=>{r.d(t,{E7:()=>c,Ir:()=>a,QZ:()=>u,pC:()=>d,pF:()=>l,ri:()=>i});var n=r(1087),o=r(5501);const s={FILTERS:"@foilquiver/filters",COLUMNS:"@foilquiver/columns",THEME:"@foilquiver/theme",SORT:"@foilquiver/sort"};new class{async set(e,t){try{const r=JSON.stringify(t);await n.A.setItem(e,r)}catch(r){throw o.v.error("Error setting storage item:",r),r}}async get(e){try{const t=await n.A.getItem(e);return null!=t?JSON.parse(t):null}catch(t){throw o.v.error("Error getting storage item:",t),t}}async remove(e){try{await n.A.removeItem(e)}catch(t){throw o.v.error("Error removing storage item:",t),t}}async clear(){try{await n.A.clear()}catch(e){throw o.v.error("Error clearing storage:",e),e}}async getAllKeys(){try{return await n.A.getAllKeys()}catch(e){throw o.v.error("Error getting all storage keys:",e),e}}};const i=async e=>{try{await n.A.setItem(s.FILTERS,JSON.stringify(e))}catch(t){}},a=async()=>{try{const e=await n.A.getItem(s.FILTERS);return e?JSON.parse(e):null}catch(e){return null}},l=async e=>{try{await n.A.setItem(s.COLUMNS,JSON.stringify(e))}catch(t){}},c=async()=>{try{const e=await n.A.getItem(s.COLUMNS);return e?JSON.parse(e):null}catch(e){return null}},d=async e=>{try{await n.A.setItem(s.SORT,JSON.stringify(e))}catch(t){}},u=async()=>{try{const e=await n.A.getItem(s.SORT);return e?JSON.parse(e):null}catch(e){return null}}},5701:(e,t,r)=>{r.d(t,{N:()=>s});var n=r(8418),o=r(5991);const s=(0,n.UU)("https://zhylhvuhhoialsgqrxxr.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpoeWxodnVoaG9pYWxzZ3FyeHhyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzkxNjM3NTgsImV4cCI6MjA1NDczOTc1OH0.wrZ05wA3EcbBubG3Mrxmx--fA9ThE2_M9k9WYTmGpag",{auth:{detectSessionInUrl:"web"===o.A.OS,flowType:"pkce",autoRefreshToken:!0,persistSession:!0}})}},e=>{e.O(0,[925],(()=>{return t=640,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=main.18688c9b.js.map