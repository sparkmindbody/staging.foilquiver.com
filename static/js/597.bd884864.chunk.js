(self.webpackChunkweb=self.webpackChunkweb||[]).push([[597],{9058:(e,r,t)=>{t.d(r,{A:()=>s});var n=t(296),i=t(6665),o=t(5458);function s(e){var r=(0,i.useState)({field:"area",direction:"asc"}),t=(0,n.A)(r,2),s=t[0],a=t[1],l=(0,i.useMemo)((function(){return r=e,t=s.field,n=s.direction,(0,o.A)(r).sort((function(e,r){var i,o;"brand"===t||"series"===t||"model"===t?(i=e[t].toLowerCase(),o=r[t].toLowerCase()):"price"===t?(i=e.price||0,o=r.price||0):(i=e.specs[t],o=r.specs[t]);var s="asc"===n?1:-1;return"string"===typeof i?i.localeCompare(o)*s:(i-o)*s}));var r,t,n}),[e,s]);return{sortOption:s,setSortOption:a,sortedFoils:l}}},597:(e,r,t)=>{t.r(r),t.d(r,{default:()=>F});var n=t(4467),i=t(296),o=t(6665),s=t(3929),a=t(3668),l=t(467),c=t(5458),u=t(3029),f=t(2901),d=t(5991),p=t(1087),y=(0,f.A)((function e(){(0,u.A)(this,e)}),null,[{key:"getBaseUrl",value:function(){return"https://foilquiver.com"}},{key:"getAllProducts",value:function(){var e=(0,l.A)((function*(){try{if(this.isWeb){var e=this.getBaseUrl();try{var r=yield fetch(`${e}${this.DATA_PATH}`);if(r.ok)return yield r.json()}catch(a){}try{var t=[];for(var n of["armstrong","lift-foils","axis-foils","code-foils","kt-foils","uni-foil"])try{var i=yield fetch(`${e}/${this.CACHE_DIR}/${n}.json`);if(i.ok){var o=yield i.json();t.push.apply(t,(0,c.A)(o))}}catch(a){}if(t.length>0)return t}catch(a){}}else{var s=yield p.A.getItem("foils");if(s)return JSON.parse(s)}}catch(a){}return[]}));return function(){return e.apply(this,arguments)}}()}]);y.isWeb="web"===d.A.OS,y.DATA_PATH="/data/foils.json",y.CACHE_DIR=".cache";var h=t(9058),b=t(3579),m=t(6239),v=t(6297),g=t(9353),S=t(397);function A(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function j(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?A(Object(t),!0).forEach((function(r){(0,n.A)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):A(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var w=(0,o.lazy)((function(){return Promise.all([t.e(122),t.e(96),t.e(236)]).then(t.bind(t,2933)).then((function(e){return{default:e.default}}))})),O=(0,o.lazy)((function(){return Promise.all([t.e(122),t.e(988)]).then(t.bind(t,3391)).then((function(e){return{default:e.default}}))})),x=(0,o.lazy)((function(){return Promise.all([t.e(122),t.e(96),t.e(855)]).then(t.bind(t,6030)).then((function(e){return{default:e.default}}))})),C=(0,o.lazy)((function(){return t.e(122).then(t.bind(t,2547)).then((function(e){return{default:e.default}}))}));function F(e){var r,t=e.route,a=e.navigation,u=function(){var e=(0,o.useState)([]),r=(0,i.A)(e,2),t=r[0],n=r[1],s=(0,o.useState)(!0),a=(0,i.A)(s,2),c=a[0],u=a[1],f=(0,o.useState)(null),d=(0,i.A)(f,2),p=d[0],h=d[1],b=function(){var e=(0,l.A)((function*(){try{u(!0),h(null);var e=yield y.getAllProducts();n(e)}catch(r){h(r instanceof Error?r.message:"Failed to load foils")}finally{u(!1)}}));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){b()}),[]),{foils:t,loading:c,error:p,refreshFoils:function(){b()}}}(),f=u.foils,d=u.loading,p=u.error,A=u.refreshFoils,F=(null==(r=t.params)?void 0:r.searchQuery)||"",P=function(e,r){return{searchedFoils:(0,o.useMemo)((function(){if(!r.trim())return e;var t=r.toLowerCase().trim();return e.filter((function(e){return[e.brand,e.model,e.series,e.specs.area.toString(),e.specs.wingspan.toString(),e.specs.aspectRatio.toString()].some((function(e){return e.toLowerCase().includes(t)}))}))}),[e,r])}}(f,F),D=function(e){var r=(0,o.useState)({brands:[],series:[],type:null}),t=(0,i.A)(r,2),n=t[0],s=t[1],a=(0,o.useMemo)((function(){var r=Array.from(new Set(e.map((function(e){return e.brand})))),t=(Array.from(new Set(e.map((function(e){return e.series})))),r.reduce((function(r,t){return r[t]=Array.from(new Set(e.filter((function(e){return e.brand===t})).map((function(e){return e.series})))),r}),{})),i=n.type?e.filter((function(e){return e.type===n.type})):e,o=Array.from(new Set(i.map((function(e){return e.series}))));return{brands:r,series:n.brands.length>0?Array.from(new Set(i.filter((function(e){return n.brands.includes(e.brand)})).map((function(e){return e.series})))):o,types:["front","tail"],brandSeries:t}}),[e,n.brands,n.type]),l=(0,o.useMemo)((function(){return e.filter((function(e){var r=0===n.brands.length||n.brands.includes(e.brand),t=0===n.series.length||n.series.includes(e.series),i=!n.type||e.type===n.type;return r&&t&&i}))}),[e,n]);return{filters:n,setFilters:s,filteredFoils:l,filterOptions:a}}(P.searchedFoils),E=D.filters,I=D.setFilters,$=D.filteredFoils,B=D.filterOptions,H=(0,h.A)($),L=H.sortOption,Q=H.setSortOption,R=H.sortedFoils,T=function(){var e=(0,o.useState)([]),r=(0,i.A)(e,2),t=r[0],n=r[1],s=(0,o.useCallback)((function(e){n((function(r){return r.some((function(r){return r.model===e.model&&r.brand===e.brand}))?r.filter((function(r){return!(r.model===e.model&&r.brand===e.brand)})):[].concat((0,c.A)(r),[e])}))}),[]),a=(0,o.useCallback)((function(e){return t.some((function(r){return r.model===e.model&&r.brand===e.brand}))}),[t]),l=(0,o.useCallback)((function(){n([])}),[]);return{selectedFoils:t,toggleFoilSelection:s,isSelected:a,clearSelection:l}}(),z=T.selectedFoils,M=T.toggleFoilSelection,U=T.isSelected,_=T.clearSelection,q=(0,o.useState)(!1),W=(0,i.A)(q,2),J=W[0],K=W[1];(0,o.useEffect)((function(){var e;(null==(e=t.params)?void 0:e.searchQuery)!==F&&a.setParams({searchQuery:F})}),[F,a]),(0,o.useEffect)((function(){if(F){var e=new URL(window.location.href);e.searchParams.set("searchQuery",F),window.history.replaceState({},"",e.toString())}}),[F]);var N=function(){K(!1),_()};return d?(0,S.jsx)(m.I,{}):p?(0,S.jsx)(v.K,{message:p,onRetry:A}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(g.a,{title:"FoilQuiver - Browse and compare hydrofoils",description:`Compare ${f.length} hydrofoils across ${B.brands.length} brands. Filter by type, brand, and specifications to find your perfect foil.`,canonicalUrl:"https://foilquiver.com/browse"}),(0,S.jsxs)(s.A,{style:k.container,children:[(0,S.jsx)(b.B,{filterOptions:B,selectedBrands:E.brands,selectedSeries:E.series,selectedTypes:E.type?[E.type]:[],onFilterChange:function(e,r){I("type"===e?function(e){return j(j({},e),{},{type:r.length>0?r[0]:null})}:function(t){return j(j({},t),{},(0,n.A)({},e,r))})}}),(0,S.jsx)(s.A,{style:k.tableContainer,children:J?(0,S.jsx)(o.Suspense,{fallback:(0,S.jsx)(m.I,{}),children:(0,S.jsx)(x,{foils:z,onClose:N,onCompare:function(){}})}):(0,S.jsx)(o.Suspense,{fallback:(0,S.jsx)(m.I,{}),children:(0,S.jsx)(w,{foils:R,onSort:function(e){Q((function(r){return{field:e,direction:r.field===e&&"asc"===r.direction?"desc":"asc"}}))},onFoilSelect:M,isSelected:U,sortOption:L})})}),(0,S.jsx)(o.Suspense,{fallback:(0,S.jsx)(m.I,{}),children:(0,S.jsx)(O,{selectedFoils:z,onCompareSelected:function(){z.length>=2&&K(!0)},onExitCompare:N,onClearSelection:_,isComparisonView:J})}),(0,S.jsx)(o.Suspense,{fallback:(0,S.jsx)(m.I,{}),children:(0,S.jsx)(C,{})})]})]})}var k=a.A.create({container:{flex:1,height:"100%",display:"flex",flexDirection:"column"},tableContainer:{flex:1,minHeight:0}})}}]);
//# sourceMappingURL=597.bd884864.chunk.js.map