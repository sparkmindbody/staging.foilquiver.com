(self.webpackChunkweb=self.webpackChunkweb||[]).push([[792],{640:(e,t,r)=>{var n=r(2299),o=r(6665),i=r(6520),s=r(2167),a=r(5229),l=r(8833),c=r(3929),d=r(6283),u=r(3668),h=r(5648),m=r(5991),y=r(4667),p=r(2348),g=r(397);class x extends o.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){}handleRetry=()=>{this.setState({hasError:!1,error:null})};render(){return this.state.hasError?(0,g.jsx)(b,{error:this.state.error,onRetry:this.handleRetry}):this.props.children}}const b=({error:e,onRetry:t})=>{const{colors:r}=(0,y.D)();return(0,g.jsx)(c.A,{style:[A.container,{backgroundColor:r.background.primary}],children:(0,g.jsxs)(c.A,{style:A.content,children:[(0,g.jsx)(d.A,{style:[A.title,{color:r.error}],children:"Something went wrong"}),(0,g.jsx)(d.A,{style:[A.message,{color:r.text.secondary}],children:e?.message||"An unexpected error occurred"}),(0,g.jsx)(h.A,{style:[A.button,{backgroundColor:r.primary}],onPress:t,children:(0,g.jsx)(d.A,{style:[A.buttonText,{color:r.text.inverse}],children:"Try Again"})}),!1]})})},A=u.A.create({container:{flex:1,alignItems:"center",justifyContent:"center",padding:p.Y.LARGE},content:{maxWidth:600,width:"100%",alignItems:"center"},title:{fontSize:24,fontWeight:"bold",marginBottom:p.Y.MEDIUM,textAlign:"center"},message:{fontSize:16,marginBottom:p.Y.LARGE,textAlign:"center"},button:Object.assign({paddingHorizontal:p.Y.LARGE,paddingVertical:p.Y.MEDIUM,borderRadius:8,marginBottom:p.Y.LARGE},"web"===m.A.OS&&{cursor:"pointer"}),buttonText:{fontSize:16,fontWeight:"600"},stack:{fontSize:12,fontFamily:"ios"===m.A.OS?"Menlo":"monospace",marginTop:p.Y.LARGE,padding:p.Y.MEDIUM,width:"100%"}});var f=r(5663),j=r(7821),v=r(6447),S=r(3295),w=r(8587),C=r(5708),I=r(558),T=r(13),O=r(6773),E=r(1385),M=r(2763);const k=({value:e,onChangeText:t,onClear:r,placeholder:n="Search foils...",autoFocus:o=!1,mode:i="browse",onFocus:s})=>{const{colors:a}=(0,y.D)(),{width:l}=(0,I.A)(),u=l<M.Dy;return(0,g.jsxs)(c.A,{style:[B.container,{backgroundColor:a.background.secondary}],children:["web"===m.A.OS?(0,g.jsx)(d.A,{style:[B.searchIcon,{color:a.text.secondary}],children:"\ud83d\udd0d"}):(0,g.jsx)(E.A,{name:"search",size:20,color:a.text.secondary}),(0,g.jsx)(O.A,Object.assign({style:[B.input,{color:a.text.primary}],value:e,onChangeText:t,placeholder:(()=>{if(u)switch(i){case"comparison":case"quiver":return"Search to add...";default:return"Search foils..."}switch(i){case"comparison":return"Search foils to add to comparison...";case"quiver":return"Search foils to add to quiver...";default:return"Search foils..."}})(),placeholderTextColor:a.text.tertiary,autoFocus:o,onFocus:s,autoCapitalize:"none",autoCorrect:!1,clearButtonMode:"never",returnKeyType:"search",maxFontSizeMultiplier:1},"web"===m.A.OS?{spellCheck:!1,autoComplete:"off"}:{keyboardType:"web-search"})),""!==e&&(0,g.jsx)(h.A,{onPress:r,style:B.clearButton,children:"web"===m.A.OS?(0,g.jsx)(d.A,{style:[B.clearIcon,{color:a.text.secondary}],children:"\u2715"}):(0,g.jsx)(E.A,{name:"close-circle",size:20,color:a.text.secondary})})]})},B=u.A.create({container:{flexDirection:"row",alignItems:"center",paddingHorizontal:p.Y.MEDIUM,height:40,borderRadius:8,gap:p.Y.SMALL},input:Object.assign({flex:1,fontSize:16,height:"100%"},"web"===m.A.OS&&{outlineStyle:"none",border:"none",background:"transparent",lineHeight:40}),clearButton:Object.assign({height:"100%",aspectRatio:1,alignItems:"center",justifyContent:"center"},"web"===m.A.OS&&{cursor:"pointer"}),searchIcon:{fontSize:16,width:20,height:20,textAlign:"center",lineHeight:20},clearIcon:{fontSize:16,width:20,height:20,textAlign:"center",lineHeight:20}});var D=r(8264),R=r(4307),q=r(484),P=r(1690),_=r(9149),F=r(3600),N=r(5701),z=r(530),L=r(5713);const W=()=>{const[e,t]=(0,o.useState)(!1);return{signInWithGoogle:async()=>{try{if(t(!0),"web"!==m.A.OS)return{data:null,error:new Error("Mobile authentication not yet implemented")};const e=(()=>{if("web"!==m.A.OS)return;const e=window.location.origin,t=window.location.hostname;return"localhost"===t||t.includes("127.0.0.1")?"http://localhost:19006":e})(),{data:r,error:n}=await N.N.auth.signInWithOAuth({provider:"google",options:{redirectTo:e,queryParams:{access_type:"offline",prompt:"consent"}}});return{data:r,error:n}}catch(e){return{data:null,error:e}}finally{t(!1)}},isLoading:e}};var U=r(3710);const V=({onSuccess:e})=>{const{signInWithGoogle:t,isLoading:r}=W();return(0,g.jsx)(h.A,{style:Q.button,onPress:async()=>{try{const{error:r}=await t();if(r)return void P.A.alert("Sign In Error",r instanceof U.lR?r.message:"Failed to sign in");e?.()}catch(r){P.A.alert("Error","An unexpected error occurred during sign in.")}},disabled:r,children:r?(0,g.jsx)(z.A,{color:L.T.text.inverse}):(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(E.A,{name:"logo-google",size:24,color:L.T.text.inverse,style:Q.icon}),(0,g.jsx)(d.A,{style:Q.buttonText,children:"Sign in with Google"})]})})},Q=u.A.create({button:{flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:L.T.primary,padding:12,borderRadius:8,minWidth:220},buttonText:{color:L.T.text.inverse,fontSize:16,fontWeight:"600"},icon:{marginRight:8}});function Y({filterOptions:e,selectedBrands:t,selectedSeries:r,selectedTypes:n,onFilterChange:i,onClearFilters:s,columns:a,onColumnVisibilityChange:l,onResetColumns:u,foils:h}){const[p,x]=(0,o.useState)(!1),[b,A]=(0,o.useState)("filters"),{colors:f,isDark:j,toggleTheme:S}=(0,y.D)(),[w,I]=(0,o.useState)(null),[T,O]=(0,o.useState)(null),[M,k]=(0,o.useState)(!1);(0,o.useEffect)((()=>{N.N.auth.getSession().then((({data:{session:e}})=>{I(e),O(e?.user??null)}));const{data:{subscription:e}}=N.N.auth.onAuthStateChange(((e,t)=>{I(t),O(t?.user??null)}));return()=>e.unsubscribe()}),[]),(0,o.useEffect)((()=>{(async()=>{try{const e=await(0,F.Ir)();e&&(e.brands.forEach((e=>i("brands",e))),e.series.forEach((e=>i("series",e))),e.types.forEach((e=>i("type",e))));const t=await(0,F.E7)();if(t){const e=Object.fromEntries(a.map((e=>[e.id,e.isVisible])));Object.entries(t).forEach((([t,r])=>{e[t]!==r&&l(t)}))}}catch(e){}})()}),[]),(0,o.useEffect)((()=>{(async()=>{try{const e={brands:t,series:r,types:n};await(0,F.ri)(e)}catch(e){}})()}),[t,r,n]),(0,o.useEffect)((()=>{(async()=>{try{const e={};a.forEach((t=>{e[t.id]=t.isVisible})),await(0,F.pF)(e)}catch(e){}})()}),[a]);const B=async()=>{try{const{error:e}=await N.N.auth.signOut();if(e)throw e;I(null),O(null),x(!1)}catch(e){P.A.alert("Error","Failed to sign out")}},z=(0,o.useMemo)((()=>{if(0===t.length)return e.series;const r=new Set;return h.forEach((e=>{t.includes(e.brand)&&e.series&&r.add(e.series)})),Array.from(r).sort()}),[e.series,t,h]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(C.A,{onPress:()=>x(!0),style:[G.iconButton,{backgroundColor:f.background.secondary}],children:(0,g.jsx)(_.A,{name:"settings",size:24,color:f.text.primary})}),(0,g.jsx)(D.A,{visible:p,transparent:!0,animationType:"fade",onRequestClose:()=>x(!1),children:(0,g.jsx)(C.A,{style:[G.modalOverlay,{backgroundColor:j?"rgba(0, 0, 0, 0.7)":"rgba(0, 0, 0, 0.5)"}],onPress:()=>x(!1),children:(0,g.jsxs)(C.A,{style:[G.modalContent,{backgroundColor:f.background.primary}],onPress:e=>e.stopPropagation(),children:[(0,g.jsxs)(c.A,{style:[G.modalHeader,{borderBottomColor:f.border}],children:[(0,g.jsx)(d.A,{style:[G.modalTitle,{color:f.text.primary}],children:"Settings"}),(0,g.jsx)(C.A,{onPress:()=>x(!1),style:G.closeButton,children:(0,g.jsx)(_.A,{name:"close",size:24,color:f.text.secondary})})]}),(0,g.jsxs)(c.A,{style:[G.tabs,{borderBottomColor:f.border}],children:[(0,g.jsx)(C.A,{style:[G.tab,"filters"===b&&[G.activeTab,{borderBottomColor:f.primary}]],onPress:()=>A("filters"),children:(0,g.jsxs)(d.A,{style:[G.tabText,{color:f.text.secondary},"filters"===b&&[G.activeTabText,{color:f.primary}]],children:["Filters ",(t.length>0||r.length>0||n.length>0)&&"\u2022"]})}),(0,g.jsx)(C.A,{style:[G.tab,"columns"===b&&[G.activeTab,{borderBottomColor:f.primary}]],onPress:()=>A("columns"),children:(0,g.jsxs)(d.A,{style:[G.tabText,{color:f.text.secondary},"columns"===b&&[G.activeTabText,{color:f.primary}]],children:["Columns ",a.some((e=>!e.isVisible))&&"\u2022"]})}),(0,g.jsx)(C.A,{style:[G.tab,"appearance"===b&&[G.activeTab,{borderBottomColor:f.primary}]],onPress:()=>A("appearance"),children:(0,g.jsx)(d.A,{style:[G.tabText,{color:f.text.secondary},"appearance"===b&&[G.activeTabText,{color:f.primary}]],children:"Appearance"})}),(0,g.jsx)(C.A,{style:[G.tab,"account"===b&&[G.activeTab,{borderBottomColor:f.primary}]],onPress:()=>A("account"),children:(0,g.jsx)(d.A,{style:[G.tabText,{color:f.text.secondary},"account"===b&&[G.activeTabText,{color:f.primary}]],children:"Account"})})]}),"filters"===b?(0,g.jsx)(c.A,{style:G.contentWrapper,children:(0,g.jsx)(R.A,{style:G.scrollView,contentContainerStyle:G.scrollContent,children:(0,g.jsxs)(c.A,{style:G.content,children:[(0,g.jsxs)(c.A,{style:G.headerWithAction,children:[(0,g.jsx)(d.A,{style:[G.contentTitle,{color:f.text.primary}],children:"Active Filters"}),(t.length>0||r.length>0||n.length>0)&&(0,g.jsx)(C.A,{onPress:s,style:[G.clearButton,{backgroundColor:f.background.secondary}],children:(0,g.jsx)(d.A,{style:[G.clearButtonText,{color:f.text.secondary}],children:"Clear All"})})]}),(0,g.jsxs)(c.A,{style:G.section,children:[(0,g.jsx)(d.A,{style:[G.sectionTitle,{color:f.text.primary}],children:"Brand"}),(0,g.jsx)(c.A,{style:G.chipContainer,children:e.brands.map((e=>(0,g.jsx)(C.A,{style:[G.chip,{backgroundColor:f.background.secondary},t.includes(e)&&[G.chipSelected,{backgroundColor:f.primary}]],onPress:()=>i("brands",e),children:(0,g.jsx)(d.A,{style:[G.chipText,{color:f.text.secondary},t.includes(e)&&[G.chipTextSelected,{color:f.text.inverse}]],children:e})},e)))})]}),(0,g.jsxs)(c.A,{style:G.section,children:[(0,g.jsx)(d.A,{style:[G.sectionTitle,{color:f.text.primary}],children:"Type"}),(0,g.jsx)(c.A,{style:G.chipContainer,children:e.types.map((e=>(0,g.jsx)(C.A,{style:[G.chip,{backgroundColor:f.background.secondary},n.includes(e)&&[G.chipSelected,{backgroundColor:f.primary}]],onPress:()=>i("type",e),children:(0,g.jsx)(d.A,{style:[G.chipText,{color:f.text.secondary},n.includes(e)&&[G.chipTextSelected,{color:f.text.inverse}]],children:e})},e)))})]}),(0,g.jsxs)(c.A,{style:G.section,children:[(0,g.jsx)(d.A,{style:[G.sectionTitle,{color:f.text.primary}],children:"Series"}),(0,g.jsx)(c.A,{style:G.chipContainer,children:z.length>0?z.map((e=>(0,g.jsx)(C.A,{style:[G.chip,{backgroundColor:f.background.secondary},r.includes(e)&&[G.chipSelected,{backgroundColor:f.primary}]],onPress:()=>i("series",e),children:(0,g.jsx)(d.A,{style:[G.chipText,{color:f.text.secondary},r.includes(e)&&[G.chipTextSelected,{color:f.text.inverse}]],children:e})},e))):(0,g.jsx)(d.A,{style:[G.noSeriesText,{color:f.text.secondary}],children:"No series available for selected brands"})})]})]})})}):"columns"===b?(0,g.jsx)(c.A,{style:G.contentWrapper,children:(0,g.jsx)(R.A,{style:G.scrollView,contentContainerStyle:G.scrollContent,children:(0,g.jsxs)(c.A,{style:G.content,children:[(0,g.jsxs)(c.A,{style:G.headerWithAction,children:[(0,g.jsx)(d.A,{style:[G.contentTitle,{color:f.text.primary}],children:"Visible Columns"}),a.some((e=>!e.isVisible))&&(0,g.jsx)(C.A,{onPress:async()=>{u();try{const e={};a.forEach((t=>{e[t.id]=t.isVisible})),await(0,F.pF)(e)}catch(e){}},style:[G.clearButton,{backgroundColor:f.background.secondary}],children:(0,g.jsx)(d.A,{style:[G.clearButtonText,{color:f.text.secondary}],children:"Reset"})})]}),(0,g.jsx)(c.A,{style:G.columnList,children:a.map((e=>(0,g.jsxs)(C.A,{style:G.columnItem,onPress:()=>(async e=>{l(e)})(e.id),children:[(0,g.jsx)(d.A,{style:[G.columnLabel,{color:f.text.primary}],children:e.label}),(0,g.jsx)(c.A,{style:[G.checkbox,{borderColor:f.border},e.isVisible&&[G.checkboxChecked,{backgroundColor:f.primary,borderColor:f.primary}]],children:e.isVisible&&(0,g.jsx)(_.A,{name:"check",size:16,color:f.text.inverse})})]},e.id)))})]})})}):"appearance"===b?(0,g.jsx)(c.A,{style:G.contentWrapper,children:(0,g.jsx)(R.A,{style:G.scrollView,contentContainerStyle:G.scrollContent,children:(0,g.jsxs)(c.A,{style:G.content,children:[(0,g.jsx)(d.A,{style:[G.contentTitle,{color:f.text.primary}],children:"Theme Settings"}),(0,g.jsx)(c.A,{style:G.section,children:(0,g.jsx)(C.A,{style:[G.menuButton,{backgroundColor:f.background.secondary}],onPress:S,children:(0,g.jsxs)(c.A,{style:G.menuButtonContent,children:[(0,g.jsx)(_.A,{name:j?"dark-mode":"light-mode",size:20,color:f.text.primary}),(0,g.jsx)(d.A,{style:[G.menuButtonText,{color:f.text.primary}],children:j?"Dark Mode":"Light Mode"})]})})})]})})}):w?(0,g.jsx)(c.A,{style:G.contentWrapper,children:(0,g.jsx)(R.A,{style:G.scrollView,contentContainerStyle:G.scrollContent,children:(0,g.jsxs)(c.A,{style:G.content,children:[(0,g.jsxs)(c.A,{style:G.userInfo,children:[T?.user_metadata?.avatar_url&&(0,g.jsx)(q.A,{source:{uri:T.user_metadata.avatar_url},style:G.avatarImage}),(0,g.jsxs)(c.A,{style:G.userTextInfo,children:[(0,g.jsx)(d.A,{style:[G.userName,{color:f.text.primary}],children:T?.user_metadata?.full_name||T?.email}),(0,g.jsx)(d.A,{style:[G.userEmail,{color:f.text.secondary}],children:T?.email})]})]}),(0,g.jsx)(c.A,{style:[G.menuDivider,{backgroundColor:f.border}]}),(0,g.jsxs)(c.A,{style:G.section,children:[(0,g.jsx)(d.A,{style:[G.sectionTitle,{color:f.text.primary}],children:"Quivers"}),(0,g.jsxs)(C.A,{style:[G.menuButton,{backgroundColor:f.background.secondary}],onPress:()=>{k(!0)},children:[(0,g.jsxs)(c.A,{style:G.menuButtonContent,children:["web"===m.A.OS?(0,g.jsx)(d.A,{style:{fontSize:20,color:f.text.primary},children:"\ud83c\udfaf"}):(0,g.jsx)(E.A,{name:"bookmark-outline",size:20,color:f.text.primary}),(0,g.jsx)(d.A,{style:[G.menuButtonText,{color:f.text.primary}],children:"Manage Quivers"})]}),(0,g.jsx)(_.A,{name:"chevron-right",size:20,color:f.text.secondary})]})]}),(0,g.jsx)(c.A,{style:G.section,children:(0,g.jsx)(C.A,{style:[G.signOutButton,{backgroundColor:f.background.secondary}],onPress:B,children:(0,g.jsxs)(c.A,{style:G.menuButtonContent,children:["web"===m.A.OS?(0,g.jsx)(d.A,{style:{fontSize:20,color:f.text.primary},children:"\u21e5"}):(0,g.jsx)(E.A,{name:"log-out-outline",size:20,color:f.text.primary}),(0,g.jsx)(d.A,{style:[G.menuButtonText,{color:f.text.primary}],children:"Sign Out"})]})})})]})})}):(0,g.jsx)(c.A,{style:G.contentWrapper,children:(0,g.jsxs)(c.A,{style:G.content,children:[(0,g.jsx)(d.A,{style:[G.contentTitle,{color:f.text.primary,marginBottom:16}],children:"Sign In"}),(0,g.jsx)(V,{onSuccess:()=>{x(!1)}})]})})]})})}),(0,g.jsx)(D.A,{visible:M,transparent:!0,animationType:"fade",onRequestClose:()=>k(!1),children:(0,g.jsx)(c.A,{style:[G.modalOverlay,{backgroundColor:"rgba(0, 0, 0, 0.5)"}],onStartShouldSetResponder:()=>!0,children:(0,g.jsx)(c.A,{style:[G.modalContent,{backgroundColor:f.background.primary}],children:(0,g.jsx)(v.G,{selectedFoils:[],onClose:()=>k(!1),initialTab:"saved",standalone:!0})})})})]})}const G=u.A.create({container:{position:"relative"},button:{padding:p.Y.MEDIUM},iconButton:{padding:p.Y.XSMALL,borderRadius:8},modalContent:{width:"100%",maxWidth:600,borderRadius:12,maxHeight:"90%",overflow:"hidden"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:p.Y.LARGE,borderBottomWidth:1},buttonGroup:{flexDirection:"row",alignItems:"center",gap:p.Y.SMALL},columnGroup:{flexDirection:"column",gap:p.Y.MEDIUM},filterGroup:{padding:p.Y.MEDIUM},filterList:{gap:p.Y.MEDIUM},modalOverlay:{flex:1,justifyContent:"center",alignItems:"center",padding:p.Y.LARGE},modalTitle:{fontSize:18,fontWeight:"600"},closeButton:{padding:4},tabs:{flexDirection:"row",borderBottomWidth:1},tab:{flex:1,padding:12,alignItems:"center"},activeTab:{borderBottomWidth:2},tabText:{fontSize:14,fontWeight:"500"},activeTabText:{},content:{padding:16,width:"100%"},contentWrapper:{flex:1},scrollView:{flex:1},scrollContent:{flexGrow:1},section:{marginBottom:24},sectionTitle:{fontSize:14,fontWeight:"600",marginBottom:12},chipContainer:{flexDirection:"row",flexWrap:"wrap",gap:8},chip:{borderRadius:16,paddingHorizontal:12,paddingVertical:6},chipSelected:{},chipText:{fontSize:14},chipTextSelected:{},columnList:{gap:12},columnItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:8},columnLabel:{fontSize:14},checkbox:{width:20,height:20,borderRadius:4,borderWidth:2,alignItems:"center",justifyContent:"center"},checkboxChecked:{},headerWithAction:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:16},contentTitle:{fontSize:16,fontWeight:"600"},clearButton:{paddingHorizontal:12,paddingVertical:6,borderRadius:16},clearButtonText:{fontSize:14},noSeriesText:{fontSize:14,fontWeight:"500"},userInfo:{flexDirection:"row",alignItems:"center",gap:12,marginBottom:16},userTextInfo:{flex:1},avatarImage:{width:48,height:48,borderRadius:24},userName:{fontSize:16,fontWeight:"600",marginBottom:4},userEmail:{fontSize:14},menuDivider:{height:1,marginBottom:16},menuButton:Object.assign({flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:12,borderRadius:8},"web"===m.A.OS&&{cursor:"pointer"}),menuButtonContent:{flexDirection:"row",alignItems:"center",gap:12},menuButtonText:{fontSize:14,fontWeight:"500"},signOutButton:Object.assign({flexDirection:"row",alignItems:"center",padding:12,borderRadius:8},"web"===m.A.OS&&{cursor:"pointer"})});var J=r(209),H=r(2419),X=r(9659),Z=r(382);const $=["children"],K=o.lazy((()=>r.e(269).then(r.bind(r,3269)))),ee=o.lazy((()=>r.e(415).then(r.bind(r,6415)))),te=o.lazy((()=>r.e(358).then(r.bind(r,7358)))),re=o.lazy((()=>r.e(951).then(r.bind(r,8951)))),ne=o.lazy((()=>r.e(50).then(r.bind(r,3050)))),oe=o.lazy((()=>r.e(553).then(r.bind(r,4553)))),ie=(0,T.A)(),se={home:"home-outline",browse:"search-outline",compare:"git-compare-outline",settings:"settings-outline",quiver:"bookmark-outline"};function ae({name:e,color:t}){if("web"===m.A.OS){const r={home:"\ud83c\udfe0",browse:"\ud83d\udd0d",compare:"\u2696\ufe0f",settings:"\u2699\ufe0f",quiver:"\ud83d\udd16"};return(0,g.jsx)(d.A,{style:{fontSize:20,color:t},children:r[e]})}return(0,g.jsx)(E.A,{name:se[e],size:24,color:t})}(0,S.Qq)().webUrl,X.JZ.browse,X.JZ.comparison,X.JZ.quiver,X.JZ.terms,X.JZ.privacy,X.JZ.contact;const le=e=>{let{children:t}=e,r=(0,w.A)(e,$);return(0,g.jsx)(o.Suspense,{fallback:(0,g.jsx)(j.I,{}),children:o.cloneElement(t,r)})},ce=()=>{const e=(0,s.cq)(),{colors:t}=(0,y.D)(),{width:r}=(0,I.A)(),n=r<M.Dy,{foils:i}=(0,J.J)(),{searchQuery:a,setSearchQuery:l,filters:u,setFilters:m,columns:p,setColumns:x,setCurrentScreen:b}=(0,f.n)(),{filterOptions:A}=(0,H.c)(i,u),{showQuiverManager:j}=(0,o.useContext)(ue),v=o.useMemo((()=>i?.length?[...new Set(i.map((e=>e.brand)))].sort():[]),[i]),S=()=>{e.navigate("Browse",{})},w=t=>{l(t),e.setParams({searchQuery:t})},T=e=>"Comparison"===e.name?"comparison":"Quiver"===e.name?"quiver":"browse",O=e=>{switch(e.name){case"Comparison":return"Search foils to add to comparison...";case"Quiver":return"Search foils to add to quiver...";default:return"Search foils..."}},E=t=>{"Browse"===t.name&&e.setParams({showSearchDropdown:!0})},B=(e,t)=>{((e,t)=>{m((r=>Object.assign({},r,{[e]:r[e].includes(t)?r[e].filter((e=>e!==t)):[...r[e],t]})))})(e,t)},D=()=>{m({brands:[],series:[],type:[]})},R=e=>{x((t=>t.map((t=>t.id===e?Object.assign({},t,{isVisible:!t.isVisible}):t))))},q=()=>{x(M._X)},P=o.useMemo((()=>(0,M.lD)(p)),[p]);o.useMemo((()=>(0,M.y6)(P,r,n)),[P,r,n]),o.useMemo((()=>n?"100%":Math.min(P+2*M.Op,r)),[P,r,n]);(0,o.useEffect)((()=>{(async()=>{try{const e=await(0,F.E7)();if(e){const t=M._X.map((t=>Object.assign({},t,{isVisible:"boolean"===typeof e[t.id]?e[t.id]:t.isVisible})));x(t)}}catch(e){}})()}),[]),(0,o.useEffect)((()=>{(async()=>{try{const e=await(0,F.Ir)();e&&m({brands:e.brands||[],series:e.series||[],type:e.types||[]})}catch(e){}})()}),[]);const _=o.useMemo((()=>{if(n)return{width:"100%",paddingHorizontal:M.Op};const e=(0,M.lD)(p);return{width:e,maxWidth:(0,M.y6)(e,r,!1),alignSelf:"center"}}),[p,r,n]),N=e=>n?(0,g.jsxs)(c.A,{style:de.headerRightContainerMobile,children:[(0,g.jsx)(h.A,{style:[de.headerButton],onPress:j,children:(0,g.jsx)(ae,{name:"quiver",color:t.text.primary})}),(0,g.jsx)(Y,{filterOptions:A,selectedBrands:u.brands,selectedSeries:u.series,selectedTypes:u.type,onFilterChange:B,onClearFilters:D,columns:p,onColumnVisibilityChange:R,onResetColumns:q,foils:i})]}):(0,g.jsxs)(c.A,{style:de.headerRightContainerWeb,children:[(0,g.jsxs)(h.A,{style:[de.headerButton],onPress:j,children:[(0,g.jsx)(ae,{name:"quiver",color:t.text.primary}),!n&&(0,g.jsx)(d.A,{style:[de.headerButtonText,{color:t.text.primary}],children:"My Quivers"})]}),(0,g.jsx)(Y,{filterOptions:A,selectedBrands:u.brands,selectedSeries:u.series,selectedTypes:u.type,onFilterChange:B,onClearFilters:D,columns:p,onColumnVisibilityChange:R,onResetColumns:q,foils:i})]});return(0,g.jsxs)(ie.Navigator,{screenOptions:{headerStyle:{backgroundColor:t.background.primary},headerShadowVisible:!1},children:[(0,g.jsx)(ie.Screen,{name:"Browse",options:({route:e})=>({headerTitle:e.params?.title||"",headerLeft:()=>(0,g.jsx)(c.A,{style:[de.headerOuterContainer,{backgroundColor:t.background.primary},!n&&{alignItems:"center"}],children:n?(0,g.jsx)(c.A,{style:de.headerMainContainerMobile,children:(0,g.jsxs)(c.A,{style:de.headerTopRowMobile,children:[(0,g.jsx)(C.A,{onPress:S,style:({pressed:e})=>[de.logoContainerMobile,e&&de.logoPressed],children:(0,g.jsx)(d.A,{style:[de.headerTitleMobile,{color:t.primary}],children:"Foilquiver"})}),(0,g.jsx)(c.A,{style:de.searchBarContainerMobile,children:(0,g.jsx)(k,{value:a,onChangeText:e=>w(e),onClear:()=>w(""),mode:T(e),placeholder:O(e),onFocus:()=>E(e)})}),N()]})}):(0,g.jsx)(c.A,{style:[de.headerMainContainerWeb,_],children:(0,g.jsxs)(c.A,{style:[de.headerContentWeb,{width:"100%",alignItems:"center",justifyContent:"space-between"}],children:[(0,g.jsx)(C.A,{onPress:S,style:({pressed:e})=>[de.logoContainer,e&&de.logoPressed],children:(0,g.jsx)(d.A,{style:[de.headerTitle,{color:t.primary}],children:"Foilquiver"})}),(0,g.jsx)(c.A,{style:[de.searchBarContainerWeb,{flex:1}],children:(0,g.jsx)(k,{value:a,onChangeText:e=>w(e),onClear:()=>w(""),mode:T(e),placeholder:O(e),onFocus:()=>E(e)})}),N()]})})})}),children:e=>(0,g.jsx)(le,{children:(0,g.jsx)(K,Object.assign({},e,{filters:u,onFilterChange:B,columns:p,brands:v}))})}),(0,g.jsx)(ie.Screen,{name:"Comparison",options:({route:e})=>({headerTitle:e.params?.title||"",headerLeft:()=>(0,g.jsx)(c.A,{style:[de.headerOuterContainer,{backgroundColor:t.background.primary},!n&&{alignItems:"center"}],children:n?(0,g.jsx)(c.A,{style:de.headerMainContainerMobile,children:(0,g.jsxs)(c.A,{style:de.headerTopRowMobile,children:[(0,g.jsx)(C.A,{onPress:S,style:({pressed:e})=>[de.logoContainerMobile,e&&de.logoPressed],children:(0,g.jsx)(d.A,{style:[de.headerTitleMobile,{color:t.primary}],children:"Foilquiver"})}),(0,g.jsx)(c.A,{style:de.searchBarContainerMobile,children:(0,g.jsx)(k,{value:a,onChangeText:e=>w(e),onClear:()=>w(""),mode:T(e),placeholder:O(e),onFocus:()=>E(e)})}),N()]})}):(0,g.jsx)(c.A,{style:[de.headerMainContainerWeb,_],children:(0,g.jsxs)(c.A,{style:[de.headerContentWeb,{width:"100%",alignItems:"center",justifyContent:"space-between"}],children:[(0,g.jsx)(C.A,{onPress:S,style:({pressed:e})=>[de.logoContainer,e&&de.logoPressed],children:(0,g.jsx)(d.A,{style:[de.headerTitle,{color:t.primary}],children:"Foilquiver"})}),(0,g.jsx)(c.A,{style:[de.searchBarContainerWeb,{flex:1}],children:(0,g.jsx)(k,{value:a,onChangeText:e=>w(e),onClear:()=>w(""),mode:T(e),placeholder:O(e),onFocus:()=>E(e)})}),N()]})})})}),children:e=>(0,g.jsx)(le,{children:(0,g.jsx)(ee,Object.assign({},e))})}),(0,g.jsx)(ie.Screen,{name:"Quiver",options:({route:e})=>({headerTitle:"",headerLeft:()=>(0,g.jsx)(c.A,{style:[de.headerOuterContainer,{backgroundColor:t.background.primary},!n&&{alignItems:"center"}],children:n?(0,g.jsx)(c.A,{style:de.headerMainContainerMobile,children:(0,g.jsxs)(c.A,{style:de.headerTopRowMobile,children:[(0,g.jsx)(C.A,{onPress:S,style:({pressed:e})=>[de.logoContainerMobile,e&&de.logoPressed],children:(0,g.jsx)(d.A,{style:[de.headerTitleMobile,{color:t.primary}],children:"Foilquiver"})}),(0,g.jsx)(c.A,{style:de.searchBarContainerMobile,children:(0,g.jsx)(k,{value:a,onChangeText:e=>w(e),onClear:()=>w(""),mode:T(e),placeholder:O(e),onFocus:()=>E(e)})}),N()]})}):(0,g.jsx)(c.A,{style:[de.headerMainContainerWeb,_],children:(0,g.jsxs)(c.A,{style:[de.headerContentWeb,{width:"100%",alignItems:"center",justifyContent:"space-between"}],children:[(0,g.jsx)(C.A,{onPress:S,style:({pressed:e})=>[de.logoContainer,e&&de.logoPressed],children:(0,g.jsx)(d.A,{style:[de.headerTitle,{color:t.primary}],children:"Foilquiver"})}),(0,g.jsx)(c.A,{style:[de.searchBarContainerWeb,{flex:1}],children:(0,g.jsx)(k,{value:a,onChangeText:e=>w(e),onClear:()=>w(""),mode:T(e),placeholder:O(e),onFocus:()=>E(e)})}),N()]})})})}),children:e=>{const t=o.useMemo((()=>e.route.params?.foil_ids&&Array.isArray(i)?i.filter((t=>{if(!t)return!1;const r=(0,Z.h)(t);return e.route.params.foil_ids.includes(r)})):[]),[e.route.params?.foil_ids,i]);return(0,g.jsx)(le,{children:(0,g.jsx)(te,Object.assign({},e,{searchProps:{value:a,onChangeText:w,onClear:()=>l(""),mode:"quiver",placeholder:"Search foils in quiver..."},tableSettingsProps:{filterOptions:A,selectedBrands:u.brands,selectedSeries:u.series,selectedTypes:u.type,onFilterChange:B,onClearFilters:D,columns:p,onColumnVisibilityChange:R,onResetColumns:q,foils:t}}))})}}),(0,g.jsx)(ie.Screen,{name:"Terms",options:{headerShown:!1},children:e=>(0,g.jsx)(le,{children:(0,g.jsx)(ne,Object.assign({},e))})}),(0,g.jsx)(ie.Screen,{name:"Privacy",options:{headerShown:!1},children:e=>(0,g.jsx)(le,{children:(0,g.jsx)(re,Object.assign({},e))})}),(0,g.jsx)(ie.Screen,{name:"Contact",options:{headerShown:!1},children:e=>(0,g.jsx)(le,{children:(0,g.jsx)(oe,Object.assign({},e))})})]})},de=u.A.create({headerOuterContainer:{flex:1,paddingHorizontal:M.Op},headerMainContainerMobile:{width:"100%"},headerTopRowMobile:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",height:48,width:"100%",gap:8},logoContainerMobile:{height:"100%",justifyContent:"center",minWidth:80},headerTitleMobile:{fontSize:18,fontWeight:"bold"},searchBarContainerMobile:{flex:1,height:36,minWidth:120,maxWidth:200},headerRightContainerMobile:{flexDirection:"row",alignItems:"center",gap:4,zIndex:2e3},headerMainContainerWeb:{height:72,width:"100%"},headerContentWeb:{flexDirection:"row",alignItems:"center",gap:24,height:"100%",width:"100%"},searchBarContainerWeb:{flex:1,height:40},logoContainer:{height:"100%",justifyContent:"center",minWidth:120},logoPressed:{opacity:.7},headerTitle:{fontSize:24,fontWeight:"bold"},headerRightContainerWeb:{flexDirection:"row",alignItems:"center",gap:16,paddingRight:M.Op,zIndex:2e3},headerButton:Object.assign({flexDirection:"row",alignItems:"center",gap:8,padding:6,borderRadius:8},"web"===m.A.OS&&{cursor:"pointer",userSelect:"none"}),headerButtonText:{fontSize:14,fontWeight:"500"}}),ue=o.createContext({showQuiverManager:()=>{},hideQuiverManager:()=>{}});(0,n.A)((function(){const e=(0,s.bE)(),[t,r]=(0,o.useState)(!1),n=()=>r(!1),d={prefixes:(0,S.vA)(),config:{screens:{Browse:{path:"/",parse:{mode:e=>e},stringify:{mode:e=>e}},Comparison:{path:"/comparison",exact:!0,stringify:{quiverName:e=>e,foils:e=>JSON.stringify(e)}},Quiver:{path:"/quiver/:quiverId",parse:{quiverId:e=>e,quiverName:e=>e,foils:e=>e?JSON.parse(e):void 0},stringify:{quiverId:e=>e,quiverName:e=>e,foils:e=>JSON.stringify(e)}},Terms:"/terms",Privacy:"/privacy",Contact:"/contact"}},getStateFromPath:(e,t)=>"/comparison"===e?{routes:[{name:"Comparison",params:{}}]}:(0,s.Bd)(e,t),getPathFromState:(e,t)=>{if("Comparison"===e.routes[e.routes.length-1].name)return"/comparison";return(0,s.Fy)(e,t)||"/"}};return(0,g.jsx)(y.N,{children:(0,g.jsx)(f.D,{children:(0,g.jsx)(ue.Provider,{value:{showQuiverManager:()=>r(!0),hideQuiverManager:n},children:(0,g.jsx)(a.vd,{children:(0,g.jsx)(x,{children:(0,g.jsx)(l.Oy,{children:(0,g.jsx)(i.A,{ref:e,linking:d,fallback:(0,g.jsx)(j.I,{}),children:(0,g.jsxs)(c.A,{style:{flex:1},children:[(0,g.jsx)(ce,{}),t&&(0,g.jsx)(v.G,{standalone:!1,isModalVisible:t,onClose:n,initialTab:"saved"})]})})})})})})})})}))},7821:(e,t,r)=>{r.d(t,{I:()=>d});r(6665);var n=r(3929),o=r(6283),i=r(530),s=r(3668),a=r(4667),l=r(2348),c=r(397);const d=({message:e="Loading...",size:t="large",fullScreen:r=!0})=>{const{colors:s}=(0,a.D)();return(0,c.jsxs)(n.A,{style:[u.container,r&&u.fullScreen,{backgroundColor:s.background.primary}],children:[(0,c.jsx)(i.A,{size:t,color:s.primary}),e&&(0,c.jsx)(o.A,{style:[u.message,{color:s.text.secondary}],children:e})]})},u=s.A.create({container:{padding:l.Y.LARGE,alignItems:"center",justifyContent:"center"},fullScreen:{flex:1},message:{marginTop:l.Y.MEDIUM,fontSize:16,textAlign:"center"}})},6447:(e,t,r)=>{r.d(t,{G:()=>w});var n=r(6665),o=r(3929),i=r(6283),s=r(3668),a=r(5648),l=r(8264),c=r(6773),d=r(4307),u=r(1690),h=r(5991),m=r(558),y=r(1385),p=r(2167),g=r(4812),x=r(4667),b=r(2763),A=r(2348),f=r(5025),j=r(5663),v=r(382),S=r(397);const w=({selectedFoils:e=[],onClose:t,initialTab:r="save",standalone:s=!1,isModalVisible:A,hideStandaloneButton:w=!1,onQuiverSaved:I})=>{const{colors:T}=(0,x.D)(),{width:O}=(0,m.A)(),E=O<b.Dy,M=(0,p.cq)(),{setSelectedFoils:k}=(0,j.n)(),[B,D]=(0,n.useState)(!s),R=void 0!==A?A:B,[q,P]=(0,n.useState)(""),[_,F]=(0,n.useState)(""),[N,z]=(0,n.useState)(r),[L,W]=(0,n.useState)(null),[U,V]=(0,n.useState)(""),{quivers:Q,isLoading:Y,error:G,createQuiver:J,deleteQuiver:H,reloadQuivers:X,updateQuiver:Z}=(0,g.X)(),$=async()=>{if(L&&U.trim())try{await Z(L,{name:U.trim()})&&((0,f.k4)(f.R2.UPDATE_QUIVER,{quiverId:L,action:"rename"}),"web"===h.A.OS?window.alert("Quiver renamed successfully"):u.A.alert("Success","Quiver renamed successfully"),W(null),V(""),X())}catch(G){u.A.alert("Error","Failed to rename quiver")}},K=e=>e.foil_ids&&Array.isArray(e.foil_ids)?e.foil_ids.length:0,ee=(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(o.A,{style:[C.modalHeader,{borderBottomColor:T.border}],children:[(0,S.jsx)(i.A,{style:[C.modalTitle,{color:T.text.primary}],children:"Manage Quivers"}),t&&(0,S.jsx)(a.A,{onPress:t,children:"web"===h.A.OS?(0,S.jsx)(i.A,{style:{fontSize:24,color:T.text.primary},children:"\xd7"}):(0,S.jsx)(y.A,{name:"close",size:24,color:T.text.primary})})]}),e.length>0&&(0,S.jsxs)(o.A,{style:[C.tabContainer,{borderBottomColor:T.border}],children:[(0,S.jsx)(a.A,{style:[C.tab,"save"===N&&[C.activeTab,{borderBottomColor:T.primary}]],onPress:()=>z("save"),children:(0,S.jsx)(i.A,{style:[C.tabText,{color:"save"===N?T.primary:T.text.secondary}],children:"Save Quiver"})}),(0,S.jsx)(a.A,{style:[C.tab,"saved"===N&&[C.activeTab,{borderBottomColor:T.primary}]],onPress:()=>z("saved"),children:(0,S.jsx)(i.A,{style:[C.tabText,{color:"saved"===N?T.primary:T.text.secondary}],children:"Saved Quivers"})})]}),(0,S.jsx)(d.A,{style:C.modalBody,children:"save"===N?(0,S.jsxs)(o.A,{style:C.form,children:[(0,S.jsxs)(o.A,{style:C.formField,children:[(0,S.jsx)(i.A,{style:[C.label,{color:T.text.secondary}],children:"Name"}),(0,S.jsx)(c.A,{style:[C.input,{color:T.text.primary,borderColor:T.border,backgroundColor:T.background.secondary}],value:q,onChangeText:P,placeholder:"Enter quiver name",placeholderTextColor:T.text.tertiary})]}),(0,S.jsxs)(o.A,{style:C.formField,children:[(0,S.jsx)(i.A,{style:[C.label,{color:T.text.secondary}],children:"Description (optional)"}),(0,S.jsx)(c.A,{style:[C.input,C.textArea,{color:T.text.primary,borderColor:T.border,backgroundColor:T.background.secondary}],value:_,onChangeText:F,placeholder:"Enter description",placeholderTextColor:T.text.tertiary,multiline:!0,numberOfLines:3})]}),(0,S.jsx)(a.A,{style:[C.createButton,{backgroundColor:T.primary}],onPress:async()=>{if(q.trim())try{const r=await J({name:q.trim(),description:_.trim(),foils:e});if(!r)throw new Error("Failed to create quiver - no result returned");(0,f.k4)(f.R2.SAVE_QUIVER,{foilCount:e.length,isNewQuiver:!0,fromComparison:e.length>0}),P(""),F(""),D(!1),t?.(),I?.(r.id,r.name),M.navigate("Quiver",{quiverId:r.id,quiverName:r.name,foil_ids:e.map((e=>(0,v.h)(e)))})}catch(G){"web"===h.A.OS?window.alert(`Failed to save quiver: ${G instanceof Error?G.message:"Unknown error"}`):u.A.alert("Error",`Failed to save quiver: ${G instanceof Error?G.message:"Unknown error"}`)}else"web"===h.A.OS?window.alert("Please enter a name for your quiver"):u.A.alert("Error","Please enter a name for your quiver")},children:(0,S.jsx)(i.A,{style:[C.buttonText,{color:T.text.inverse}],children:e.length>0?"Save Quiver":"Create Empty Quiver"})})]}):(0,S.jsx)(o.A,{style:C.quiverList,children:Y?(0,S.jsx)(o.A,{style:C.centerContent,children:(0,S.jsx)(i.A,{style:[C.message,{color:T.text.secondary}],children:"Loading quivers..."})}):G?(0,S.jsx)(o.A,{style:C.centerContent,children:(0,S.jsx)(i.A,{style:[C.message,{color:T.error}],children:G})}):(0,S.jsxs)(o.A,{children:[0===Q.length?(0,S.jsx)(o.A,{style:C.centerContent,children:(0,S.jsx)(i.A,{style:[C.message,{color:T.text.secondary}],children:"No saved quivers yet"})}):Q.map((e=>(0,S.jsxs)(o.A,{style:[C.quiverItem,{borderBottomColor:T.border}],children:[(0,S.jsx)(a.A,{style:C.quiverInfo,onPress:()=>(e=>{D(!1),t?.(),k([]),M.navigate("Quiver",{quiverId:e.id,quiverName:e.name,foil_ids:e.foil_ids||[]})})(e),children:L===e.id?(0,S.jsxs)(o.A,{style:C.renameContainer,children:[(0,S.jsx)(c.A,{style:[C.renameInput,{color:T.text.primary,borderColor:T.border,backgroundColor:T.background.secondary}],value:U,onChangeText:V,placeholder:"Enter new name",placeholderTextColor:T.text.tertiary,autoFocus:!0}),(0,S.jsx)(a.A,{style:[C.renameButton,{backgroundColor:T.error}],onPress:()=>{W(null),V("")},children:(0,S.jsx)(i.A,{style:[C.renameButtonText,{color:T.text.inverse}],children:"Cancel"})}),(0,S.jsx)(a.A,{style:[C.renameButton,{backgroundColor:T.primary}],onPress:$,children:(0,S.jsx)(i.A,{style:[C.renameButtonText,{color:T.text.inverse}],children:"Save"})})]}):(0,S.jsxs)(S.Fragment,{children:[(0,S.jsxs)(o.A,{style:C.quiverNameContainer,children:[(0,S.jsx)(i.A,{style:[C.quiverName,{color:T.text.primary}],children:e.name}),(0,S.jsx)(a.A,{onPress:()=>(e=>{W(e.id),V(e.name)})(e),style:C.renameIcon,children:"web"===h.A.OS?(0,S.jsx)(i.A,{style:{color:T.text.secondary},children:"\u270e"}):(0,S.jsx)(y.A,{name:"pencil",size:16,color:T.text.secondary})})]}),e.description&&(0,S.jsx)(i.A,{style:[C.quiverDescription,{color:T.text.secondary}],children:e.description}),(0,S.jsxs)(i.A,{style:[C.quiverMeta,{color:T.text.tertiary}],children:[K(e)," foils \u2022 ",new Date(e.updated_at).toLocaleDateString()]})]})}),"web"===h.A.OS?(0,S.jsx)("button",{type:"button",onClick:()=>{try{window.confirm("Are you sure you want to delete this quiver? This action cannot be undone.")&&H(e.id).then((e=>{e?X():window.alert("Failed to delete quiver")})).catch((e=>{window.alert("Error deleting quiver")}))}catch(G){window.alert("Error in delete operation")}},style:{padding:"8px",borderWidth:"1px",borderStyle:"solid",borderColor:T.error,borderRadius:"8px",minWidth:"70px",backgroundColor:T.background.primary,cursor:"pointer",color:T.error,fontWeight:"600",fontSize:"14px",display:"flex",alignItems:"center",justifyContent:"center",zIndex:10,position:"relative",pointerEvents:"auto"},children:"Delete"}):(0,S.jsx)(a.A,{style:[C.deleteButton,{borderColor:T.error,backgroundColor:T.background.primary}],onPress:()=>{(async e=>{try{if(!await new Promise((e=>{u.A.alert("Delete Quiver","Are you sure you want to delete this quiver? This action cannot be undone.",[{text:"Cancel",style:"cancel",onPress:()=>e(!1)},{text:"Delete",style:"destructive",onPress:()=>e(!0)}],{cancelable:!1})})))return;await H(e)?((0,f.k4)(f.R2.DELETE_QUIVER,{quiverId:e}),u.A.alert("Success","Quiver deleted successfully")):u.A.alert("Error","Failed to delete quiver. Please try again.")}catch(G){u.A.alert("Error","An unexpected error occurred. Please try again.")}})(e.id)},children:(0,S.jsx)(y.A,{name:"trash-outline",size:20,color:T.error})})]},e.id))),(0,S.jsx)(o.A,{style:C.createButtonContainer,children:(0,S.jsx)(a.A,{style:[C.createEmptyButton,{backgroundColor:T.primary}],onPress:()=>z("save"),children:(0,S.jsx)(i.A,{style:[C.buttonText,{color:T.text.inverse}],children:"Create New Quiver"})})})]})})})]});return s?ee:(0,S.jsxs)(S.Fragment,{children:[e.length>0&&!s&&!A&&!w&&(0,S.jsxs)(a.A,{style:[C.saveButton,{backgroundColor:T.primary}],onPress:()=>D(!0),children:["web"===h.A.OS?(0,S.jsx)(i.A,{style:{fontSize:20,color:T.text.inverse,marginRight:8},children:"+"}):(0,S.jsx)(y.A,{name:"bookmark-outline",size:20,color:T.text.inverse}),(0,S.jsx)(i.A,{style:[C.buttonText,{color:T.text.inverse}],children:"Save Quiver"})]}),(0,S.jsx)(l.A,{visible:R,transparent:!0,animationType:"fade",onRequestClose:()=>{D(!1),t?.()},children:(0,S.jsx)(a.A,{style:[C.modalOverlay,s&&C.standaloneOverlay],activeOpacity:1,onPress:()=>{D(!1),t?.()},children:(0,S.jsx)(a.A,{style:[C.modalContent,{backgroundColor:T.background.primary},E&&C.modalContentMobile],activeOpacity:1,onPress:e=>{e.preventDefault(),e.stopPropagation()},children:ee})})})]})},C=s.A.create({saveButton:Object.assign({flexDirection:"row",alignItems:"center",justifyContent:"center",paddingHorizontal:A.Y.LARGE,paddingVertical:A.Y.MEDIUM,borderRadius:8,gap:8,minHeight:40,minWidth:120},"web"===h.A.OS&&{cursor:"pointer",pointerEvents:"auto",userSelect:"none",boxShadow:"0px 2px 4px rgba(0,0,0,0.1)"}),buttonText:Object.assign({fontSize:14,fontWeight:"600",textAlign:"center"},"web"===h.A.OS&&{userSelect:"none"}),modalOverlay:Object.assign({position:"absolute",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",justifyContent:"center",alignItems:"center",padding:b.Op,zIndex:2e3},"web"===h.A.OS&&{position:"absolute",pointerEvents:"auto"}),modalContent:Object.assign({width:"100%",maxWidth:600,borderRadius:12,maxHeight:"90%",zIndex:2001},"web"===h.A.OS&&{pointerEvents:"auto",userSelect:"none"}),modalContentMobile:{maxWidth:"100%"},modalHeader:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:A.Y.LARGE,borderBottomWidth:1},modalTitle:{fontSize:20,fontWeight:"600"},modalBody:{flex:1},tabContainer:{flexDirection:"row",borderBottomWidth:1},tab:{flex:1,paddingVertical:A.Y.MEDIUM,alignItems:"center"},activeTab:{borderBottomWidth:2},tabText:{fontSize:16,fontWeight:"500"},form:{padding:A.Y.LARGE},formField:{marginBottom:A.Y.LARGE},label:{fontSize:14,marginBottom:A.Y.SMALL},input:Object.assign({height:40,borderWidth:1,borderRadius:8,paddingHorizontal:A.Y.MEDIUM,fontSize:16},"web"===h.A.OS&&{outlineStyle:"none"}),textArea:{height:80,paddingTop:A.Y.MEDIUM,textAlignVertical:"top"},createButton:{paddingVertical:A.Y.MEDIUM,borderRadius:8,alignItems:"center"},quiverList:{padding:A.Y.LARGE},quiverItem:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",paddingVertical:A.Y.MEDIUM,borderBottomWidth:1},quiverInfo:Object.assign({flex:1,marginRight:A.Y.MEDIUM},"web"===h.A.OS&&{cursor:"pointer"}),quiverName:{fontSize:16,fontWeight:"600",marginBottom:4},quiverDescription:{fontSize:14,marginBottom:4},quiverMeta:{fontSize:12},deleteButton:Object.assign({padding:A.Y.SMALL,borderWidth:1,borderRadius:8,minWidth:"web"===h.A.OS?70:40,alignItems:"center",justifyContent:"center",zIndex:10},"web"===h.A.OS&&{cursor:"pointer",pointerEvents:"auto",userSelect:"none",position:"relative"}),deleteIcon:{fontSize:14,fontWeight:"600"},centerContent:{padding:A.Y.LARGE,alignItems:"center"},message:{fontSize:16},standaloneOverlay:{position:"relative",backgroundColor:"transparent"},renameContainer:{flexDirection:"row",alignItems:"center",gap:A.Y.SMALL},renameInput:{flex:1,height:32,borderWidth:1,borderRadius:4,paddingHorizontal:A.Y.SMALL,fontSize:14},renameButton:{paddingHorizontal:A.Y.MEDIUM,paddingVertical:A.Y.SMALL,borderRadius:4},renameButtonText:{fontSize:12,fontWeight:"500"},quiverNameContainer:{flexDirection:"row",alignItems:"center",gap:A.Y.SMALL},renameIcon:Object.assign({padding:A.Y.SMALL},"web"===h.A.OS&&{cursor:"pointer"}),createButtonContainer:{borderTopWidth:1,marginTop:A.Y.LARGE,paddingTop:A.Y.LARGE,paddingBottom:A.Y.MEDIUM},createEmptyButton:Object.assign({paddingHorizontal:A.Y.LARGE,paddingVertical:A.Y.MEDIUM,borderRadius:8,alignItems:"center",minWidth:180,alignSelf:"center"},"web"===h.A.OS&&{cursor:"pointer",userSelect:"none",boxShadow:"0px 2px 4px rgba(0,0,0,0.1)"})})},3295:(e,t,r)=>{r.d(t,{Qq:()=>s,vA:()=>a});var n=r(5991);const o={NODE_ENV:"production",PUBLIC_URL:"",APP_MANIFEST:{name:"FoilQuiver",slug:"FoilQuiver",version:"1.0.0",orientation:"portrait",icon:"./assets/icon.png",userInterfaceStyle:"light",splash:{image:"./assets/splash-icon.png",resizeMode:"contain",backgroundColor:"#ffffff"},web:{},extra:{production:{baseUrl:"https://foilquiver.com"},staging:{baseUrl:"https://staging.foilquiver.com"}},sdkVersion:"52.0.0",platforms:["ios","android","web"]},EXPO_DEBUG:!1,PLATFORM:"web",WDS_SOCKET_PATH:"/_expo/ws"}.EXPO_PUBLIC_ENV||"development",i={development:{apiUrl:"http://localhost:3000",webUrl:"http://localhost:19006",appScheme:"foilquiver-dev"},staging:{apiUrl:"https://api.staging.foilquiver.com",webUrl:"https://staging.foilquiver.com",appScheme:"foilquiver-staging"},production:{apiUrl:"https://api.foilquiver.com",webUrl:"https://foilquiver.com",appScheme:"foilquiver"}},s=()=>i[o],a=()=>{const e=s();return"web"===n.A.OS?[e.webUrl]:[`${e.appScheme}://`]}},2763:(e,t,r)=>{r.d(t,{Dy:()=>o,Op:()=>n,_X:()=>s,lD:()=>a,lU:()=>i,y6:()=>l});const n=16,o=768,i={brand:100,series:120,model:150,area:80,wingspan:80,aspectRatio:80,type:80,price:105,link:80},s=[{id:"brand",label:"Brand",isVisible:!0},{id:"series",label:"Series",isVisible:!1},{id:"model",label:"Model",isVisible:!0},{id:"area",label:"Area",isVisible:!0},{id:"wingspan",label:"Span",isVisible:!0},{id:"aspectRatio",label:"AR",isVisible:!0},{id:"type",label:"Type",isVisible:!0},{id:"price",label:"Price",isVisible:!0},{id:"link",label:"Link",isVisible:!0}],a=e=>e.reduce(((e,t)=>t.isVisible?e+(i[t.id]||100):e),0),l=(e,t,r)=>r?t:Math.min(e,t-48)},5663:(e,t,r)=>{r.d(t,{D:()=>l,n:()=>c});var n=r(6665),o=r(3600),i=r(2763),s=r(397);const a=(0,n.createContext)(void 0),l=({children:e})=>{const[t,r]=(0,n.useState)(""),[l,c]=(0,n.useState)({brands:[],series:[],type:[]}),[d,u]=(0,n.useState)(i._X),[h,m]=(0,n.useState)([]),[y,p]=(0,n.useState)(null);(0,n.useEffect)((()=>{(async()=>{try{const e=await(0,o.Ir)();e&&c({brands:e.brands||[],series:e.series||[],type:e.types||[]});const t=await(0,o.E7)();t&&Array.isArray(t)&&u(t.map((e=>Object.assign({},i._X.find((t=>t.id===e.id)),e))))}catch(e){}})()}),[]),(0,n.useEffect)((()=>{(0,o.ri)({brands:l.brands,series:l.series,types:l.type})}),[l]),(0,n.useEffect)((()=>{y&&c({brands:[],series:[],type:[]})}),[y]);const g={searchQuery:t,setSearchQuery:r,filters:l,setFilters:c,columns:d,setColumns:u,selectedFoils:h,setSelectedFoils:m,currentScreen:y,setCurrentScreen:p};return(0,s.jsx)(a.Provider,{value:g,children:e})},c=()=>{const e=(0,n.useContext)(a);if(void 0===e)throw new Error("useApp must be used within an AppProvider");return e}},2419:(e,t,r)=>{r.d(t,{c:()=>o});var n=r(6665);function o(e,t){const r=(0,n.useMemo)((()=>{const r=Array.from(new Set(e.map((e=>e.brand)))).sort(),n=function(e){return e.reduce(((e,t)=>(e[t.brand]||(e[t.brand]=[]),e[t.brand].push(t),e)),{})}(e);let o=[];if(0===t.brands.length)o=Array.from(new Set(e.map((e=>e.series)))).sort();else{const e=t.brands.flatMap((e=>n[e]||[]));o=Array.from(new Set(e.map((e=>e.series)))).sort()}return{brands:r,series:o,types:["front","tail"]}}),[e,t.brands]);return{filteredFoils:(0,n.useMemo)((()=>e.filter((e=>{const r=0===t.brands.length||t.brands.includes(e.brand),n=0===t.series.length||t.series.includes(e.series),o=0===t.type.length||t.type.includes(e.type);return r&&n&&o}))),[e,t.brands,t.series,t.type]),filterOptions:r}}},209:(e,t,r)=>{r.d(t,{J:()=>a});var n=r(6665),o=r(5991),i=r(1087);class s{static isWeb="web"===o.A.OS;static DATA_PATH="/data/foils.json";static CACHE_DIR=".cache";static getBaseUrl(){return"https://foilquiver.com"}static async getAllProducts(){try{if(this.isWeb){const t=this.getBaseUrl();try{const e=await fetch(`${t}${this.DATA_PATH}`);if(e.ok){return await e.json()}}catch(e){}try{const r=["armstrong","lift-foils","axis-foils","code-foils","kt-foils","uni-foil"],n=[];for(const o of r)try{const e=await fetch(`${t}/${this.CACHE_DIR}/${o}.json`);if(e.ok){const t=await e.json();n.push(...t)}}catch(e){}if(n.length>0)return n}catch(e){}}else{const e=await i.A.getItem("foils");if(e){return JSON.parse(e)}}}catch(e){}return[]}}function a(){const[e,t]=(0,n.useState)([]),[r,o]=(0,n.useState)(!0),[i,a]=(0,n.useState)(null),l=async()=>{try{o(!0),a(null);const e=await s.getAllProducts();t(e)}catch(e){a(e instanceof Error?e.message:"Failed to load foils")}finally{o(!1)}};(0,n.useEffect)((()=>{l()}),[]);return{foils:e,loading:r,error:i,refreshFoils:()=>{l()}}}},4812:(e,t,r)=>{r.d(t,{X:()=>p});var n=r(6665),o=r(1087),i=r(5991),s=r(5701),a=r(382),l=r(5501);const c="@foilquiver/quivers",d=()=>window.location.hostname.includes("staging")?"staging":"prod",u=()=>`${d()}_quivers`,h=async e=>"web"===i.A.OS?localStorage.getItem(e):o.A.getItem(e),m=async(e,t)=>{if("web"!==i.A.OS)return o.A.setItem(e,t);localStorage.setItem(e,t)},y=async e=>{if("web"!==i.A.OS)return o.A.removeItem(e);localStorage.removeItem(e)},p=()=>{const[e,t]=(0,n.useState)([]),[r,o]=(0,n.useState)(!0),[i,p]=(0,n.useState)(null),g=async()=>{try{o(!0),p(null);const{data:{session:e}}=await s.N.auth.getSession();if(e?.user){const{data:r,error:n}=await s.N.from(u()).select("*").eq("environment",d()).eq("user_id",e.user.id).order("updated_at",{ascending:!1});if(n)throw n;t(r||[])}else{const e=await h(c);t(e?JSON.parse(e):[])}}catch(e){p(e instanceof Error?e.message:"Failed to load quivers"),t([])}finally{o(!1)}};return(0,n.useEffect)((()=>{g();const{data:{subscription:e}}=s.N.auth.onAuthStateChange((async e=>{"SIGNED_IN"===e&&await(async()=>{try{const{data:{session:e}}=await s.N.auth.getSession();if(!e?.user)return;const t=await h(c);if(!t)return;const r=JSON.parse(t),n=d();for(const o of r){const t=o.foils.map((e=>(0,a.h)(e))),r={name:o.name,description:o.description||"",foil_ids:t,is_public:o.is_public||!1,user_id:e.user.id,environment:n};await s.N.from(u()).insert([r])}await y(c),await g()}catch(e){}})(),await g()}));return()=>{e.unsubscribe()}}),[]),{quivers:e,isLoading:r,error:i,createQuiver:async r=>{try{p(null);const{data:{session:n}}=await s.N.auth.getSession();if(n?.user){const e=u(),o=d(),i=r.foils.map((e=>(0,a.h)(e))),c={name:r.name,description:r.description||"",user_id:n.user.id,environment:o,foil_ids:i,is_public:r.is_public||!1},{error:h}=await s.N.from(e).insert(c);if(h)throw l.v.error("Insert error:",{message:h.message,details:h.details,hint:h.hint,code:h.code}),h;const{data:m,error:y}=await s.N.from(e).select("*").eq("user_id",n.user.id).eq("name",r.name).order("created_at",{ascending:!1}).limit(1).single();if(y)throw y;if(!m)throw new Error("Failed to retrieve created quiver");const p=Object.assign({},m,{foils:r.foils});return t((e=>[p,...e])),p}{const n=d(),o=r.foils.map((e=>(0,a.h)(e))),i={id:(0,a.l)(),name:r.name,description:r.description||"",foil_ids:o,is_public:r.is_public||!1,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString(),user_id:"local",environment:n},s=[i,...e];return await m(c,JSON.stringify(s)),t(s),i}}catch(n){throw n}},updateQuiver:async(e,r)=>{p(null);try{const{data:{session:n}}=await s.N.auth.getSession();if(n?.user){const{error:t}=await s.N.from(u()).update(r).eq("id",e);if(t)throw t;return await g(),!0}{const n=await h(c);if(!n)return!1;const o=JSON.parse(n).map((t=>t.id===e?Object.assign({},t,r,{updated_at:(new Date).toISOString()}):t));return await m(c,JSON.stringify(o)),t(o),!0}}catch(i){return p("Failed to update quiver"),!1}},deleteQuiver:async r=>{try{p(null);const{data:{session:n}}=await s.N.auth.getSession();if(n?.user){const{error:e}=await s.N.from(u()).delete().eq("id",r).eq("user_id",n.user.id).eq("environment",d());if(e)throw e}const o=e.filter((e=>e.id!==r));return t(o),n?.user||await m(c,JSON.stringify(o)),!0}catch(n){return p(n instanceof Error?n.message:"Failed to delete quiver"),!1}},reloadQuivers:g}}},4667:(e,t,r)=>{r.d(t,{D:()=>u,N:()=>d});var n=r(6665),o=r(1243),i=r(1087),s=r(5713),a=r(397);const l=(0,n.createContext)(void 0),c="@foilquiver/theme",d=({children:e})=>{const t=(0,o.A)(),[r,d]=(0,n.useState)("dark"===t);(0,n.useEffect)((()=>{(async()=>{try{const e=await i.A.getItem(c);null!==e&&d("dark"===e)}catch(e){}})()}),[]);const u=(0,s.j)(r?"dark":"light");return(0,a.jsx)(l.Provider,{value:{isDark:r,colors:u,toggleTheme:async()=>{try{const e=!r;d(e),await i.A.setItem(c,e?"dark":"light")}catch(e){}}},children:e})},u=()=>{const e=(0,n.useContext)(l);if(void 0===e)throw new Error("useTheme must be used within a ThemeProvider");return e}},5713:(e,t,r)=>{r.d(t,{T:()=>h,j:()=>u});const n="#BF3475",o="#FFCE61",i="#F9FAFB",s="#E5E7EB",a="#374151",l="#111827",c={background:{primary:i,secondary:"#F3F4F6",tertiary:s},text:{primary:l,secondary:a,tertiary:"#6B7280",inverse:i},border:s,primary:n,error:"#DC2626",success:"#059669",warning:o},d={background:{primary:l,secondary:"#1F2937",tertiary:a},text:{primary:i,secondary:s,tertiary:"#9CA3AF",inverse:l},border:a,primary:n,error:"#EF4444",success:"#10B981",warning:o},u=e=>"dark"===e?d:c,h=c},2348:(e,t,r)=>{r.d(t,{Y:()=>n});const n={XSMALL:4,SMALL:8,MEDIUM:12,LARGE:16,XLARGE:24,XXLARGE:32,CONTAINER_PADDING:24,BUTTON_PADDING_H:16,BUTTON_PADDING_V:8,BUTTON_GAP:12,CONTROLS_BOTTOM:24,SCREEN_PADDING:24,TABLE_CONTAINER_PADDING:24,HEADER_PADDING:12,CONTENT_PADDING:16,CONTROLS_CONTAINER_BOTTOM:24,CONTROLS_CONTAINER_PADDING:24}},5025:(e,t,r)=>{r.d(t,{R2:()=>a,k4:()=>s,oe:()=>i});var n=r(5991);const o=e=>{"web"===n.A.OS&&window.plausible&&window.plausible(e.name,e.props?{props:e.props}:void 0)},i=(e,t)=>{o({name:"pageview",props:Object.assign({page:e},t)})},s=(e,t)=>{o({name:e,props:t})},a={VIEW_COMPARISON:"view_comparison",VIEW_QUIVER:"view_quiver",COMPARE_FOILS:"compare_foils",SAVE_QUIVER:"save_quiver",DELETE_QUIVER:"delete_quiver",UPDATE_QUIVER:"update_quiver",FILTER_FOILS:"filter_foils",SORT_FOILS:"sort_foils",SEARCH_FOILS:"search_foils"}},382:(e,t,r)=>{r.d(t,{h:()=>n,l:()=>o});const n=e=>`${e.brand.toLowerCase()}-${e.model.toLowerCase().replace(/\s+/g,"-")}`,o=()=>"undefined"!==typeof crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},5501:(e,t,r)=>{r.d(t,{v:()=>o});class n{isDevelopment=!1;constructor(){this.isDevelopment}static getInstance(){return n.instance||(n.instance=new n),n.instance}log(e,t,...r){if(this.isDevelopment||"error"===e){(new Date).toISOString(),e.toUpperCase();e}}debug(e,...t){this.log("debug",e,...t)}info(e,...t){this.log("info",e,...t)}warn(e,...t){this.log("warn",e,...t)}error(e,...t){this.log("error",e,...t)}}const o=n.getInstance()},9659:(e,t,r)=>{r.d(t,{JZ:()=>n});const n={browse:"/",comparison:"/comparison",quiver:"/quiver/:quiverId",terms:"/terms",privacy:"/privacy",contact:"/contact"}},3600:(e,t,r)=>{r.d(t,{E7:()=>c,Ir:()=>a,QZ:()=>u,pC:()=>d,pF:()=>l,ri:()=>s});var n=r(1087),o=r(5501);const i={FILTERS:"@foilquiver/filters",COLUMNS:"@foilquiver/columns",THEME:"@foilquiver/theme",SORT:"@foilquiver/sort"};new class{async set(e,t){try{const r=JSON.stringify(t);await n.A.setItem(e,r)}catch(r){throw o.v.error("Error setting storage item:",r),r}}async get(e){try{const t=await n.A.getItem(e);return null!=t?JSON.parse(t):null}catch(t){throw o.v.error("Error getting storage item:",t),t}}async remove(e){try{await n.A.removeItem(e)}catch(t){throw o.v.error("Error removing storage item:",t),t}}async clear(){try{await n.A.clear()}catch(e){throw o.v.error("Error clearing storage:",e),e}}async getAllKeys(){try{return await n.A.getAllKeys()}catch(e){throw o.v.error("Error getting all storage keys:",e),e}}};const s=async e=>{try{await n.A.setItem(i.FILTERS,JSON.stringify(e))}catch(t){}},a=async()=>{try{const e=await n.A.getItem(i.FILTERS);return e?JSON.parse(e):null}catch(e){return null}},l=async e=>{try{await n.A.setItem(i.COLUMNS,JSON.stringify(e))}catch(t){}},c=async()=>{try{const e=await n.A.getItem(i.COLUMNS);return e?JSON.parse(e):null}catch(e){return null}},d=async e=>{try{await n.A.setItem(i.SORT,JSON.stringify(e))}catch(t){}},u=async()=>{try{const e=await n.A.getItem(i.SORT);return e?JSON.parse(e):null}catch(e){return null}}},5701:(e,t,r)=>{r.d(t,{N:()=>i});var n=r(8418),o=r(5991);const i=(0,n.UU)("https://zhylhvuhhoialsgqrxxr.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpoeWxodnVoaG9pYWxzZ3FyeHhyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzkxNjM3NTgsImV4cCI6MjA1NDczOTc1OH0.wrZ05wA3EcbBubG3Mrxmx--fA9ThE2_M9k9WYTmGpag",{auth:{detectSessionInUrl:"web"===o.A.OS,flowType:"pkce",autoRefreshToken:!0,persistSession:!0}})}},e=>{e.O(0,[925],(()=>{return t=640,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=main.af6757cc.js.map